<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tools for modeling compound events • MultiHazard</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Tools for modeling compound events">
<meta property="og:description" content="The `MultiHazard` package provides tools for stationary multivariate statistical modeling, for example, to estimate the joint distribution of MULTIple co-occurring HAZARDs. The package contains functions for pre-processing data including imputing missing values, detrending and declustering time series as well as analyzing pairwise correlations over a range of lags. Functionality is also built in to impliment the conditional sampling - copula theory approach in Jane et al. (2020) including the automated threshold selection approach in Solari et al. (2017). Tools are provided for selecting the best fitting amongst an array of (non-extreme, truncated and non-truncated) parametric marginal distributions, and, copulas to model the dependence structure. The package contains a function that calculates joint probability contours using the method of overlaying (conditional) contours given in Bender et al. (2016), and extracting design events such as the most likely event or an ensemble of possible design events. The package also provides the capability of fitting and simulating synthetic records from three higher dimensional approaches - standard (elliptic/Archimedean) copulas, Pair Copula Constructions (PCCs) and the conditional threshold exceedance approach of Heffernan and Tawn (2004). Finally, a function that calculates the time for a user-specified height of sea level rise to occur under various scenarios is supplied.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">MultiHazard</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/MultiHazard.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/my-vignette.html">my-vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="multihazard-">MultiHazard <img src="https://user-images.githubusercontent.com/15319503/195926656-9d3d37b5-86ab-4d4b-9e6d-3c70d5399c73.png" align="right" height="200"><a class="anchor" aria-label="anchor" href="#multihazard-"></a>
</h1></div>
<p>The <code>MultiHazard</code> package provides tools for stationary multivariate statistical modeling, for example, to estimate joint occurrence probabilities of MULTIple co-occurring HAZARDs. The package contains functions for pre-processing data, including imputing missing values, detrending and declustering time series as well as analyzing pairwise correlations over a range of lags. Functionality is built in to implement the conditional sampling - copula theory approach described in <a href="https://doi.org/10.5194/nhess-20-2681-2020" class="external-link">Jane et al. (2020)</a> including the automated threshold selection method from <a href="https://doi.org/10.1002/2016WR019426" class="external-link">Solari et al. (2017)</a>. There is a function that calculates joint probability contours using the method of overlaying conditional contours given in <a href="https://doi.org/10.1080/02626667.2015.1052816" class="external-link">Bender et al. (2016)</a> and extracts design events such as the “most likely” event or an ensemble of possible design events. The package also includes methods from <a href="https://doi.org/10.1002/env.2797" class="external-link">Murphy-Barltrop et al. (2023)</a> and <a href="https://doi.org/10.1007/s10687-024-00490-4" class="external-link">Murphy-Barltrop et al. (2024)</a> for deriving isolines using the <a href="https://doi.org/10.1111/j.1467-9868.2004.02050.x" class="external-link">Heffernan and Tawn (2004)</a> <a href="#ht04">HT04</a> and <a href="https://doi.org/10.3150/12-BEJ471" class="external-link">Wadsworth and Tawn (2013)</a> [WT13] models, together with a novel bootstrap procedure for quantifying sampling uncertainty in the isolines. Three higher dimensional approaches — standard (elliptic/Archimedean) copulas, Pair Copula Constructions (PCCs) and a conditional threshold exceedance approach (HT04) — are coded. Finally, the package can be implemented to derive temporally coherent extreme events comprising a hyetograph and water level curve for simulated peak rainfall and peak sea level events, as outlined in (Report).</p>
<div class="section level3">
<h3 id="citation">Citation:<a class="anchor" aria-label="anchor" href="#citation"></a>
</h3>
<blockquote>
<p>Jane, R., Wahl, T., Peña, F., Obeysekera, J., Murphy-Barltrop, C., Ali, J., Maduwantha, P., Li, H., and Malagón Santos, V. (under review) MultiHazard: Copula-based Joint Probability Analysis in R. Journal of Open Source Software. [under revision]</p>
</blockquote>
<p><br></p>
</div>
<div class="section level3">
<h3 id="applications-of-package">Applications of package:<a class="anchor" aria-label="anchor" href="#applications-of-package"></a>
</h3>
<blockquote>
<p>Li, H., Jane, R. A., Eilander, D., Enríquez, A. R., Haer, T., and Ward, P. J. (2025). Assessing the spatial correlation of potential compound flooding in the United States, EGUsphere [preprint], <a href="https://doi.org/10.5194/egusphere-2025-2993" class="external-link uri">https://doi.org/10.5194/egusphere-2025-2993</a>.</p>
</blockquote>
<blockquote>
<p>Amorim, R., Villarini, G., Kim, H., Jane, R., and Wahl, T. (2025). A Practitioner’s approach to process-driven modeling of compound rainfall and storm surge extremes for coastal Texas, J. Hydrol. Eng., 30(5), 04025025, <a href="https://doi.org/10.1061/JHYEFF.HEENG-648" class="external-link uri">https://doi.org/10.1061/JHYEFF.HEENG-648</a>.</p>
</blockquote>
<blockquote>
<p>Maduwantha, P., Wahl, T., Santamaria-Aguilar, S., Jane, R., Booth, J. F., Kim, H., and Villarini, G. (2024). A multivariate statistical framework for mixed storm types in compound flood analysis, Nat. Hazards Earth Syst. Sci., 24, 4091–4107, <a href="https://doi.org/10.5194/nhess-24-4091-2024" class="external-link uri">https://doi.org/10.5194/nhess-24-4091-2024</a>.</p>
</blockquote>
<blockquote>
<p>Nasr, A. A., Wahl, T., Rashid, M. M., Jane, R., Camus, P. and Haigh, I. D. (2023). Temporal changes in dependence between compound coastal and inland flooding drivers around the contiguous United States coastline, Weather Clim. Extrem., 41, 100594, <a href="https://doi.org/10.1016/j.wace.2023.100594" class="external-link uri">https://doi.org/10.1016/j.wace.2023.100594</a>.</p>
</blockquote>
<blockquote>
<p>Kim, H., Villarini, G., Jane, R., Wahl, T., Misra, S., and Michalek, A. (2023). On the generation of high‐resolution probabilistic design events capturing the joint occurrence of rainfall and storm surge in coastal basins, Int. J. Climatol, 43(2), 761-771, <a href="https://doi.org/10.1002/joc.7825" class="external-link uri">https://doi.org/10.1002/joc.7825</a>.</p>
</blockquote>
<blockquote>
<p>Kim, T., Villarini, G., Kim, H., Jane, R., and Wahl, T. (2023). On the compounding of nitrate loads and discharge, J. Environ. Qual., 52, 706–717. <a href="https://doi.org/10.1002/jeq2.20458" class="external-link uri">https://doi.org/10.1002/jeq2.20458</a>.</p>
</blockquote>
<blockquote>
<p>Peña, F., Obeysekera, J., Jane R., Nardi, F., Maran, C., Cadogan, A., de Groen, F., and Melesse, A. (2023). Investigating compound flooding in a low elevation coastal karst environment using multivariate statistical and 2D hydrodynamic modeling, Weather Clim. Extrem., 39, 100534. <a href="https://doi.org/10.1016/j.wace.2022.100534" class="external-link uri">https://doi.org/10.1016/j.wace.2022.100534</a>.</p>
</blockquote>
<blockquote>
<p>Jane, R., Cadavid, L., Obeysekera, J., and Wahl, T. (2020). Multivariate statistical modelling of the drivers of compound flood events in South Florida, Nat. Hazards Earth Syst. Sci., 20, 2681–2699, <a href="https://doi.org/10.5194/nhess-20-2681-2020" class="external-link uri">https://doi.org/10.5194/nhess-20-2681-2020</a>.</p>
</blockquote>
<p><br></p>
</div>
<div class="section level2">
<h2 id="community-guidelines">Community guidelines<a class="anchor" aria-label="anchor" href="#community-guidelines"></a>
</h2>
<p>Contributions to the <code>MultiHazard</code> package are welcome! Please feel free to submit issues or pull requests on GitHub.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the latest version of this package by entering the following in R:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"rjaneUCF/MultiHazard"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="id_1-introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#id_1-introduction"></a>
</h2>
<p>The <code>MultiHazard</code> package provides tools for stationary multivariate statistical modeling, for example, to estimate the joint distribution of MULTIple co-occurring HAZARDs. This document is designed to explain and demonstrate the functions contained within the package. Section 1 looks at the functions concerned with pre-processing the data including imputing missing values. Section 2 illustrates the functions for detrending and declustering time series while Section 3 introduces a function that analyzes pairwise correlations over a range of lags. Section 4 shows how the conditional sampling - copula theory approach in <a href="https://doi.org/10.5194/nhess-20-2681-2020" class="external-link">Jane et al. (2020)</a> can be implemented including the automated threshold selection method in <a href="https://doi.org/10.1002/2016WR019426" class="external-link">Solari et al. (2017)</a>. Functions for selecting the best fitting among an array of (non-extreme, truncated and non-truncated) parametric marginal distributions, and copulas to model the dependence structure are demonstrated in this section. Section 4 also contains an explanation of the function that derives the joint probability contours according to the method of overlaying (conditional) contours given in <a href="https://doi.org/10.1080/02626667.2015.1052816" class="external-link">Bender et al. (2016)</a>, and extracts design events such as the “most likely” event or an ensemble of possible design events. Section 4 also introduces the functions that generate isolines using the methods from <a href="https://doi.org/10.1002/env.2797" class="external-link">Murphy-Barltrop et al. (2023)</a> and <a href="https://doi.org/10.1007/s10687-024-00490-4" class="external-link">Murphy-Barltrop et al. (2024)</a>, and implements a novel bootstrap procedure for quantifying sampling uncertainty in the isolines. Section 5 introduces the functions for fitting and simulating synthetic events from three higher-dimensional approaches - standard (elliptic/Archimedean) copulas, Pair Copula Constructions (PCCs) and the conditional threshold exceedance approach of HT04. Section 6 describes a function that calculates the time for a user-specified height of sea level rise to occur under various scenarios. Lastly, Section 7 shows the simulation of temporally coherent extreme rainfall and ocean water level events.</p>
</div>
<div class="section level2">
<h2 id="id_2-pre-processing">2. Pre-processing<a class="anchor" aria-label="anchor" href="#id_2-pre-processing"></a>
</h2>
<div class="section level3">
<h3 id="imputation">Imputation<a class="anchor" aria-label="anchor" href="#imputation"></a>
</h3>
<p>Well G_3356 represents the groundwater level at Site S20, however, it contains missing values. Let’s impute missing values in the record at Well G_3356 using recordings at nearby Well G_3355. First, reading in the two time series.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Viewing first few rows of in the groundwater level records</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">G_3356</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="do">##         Date Value</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="do">## 1 1985-10-23  2.46</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="do">## 2 1985-10-24  2.47</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="do">## 3 1985-10-25  2.41</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="do">## 4 1985-10-26  2.37</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="do">## 5 1985-10-27  2.63</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="do">## 6 1985-10-28  2.54</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">G_3355</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="do">##         Date Value</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="do">## 1 1985-08-20  2.53</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="do">## 2 1985-08-21  2.50</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="do">## 3 1985-08-22  2.46</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="do">## 4 1985-08-23  2.43</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="do">## 5 1985-08-24  2.40</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="do">## 6 1985-08-25  2.37</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Converting Date column to "Date"" object</span></span>
<span><span class="va">G_3356</span><span class="op">$</span><span class="va">Date</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1985-10-23"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-05-29"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">G_3355</span><span class="op">$</span><span class="va">Date</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1985-08-20"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-06-02"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="co">#Converting column containing the readings to a "numeric"" object</span></span>
<span><span class="va">G_3356</span><span class="op">$</span><span class="va">Value</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">G_3356</span><span class="op">$</span><span class="va">Value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G_3355</span><span class="op">$</span><span class="va">Value</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">G_3355</span><span class="op">$</span><span class="va">Value</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Warning message confirms there are NAs in the record at Well G_3356. Before carrying out the imputation the two data frames need to be merged.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Merge the two dataframes by date</span></span>
<span><span class="va">GW_S20</span><span class="op">&lt;-</span><span class="fu">left_join</span><span class="op">(</span><span class="va">G_3356</span>,<span class="va">G_3355</span>,by<span class="op">=</span><span class="st">"Date"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">GW_S20</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"G3356"</span>,<span class="st">"G3355"</span><span class="op">)</span></span>
<span><span class="co">#Carrying out imputation</span></span>
<span><span class="va">Imp</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Imputation.html">Imputation</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">GW_S20</span>,Variable<span class="op">=</span><span class="st">"G3356"</span>,</span>
<span>                x_lab<span class="op">=</span><span class="st">"G-3355 (ft NGVD 29)"</span>, y_lab<span class="op">=</span><span class="st">"G-3356 (ft NGVD 29)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-5-1.png"><!-- --></p>
<p>The completed record is given in the <code>ValuesFilled</code> column of the data frame outputted as the <code>Data</code> object while the linear regression model including its coefficient of determinant are given by the <code>model</code> output argument.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="do">##         Date G3356 G3355 ValuesFilled</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="do">## 1 1985-10-23  2.46  2.87         2.46</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="do">## 2 1985-10-24  2.47  2.85         2.47</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="do">## 3 1985-10-25  2.41  2.82         2.41</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="do">## 4 1985-10-26  2.37  2.79         2.37</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="do">## 5 1985-10-27  2.63  2.96         2.63</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="do">## 6 1985-10-28  2.54  2.96         2.54</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Imp</span><span class="op">$</span><span class="va">Model</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="do">## lm(formula = data[, variable] ~ data[, Other.variable])</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="do">## -1.60190 -0.16654  0.00525  0.16858  1.73824 </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="do">##                        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="do">## (Intercept)            0.275858   0.012366   22.31   &lt;2e-16 ***</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="do">## data[, Other.variable] 0.700724   0.004459  157.15   &lt;2e-16 ***</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="do">## Residual standard error: 0.2995 on 11825 degrees of freedom</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="do">##   (445 observations deleted due to missingness)</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.6762, Adjusted R-squared:  0.6762 </span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="do">## F-statistic: 2.47e+04 on 1 and 11825 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Are any values still NA?</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G_3356_ValueFilled_NA</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">G_3356_ValueFilled_NA</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="do">## [1] 3</span></span></code></pre></div>
<p>Linear interpolating the three remaining NAs.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G3356_approx</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,<span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span>,</span>
<span>                     xout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span></span>
<span>  <span class="va">G3356_approx</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="detrending">Detrending<a class="anchor" aria-label="anchor" href="#detrending"></a>
</h3>
<p>In the analysis completed O-sWL (Ocean-side Water Level) and groundwater level series are subsequently detrended. The Detrend() function uses either a linear fit covering the entire data (<code>Method</code>=<code>linear</code>) or moving average window (<code>Method</code>=<code>window</code>) of a specified length (<code>Window_Width</code>) to remove trends from a time series. The residuals are added to the final <code>End_Length</code> observations. The default <code><a href="reference/Detrend.html">Detrend()</a></code> parameters specify a moving average (<code>Method</code>=<code>window</code>) three month window (<code>Window_Width</code>=<code>89</code>), to remove any seasonality from the time series. The default is then to add the residuals to the average of the final five years of observations (<code>End_Length</code>=<code>1826</code>) to bring the record to the present day level, accounting for the Perigean tide in the case of O-sWL. The mean of the observations over the first three months were subtracted from the values during this period before the present day (5-year) average was added. The following R code detrends the record at Well G_3356. Note the function requires a Date object and the completed series.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Creating a data frame with the imputed series alongside the corresponding dates </span></span>
<span><span class="va">G_3356_Imp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Date</span>,<span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">G_3356_Imp</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"ValuesFilled"</span><span class="op">)</span></span>
<span><span class="co">#Detrending</span></span>
<span><span class="va">G_3356_Detrend</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Detrend.html">Detrend</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">G_3356_Imp</span>,PLOT<span class="op">=</span><span class="cn">TRUE</span>,x_lab<span class="op">=</span><span class="st">"Date"</span>,</span>
<span>                        y_lab<span class="op">=</span><span class="st">"Groundwater level (ft NGVD 29)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-10-1.png"><!-- --></p>
<p>Output of the function is simply the detrended time series.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">G_3356_Detrend</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="do">## [1] 2.394700 2.411588 2.360033 2.327588 2.595588 2.520255</span></span></code></pre></div>
<p>Creating a data frame containing the detrended groundwater series at site S_20 i.e. G_3356_Detrend and their corresponding dates</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Groundwater.Detrend.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">GW_S20</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>,<span class="va">G_3356_Detrend</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.Groundwater.Detrend.df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"Groundwater"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="declustering">Declustering<a class="anchor" aria-label="anchor" href="#declustering"></a>
</h3>
<p>The <code><a href="reference/Decluster.html">Decluster()</a></code> function declusters a time series using a threshold u specified as a quantile of the completed series and separation criterion <code>SepCrit</code> to ensure independent events. If <code>mu</code>=<code>365.25</code> then <code>SepCrit</code> denotes the minimum number of days readings must remain below the threshold before a new event is defined.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G_3356.Declustered</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Decluster.html">Decluster</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">G_3356_Detrend</span>,u<span class="op">=</span><span class="fl">0.95</span>,SepCrit<span class="op">=</span><span class="fl">3</span>,mu<span class="op">=</span><span class="fl">365.25</span><span class="op">)</span></span></code></pre></div>
<p>Plot showing the completed, detrended record at Well G-3356 (grey circles) along with cluster maxima (red circles) identified using a 95% threshold (green line) and three day separation criterion.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G_3356_Imp</span><span class="op">$</span><span class="va">Detrend</span><span class="op">&lt;-</span><span class="va">G_3356_Detrend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">G_3356_Imp</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>,<span class="va">G_3356_Imp</span><span class="op">$</span><span class="va">Detrend</span>,col<span class="op">=</span><span class="st">"Grey"</span>,pch<span class="op">=</span><span class="fl">16</span>,</span>
<span>     cex<span class="op">=</span><span class="fl">0.25</span>,xlab<span class="op">=</span><span class="st">"Date"</span>,ylab<span class="op">=</span><span class="st">"Groundwater level (ft NGVD 29)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">Threshold</span>,col<span class="op">=</span><span class="st">"Dark Green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">G_3356_Imp</span><span class="op">$</span><span class="va">Date</span><span class="op">[</span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       <span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">Declustered</span><span class="op">[</span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">]</span>,</span>
<span>       col<span class="op">=</span><span class="st">"Red"</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-14-1.png"><!-- --></p>
<p>Other outputs from the <code><a href="reference/Decluster.html">Decluster()</a></code> function include the threshold on the original scale</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">Threshold</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="do">## [1] 2.751744</span></span></code></pre></div>
<p>and the number of events per year</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">Rate</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="do">## [1] 7.857399</span></span></code></pre></div>
<p>In preparation for later work, lets assign the detrended and declustered groundwater series at site S20 a name.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Groundwater.Detrend.Declustered</span><span class="op">&lt;-</span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">Declustered</span></span></code></pre></div>
<p>Reading in the other rainfall and O-sWL series at Site S20</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Changing names of the data frames</span></span>
<span><span class="va">S20.Rainfall.df</span><span class="op">&lt;-</span><span class="va">Perrine_df</span></span>
<span><span class="va">S20.OsWL.df</span><span class="op">&lt;-</span><span class="va">S20_T_MAX_Daily_Completed_Detrend_Declustered</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#Converting Date column to "Date"" object</span></span>
<span><span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Date</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span></span>
<span><span class="va">S20.OsWL.df</span><span class="op">$</span><span class="va">Date</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">S20.OsWL.df</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span></span></code></pre></div>
<p>Detrending and declustering the rainfall and O-sWL series at Site S20</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.OsWL.Detrend</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Detrend.html">Detrend</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.OsWL.df</span>,Method <span class="op">=</span> <span class="st">"window"</span>,PLOT<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                          x_lab<span class="op">=</span><span class="st">"Date"</span>,y_lab<span class="op">=</span><span class="st">"O-sWL (ft NGVD 29)"</span><span class="op">)</span></span></code></pre></div>
<p>Creating a dataframe with the date alongside the detrended OsWL series</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.OsWL.Detrend.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">S20.OsWL.df</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>,<span class="va">S20.OsWL.Detrend</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.OsWL.Detrend.df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"OsWL"</span><span class="op">)</span></span></code></pre></div>
<p>Declustering rainfall and O-sWL series at site S20,</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Declustering rainfall and O-sWL series</span></span>
<span><span class="va">S20.Rainfall.Declustered</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Decluster.html">Decluster</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Value</span>,u<span class="op">=</span><span class="fl">0.95</span>,SepCrit<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">Declustered</span></span>
<span><span class="va">S20.OsWL.Detrend.Declustered</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Decluster.html">Decluster</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.OsWL.Detrend</span>,u<span class="op">=</span><span class="fl">0.95</span>,SepCrit<span class="op">=</span><span class="fl">3</span>,mu<span class="op">=</span><span class="fl">365.25</span><span class="op">)</span><span class="op">$</span><span class="va">Declustered</span></span></code></pre></div>
<p>Creating data frames with the date alongside declustered series</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.OsWL.Detrend.Declustered.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">S20.OsWL.df</span><span class="op">$</span><span class="va">Date</span>,<span class="va">S20.OsWL.Detrend.Declustered</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.OsWL.Detrend.Declustered.df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"OsWL"</span><span class="op">)</span></span>
<span><span class="va">S20.Rainfall.Declustered.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Date</span>,<span class="va">S20.Rainfall.Declustered</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.Rainfall.Declustered.df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"Rainfall"</span><span class="op">)</span></span>
<span><span class="va">S20.Groundwater.Detrend.Declustered.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">G_3356</span><span class="op">$</span><span class="va">Date</span>,<span class="va">S20.Groundwater.Detrend.Declustered</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.Groundwater.Detrend.Declustered.df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"Groundwater"</span><span class="op">)</span></span></code></pre></div>
<p>Use the <code><a href="reference/Dataframe_Combine.html">Dataframe_Combine()</a></code> function to create data frames containing all observations of the original, detrended if necessary, and declustered time series. On dates where not all variables are observed, missing values are assigned NA.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Detrend.df</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Dataframe_Combine.html">Dataframe_Combine</a></span><span class="op">(</span><span class="va">data.1</span><span class="op">&lt;-</span><span class="va">S20.Rainfall.df</span>,</span>
<span>                                  <span class="va">data.2</span><span class="op">&lt;-</span><span class="va">S20.OsWL.Detrend.df</span>,</span>
<span>                                  <span class="va">data.3</span><span class="op">&lt;-</span><span class="va">S20.Groundwater.Detrend.df</span>,</span>
<span>                                  names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rainfall"</span>,<span class="st">"OsWL"</span>,<span class="st">"Groundwater"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">S20.Detrend.Declustered.df</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Dataframe_Combine.html">Dataframe_Combine</a></span><span class="op">(</span><span class="va">data.1</span><span class="op">&lt;-</span><span class="va">S20.Rainfall.Declustered.df</span>,</span>
<span>                                              <span class="va">data.2</span><span class="op">&lt;-</span><span class="va">S20.OsWL.Detrend.Declustered.df</span>,</span>
<span>                                              <span class="va">data.3</span><span class="op">&lt;-</span><span class="va">S20.Groundwater.Detrend.Declustered.df</span>,</span>
<span>                                              names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rainfall"</span>,<span class="st">"OsWL"</span>,<span class="st">"Groundwater"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The package contains two other declustering functions. The <code><a href="reference/Decluster_SW.html">Decluster_SW()</a></code> function declusters a time series via a storm window approach. A moving window of length (<code>Window_Width</code>) is moved over the time series, if the maximum value is located at the center of the window then the value is considered a peak and retained, otherwise it is set equal to NA. For a seven day window at S20:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Rainfall.Declustered.SW</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Decluster_SW.html">Decluster_SW</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Rainfall.df</span>,Window_Width<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the original and detrended series:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Date</span>,<span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Value</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Date"</span>,ylab<span class="op">=</span><span class="st">"Total daily rainfall (Inches)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Date</span>,<span class="va">S20.Rainfall.Declustered.SW</span><span class="op">$</span><span class="va">Declustered</span>,pch<span class="op">=</span><span class="fl">16</span>,col<span class="op">=</span><span class="fl">2</span>,cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-25-1.png"><!-- --></p>
<p>Repeating the analysis for the O-sWL with a 3-day window.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.OsWL.Declustered.SW</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Decluster_SW.html">Decluster_SW</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.OsWL.df</span>,Window_Width<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="reference/Decluster_S_SW.html">Decluster_S_SW()</a></code> function declusters a summed time series via a storm window approach. First a moving window of width (<code>Window_Width_Sum</code>) travels across the data and each time the values are summed. As with the <code><a href="reference/Decluster_SW.html">Decluster_SW()</a></code> function a moving window of length <code>(Window_Width</code>) is then moved over the time series, if the maximum value in a window is located at its center then the value considered a peak and retained, otherwise it is set equal to NA. To decluster weekly precipitation totals using a seven day storm window at S20:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Declustering</span></span>
<span><span class="va">S20.Rainfall.Declustered.S.SW</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Decluster_S_SW.html">Decluster_S_SW</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Rainfall.df</span>, </span>
<span>                                              Window_Width_Sum<span class="op">=</span><span class="fl">7</span>, Window_Width<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="co">#First twenty values of the weekly totals</span></span>
<span><span class="va">S20.Rainfall.Declustered.S.SW</span><span class="op">$</span><span class="va">Totals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="do">##  [1]   NA   NA   NA 0.23 0.19 0.10 1.56 1.94 2.04 2.04 2.04 2.91 3.02 2.75 3.15</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="do">## [16] 3.05 3.05 3.05 2.18 2.03</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#First ten values of the declustered weekly totals</span></span>
<span><span class="va">S20.Rainfall.Declustered.S.SW</span><span class="op">$</span><span class="va">Declustered</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="do">##  [1]   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA 3.15</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="do">## [16]   NA   NA   NA   NA   NA</span></span></code></pre></div>
<p>Plotting the original and detrended series:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Date</span>,<span class="va">S20.Rainfall.Declustered.S.SW</span><span class="op">$</span><span class="va">Totals</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Date"</span>,ylab<span class="op">=</span><span class="st">"Total weekly rainfall (Inches)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Date</span>,<span class="va">S20.Rainfall.Declustered.S.SW</span><span class="op">$</span><span class="va">Declustered</span>,pch<span class="op">=</span><span class="fl">16</span>,col<span class="op">=</span><span class="fl">2</span>,cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-29-1.png"><!-- --></p>
<div class="section level4">
<h4 id="fit-gpd">Fit GPD<a class="anchor" aria-label="anchor" href="#fit-gpd"></a>
</h4>
<p>The <code><a href="reference/GPD_Fit.html">GPD_Fit()</a></code> function fits a generalized Pareto distribution (GPD) to observations above a threshold u, specified as a quantile of the completed time series. To fit the distribution the <code><a href="reference/GPD_Fit.html">GPD_Fit()</a></code> function requires the declustered series as its Data argument and the entire completed series, detrended if necessary, as its <code>Data_Full</code> argument. The completed series is required to calculate the value on the original scale corresponding to u. If <code>PLOT=TRUE</code> then diagnostic plots are produced to allow an assessment of the fit.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/GPD_Fit.html">GPD_Fit</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">$</span><span class="va">Rainfall</span>,Data_Full<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span>,</span>
<span>        u<span class="op">=</span><span class="fl">0.997</span>,PLOT<span class="op">=</span><span class="cn">TRUE</span>,xlab_hist<span class="op">=</span><span class="st">"Rainfall (Inches)"</span>,y_lab<span class="op">=</span><span class="st">"Rainfall (Inches)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-30-1.png"><!-- --></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="do">## $Threshold</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="do">## [1] 3.5465</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a><span class="do">## $Rate</span></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a><span class="do">## [1] 1.021938</span></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a><span class="do">## $sigma</span></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a><span class="do">## [1] 1.421037</span></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a><span class="do">## $xi</span></span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a><span class="do">## [1] 0.1696554</span></span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a><span class="do">## $sigma.SE</span></span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a><span class="do">## [1] 0.2365755</span></span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a><span class="do">## $xi.SE</span></span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a><span class="do">## [1] 0.1781031</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="solari-2017-automated-threshold-selection">Solari (2017) automated threshold selection<a class="anchor" aria-label="anchor" href="#solari-2017-automated-threshold-selection"></a>
</h4>
<p><a href="https://doi.org/10.1002/2016WR019426" class="external-link">Solari et al. (2017)</a> proposes a methodology for automatic threshold estimation, based on an EDF-statistic and a goodness of fit test to test the null hypothesis that exceedances of a high threshold come from a GPD distribution.</p>
<p>EDF-statistics measure the distance between the empirical distribution <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;F_n" title="F_n" alt="F_n"> obtained from the sample and the parametric distribution <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;F%28x%29" title="F(x)" alt="F(x)">. The Anderson Darling <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;A%5E2" title="A^2" alt="A^2"> statistic is an EDF-statistic, which assigns more weight to the tails of the data than similar measures. <a href="https://doi.org/10.1080/03610929008830405" class="external-link">Sinclair et al. (1990)</a> proposed the right-tail weighted Anderson Darling statistic <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;A_R%5E2" title="A_R^2" alt="A_R^2"> which allocates more weight to the upper tail and less to the lower tail of the distribution than <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;A%5E2" title="A^2" alt="A^2"> and is given by:</p>
<div class="float">
<img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%7BA%7D_%7BR%7D%5E%7B2%7D%3D%20-%5Cfrac%7Bn%7D%7B2%7D%20-%20%20%5Csum%5C_%7Bi%3D1%7D%5E%7Bn%7D%20%5Cleft%5C%5B%5Cleft%282-%5Cfrac%7B%282i-1%29%7D%7Bn%7D%5Cright%29%5Ctext%7Blog%7D%281-z%5C_%7Bi%7D%29%2B2z%5C_%7Bi%7D%5Cright%5C%5D" title="{A}_{R}^{2}= -\frac{n}{2} - \sum_{i=1}^{n} \left[\left(2-\frac{(2i-1)}{n}\right)\text{log}(1-z_{i})+2z_{i}\right]" alt="{A}_{R}^{2}= - - \{i=1}^{n} \(2-)(1-z\{i})+2z\{i}\"><div class="figcaption">{A}_{R}^{2}= - - \{i=1}^{n} \(2-)(1-z\{i})+2z\{i}\</div>
</div>
<p>where <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;z%3DF%28x%29" title="z=F(x)" alt="z=F(x)"> and <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;n" title="n" alt="n"> is the sample size. The approach in <a href="https://doi.org/10.1002/2016WR019426" class="external-link">Solari et al. (2017)</a> is implemented as follows:</p>
<ol style="list-style-type: decimal">
<li>A time series is declustered using the storm window approach to identify independent peaks.</li>
<li>Candidate thresholds are defined by ordering the peaks and removing any repeated values. A GPD is fit to all the peaks above each candidate threshold. The right-tail weighted Anderson-Darling statistic <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;A_R%5E2" title="A_R^2" alt="A_R^2"> and its corresponding p-value are calculated for each threshold.</li>
<li>The threshold that minimizes one minus the p-value is then selected.</li>
</ol>
<p>The <code><a href="reference/GPD_Threshold_Solari.html">GPD_Threshold_Solari()</a></code> function carries out these steps.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Rainfall.Solari</span><span class="op">&lt;-</span><span class="fu"><a href="reference/GPD_Threshold_Solari.html">GPD_Threshold_Solari</a></span><span class="op">(</span>Event<span class="op">=</span><span class="va">S20.Rainfall.Declustered.SW</span><span class="op">$</span><span class="va">Declustered</span>,</span>
<span>                                          Data<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="do">## Error in solve.default(family$info(o)) : </span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="do">##   system is computationally singular: reciprocal condition number = 2.95579e-17</span></span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a><span class="do">## Error in diag(o$cov) : invalid 'nrow' value (too large or NA)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-31-1.png"><!-- --></p>
<p>The optimum threshold according to the Solari approach is</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Rainfall.Solari</span><span class="op">$</span><span class="va">Candidate_Thres</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="do">## [1] 2.6</span></span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Rainfall.Thres.Quantile</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span><span class="op">(</span><span class="va">S20.Rainfall.Solari</span><span class="op">$</span><span class="va">Candidate_Thres</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="reference/GPD_Threshold_Solari_Sel.html">GPD_Threshold_Solari_Sel()</a></code> allows the goodness-of-fit at a particular threshold (<code>Thres</code>) to be investigated in more detail. Let’s study the fit of the threshold selected by the method.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Solari.Sel</span><span class="op">&lt;-</span><span class="fu"><a href="reference/GPD_Threshold_Solari_Sel.html">GPD_Threshold_Solari_Sel</a></span><span class="op">(</span>Event<span class="op">=</span><span class="va">S20.Rainfall.Declustered.SW</span><span class="op">$</span><span class="va">Declustered</span>,</span>
<span>                                    Data<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span>,</span>
<span>                                    Solari_Output<span class="op">=</span><span class="va">S20.Rainfall.Solari</span>,</span>
<span>                                    Thres<span class="op">=</span><span class="va">S20.Rainfall.Solari</span><span class="op">$</span><span class="va">Candidate_Thres</span>,</span>
<span>                                    RP_Max<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-34-1.png"><!-- --></p>
<p>Repeating the automated threshold selection procedure for O-sWL.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.OsWL.Solari</span><span class="op">&lt;-</span><span class="fu"><a href="reference/GPD_Threshold_Solari.html">GPD_Threshold_Solari</a></span><span class="op">(</span>Event<span class="op">=</span><span class="va">S20.OsWL.Declustered.SW</span><span class="op">$</span><span class="va">Declustered</span>,</span>
<span>                                      Data<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="do">## Error in solve.default(family$info(o)) : </span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="do">##   system is computationally singular: reciprocal condition number = 8.64997e-17</span></span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a><span class="do">## Error in diag(o$cov) : invalid 'nrow' value (too large or NA)</span></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a><span class="do">## Error in solve.default(family$info(o)) : </span></span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a><span class="do">##   system is computationally singular: reciprocal condition number = 4.62425e-17</span></span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a><span class="do">## Error in diag(o$cov) : invalid 'nrow' value (too large or NA)</span></span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a><span class="do">## Error in solve.default(family$info(o)) : </span></span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a><span class="do">##   Lapack routine dgesv: system is exactly singular: U[2,2] = 0</span></span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a><span class="do">## Error in diag(o$cov) : invalid 'nrow' value (too large or NA)</span></span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a><span class="do">## Error in solve.default(family$info(o)) : </span></span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a><span class="do">##   system is computationally singular: reciprocal condition number = 4.20545e-17</span></span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a></span>
<span id="cb49-19"><a href="#cb49-19" tabindex="-1"></a><span class="do">## Error in diag(o$cov) : invalid 'nrow' value (too large or NA)</span></span>
<span id="cb49-20"><a href="#cb49-20" tabindex="-1"></a></span>
<span id="cb49-21"><a href="#cb49-21" tabindex="-1"></a><span class="do">## Error in solve.default(family$info(o)) : </span></span>
<span id="cb49-22"><a href="#cb49-22" tabindex="-1"></a><span class="do">##   system is computationally singular: reciprocal condition number = 1.05465e-16</span></span>
<span id="cb49-23"><a href="#cb49-23" tabindex="-1"></a></span>
<span id="cb49-24"><a href="#cb49-24" tabindex="-1"></a><span class="do">## Error in diag(o$cov) : invalid 'nrow' value (too large or NA)</span></span>
<span id="cb49-25"><a href="#cb49-25" tabindex="-1"></a></span>
<span id="cb49-26"><a href="#cb49-26" tabindex="-1"></a><span class="do">## Error in solve.default(family$info(o)) : </span></span>
<span id="cb49-27"><a href="#cb49-27" tabindex="-1"></a><span class="do">##   Lapack routine dgesv: system is exactly singular: U[2,2] = 0</span></span>
<span id="cb49-28"><a href="#cb49-28" tabindex="-1"></a></span>
<span id="cb49-29"><a href="#cb49-29" tabindex="-1"></a><span class="do">## Error in diag(o$cov) : invalid 'nrow' value (too large or NA)</span></span>
<span id="cb49-30"><a href="#cb49-30" tabindex="-1"></a></span>
<span id="cb49-31"><a href="#cb49-31" tabindex="-1"></a><span class="do">## Error in solve.default(family$info(o)) : </span></span>
<span id="cb49-32"><a href="#cb49-32" tabindex="-1"></a><span class="do">##   system is computationally singular: reciprocal condition number = 4.43525e-17</span></span>
<span id="cb49-33"><a href="#cb49-33" tabindex="-1"></a></span>
<span id="cb49-34"><a href="#cb49-34" tabindex="-1"></a><span class="do">## Error in diag(o$cov) : invalid 'nrow' value (too large or NA)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-35-1.png"><!-- --></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.OsWL.Solari</span><span class="op">$</span><span class="va">Candidate_Thres</span></span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="do">## [1] 2.032</span></span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">OsWL.Thres.Quantile</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">)</span><span class="op">(</span><span class="va">S20.OsWL.Solari</span><span class="op">$</span><span class="va">Candidate_Thres</span><span class="op">)</span></span></code></pre></div>
<p>and checking the fit of the GPD at the selected threshold.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Solari.Sel</span><span class="op">&lt;-</span><span class="fu"><a href="reference/GPD_Threshold_Solari_Sel.html">GPD_Threshold_Solari_Sel</a></span><span class="op">(</span>Event<span class="op">=</span><span class="va">S20.OsWL.Declustered.SW</span><span class="op">$</span><span class="va">Declustered</span>,</span>
<span>                                     Data<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span>,</span>
<span>                                     Solari_Output<span class="op">=</span><span class="va">S20.OsWL.Solari</span>,</span>
<span>                                     Thres<span class="op">=</span><span class="va">S20.OsWL.Solari</span><span class="op">$</span><span class="va">Candidate_Thres</span>,</span>
<span>                                     RP_Max<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-38-1.png"><!-- --></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="id_3-correlation-analysis">3. Correlation analysis<a class="anchor" aria-label="anchor" href="#id_3-correlation-analysis"></a>
</h2>
<p>We can use the <code><a href="reference/Kendall_Lag.html">Kendall_Lag()</a></code> function to view the Kendall’s rank correlations coefficient <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Ctau" title="\tau" alt=""> between the time series over a range of lags</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Kendall.Results</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Kendall_Lag.html">Kendall_Lag</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.df</span>,GAP<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-39-1.png"><!-- --></p>
<p>Let’s pull out the Kendall correlation coefficient values between rainfall and O-sWL for lags of <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%E2%88%925%2C%E2%80%86...%2C%E2%80%860%2C%E2%80%86..%2C5" title="−5, ..., 0, ..,5" alt="−5, …, 0, ..,5"> applied to the latter quantity</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Kendall.Results</span><span class="op">$</span><span class="va">Value</span><span class="op">$</span><span class="va">Rainfall_OsWL</span></span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="do">##  [1]  0.046483308  0.051860955  0.051392298  0.051311970  0.054097316</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="do">##  [6]  0.058316831  0.061388245  0.035305812  0.004206059 -0.014356749</span></span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a><span class="do">## [11] -0.025993095 -0.030431776 -0.029481162</span></span></code></pre></div>
<p>and the corresponding p-values testing the null hypothesis <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Ctau%3D0" title="\tau=0" alt=""></p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Kendall.Results</span><span class="op">$</span><span class="va">Test</span><span class="op">$</span><span class="va">Rainfall_OsWL_Test</span></span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="do">##  [1] 5.819748e-13 1.014698e-15 8.196547e-16 1.030482e-15 5.160274e-17</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a><span class="do">##  [6] 1.887733e-19 1.987221e-20 2.232548e-07 4.033739e-01 7.669577e-02</span></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a><span class="do">## [11] 1.186248e-03 6.352872e-05 3.864403e-05</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="id_4-bivariate-analysis">4. Bivariate Analysis<a class="anchor" aria-label="anchor" href="#id_4-bivariate-analysis"></a>
</h2>
<div class="section level4">
<h4 id="two-sided-conditional-sampling---copula-theory-method">Two-sided conditional sampling - copula theory method<a class="anchor" aria-label="anchor" href="#two-sided-conditional-sampling---copula-theory-method"></a>
</h4>
<p>In the report the 2D analysis considers the two forcings currently accounted for in structural design assessments undertaken by SFWMD: rainfall and O-sWL. The 2D analysis commences with the well-established two-sided conditional sampling approach, where excesses of a conditioning variable are paired with co-occurring values of another variable to create two samples. For each sample the marginals (one extreme, one non-extreme) and joint distribution are then modeled.</p>
<p>The two (conditional) joint distributions are modeled independently of the marginals by using a copula. The <code><a href="reference/Copula_Threshold_2D.html">Copula_Threshold_2D()</a></code> function explores the sensitivity of the best fitting copula, in terms of Akaike Information Criterion (AIC), to allow the practitioner to make an informed choice with regards to threshold selection. It undertakes the conditional sampling described above and reports the best fitting bivariate copula. The procedure is carried out for a single or range of thresholds specified by the <code>u</code> argument and the procedure is automatically repeated with the variables switched.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/Copula_Threshold_2D.html">Copula_Threshold_2D</a></span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>Data_Declust<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>y_lim_min<span class="op">=</span><span class="op">-</span><span class="fl">0.075</span>, y_lim_max <span class="op">=</span><span class="fl">0.25</span>,</span>
<span>Upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">9</span><span class="op">)</span>, Lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">10</span><span class="op">)</span>,GAP<span class="op">=</span><span class="fl">0.15</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-42-1.png"><!-- --></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="do">## $Kendalls_Tau1</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a><span class="do">##  [1] 0.05627631 0.05803451 0.05900376 0.08072261 0.10731477 0.14151449</span></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a><span class="do">##  [7] 0.14427232 0.14762199 0.13101587 0.05056147</span></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a><span class="do">## $p_value_Var1</span></span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a><span class="do">##  [1] 7.698074e-03 9.251524e-03 1.424015e-02 1.974145e-03 1.559739e-04</span></span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a><span class="do">##  [6] 1.171141e-05 4.256557e-05 2.055448e-04 6.000832e-03 4.413023e-01</span></span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a><span class="do">## $N_Var1</span></span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a><span class="do">##  [1] 1008  904  776  661  559  432  363  286  200  107</span></span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a><span class="do">## $Copula_Family_Var1</span></span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a><span class="do">##  [1]  6  6  6  6  6  6  6 13  6  6</span></span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a><span class="do">## $Kendalls_Tau2</span></span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a><span class="do">##  [1] 0.1113049 0.1359921 0.1377104 0.1561184 0.1579352 0.1359861 0.1183870</span></span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a><span class="do">##  [8] 0.1463056 0.1482198 0.1904729</span></span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb60-19"><a href="#cb60-19" tabindex="-1"></a><span class="do">## $p_value_Var2</span></span>
<span id="cb60-20"><a href="#cb60-20" tabindex="-1"></a><span class="do">##  [1] 2.720713e-05 2.549673e-06 1.199322e-05 1.143046e-05 1.879301e-04</span></span>
<span id="cb60-21"><a href="#cb60-21" tabindex="-1"></a><span class="do">##  [6] 1.335664e-02 5.199742e-02 3.145804e-02 6.891926e-02 8.220838e-02</span></span>
<span id="cb60-22"><a href="#cb60-22" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb60-23"><a href="#cb60-23" tabindex="-1"></a><span class="do">## $N_Var2</span></span>
<span id="cb60-24"><a href="#cb60-24" tabindex="-1"></a><span class="do">##  [1] 760 639 535 416 290 168 136 110  77  43</span></span>
<span id="cb60-25"><a href="#cb60-25" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb60-26"><a href="#cb60-26" tabindex="-1"></a><span class="do">## $Copula_Family_Var2</span></span>
<span id="cb60-27"><a href="#cb60-27" tabindex="-1"></a><span class="do">##  [1]   6   6   6   6 204 204 204 204   1 204</span></span></code></pre></div>
<p>The <code><a href="reference/Diag_Non_Con.html">Diag_Non_Con()</a></code> function is designed to aid in the selection of the appropriate (non-extreme) unbounded marginal distribution for the non-conditioned variable.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Rainfall</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Con_Sampling_2D.html">Con_Sampling_2D</a></span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>Data_Declust<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>Con_Variable<span class="op">=</span><span class="st">"Rainfall"</span>,u <span class="op">=</span> <span class="va">Rainfall.Thres.Quantile</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/Diag_Non_Con.html">Diag_Non_Con</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Rainfall</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">OsWL</span>,Omit<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gum"</span>,<span class="st">"RGum"</span><span class="op">)</span>,x_lab<span class="op">=</span><span class="st">"O-sWL (ft NGVD 29)"</span>,y_lim_min<span class="op">=</span><span class="fl">0</span>,y_lim_max<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-43-1.png"><!-- --></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="do">## $AIC</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="do">##   Distribution      AIC</span></span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a><span class="do">## 1         Gaus 81.27871</span></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a><span class="do">## 2          Gum       NA</span></span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a><span class="do">## 3         Lapl 92.82204</span></span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a><span class="do">## 4        Logis 84.19031</span></span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a><span class="do">## 5         RGum       NA</span></span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a><span class="do">## $Best_fit</span></span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a><span class="do">## [1] "Gaus"</span></span></code></pre></div>
<p>The <code><a href="reference/Diag_Non_Con_Sel.html">Diag_Non_Con_Sel()</a></code> function, is similar to the <code><a href="reference/Diag_Non_Con.html">Diag_Non_Con()</a></code> command, but only plots the probability density function and cumulative distribution function of a (single) selected univariate distribution in order to more clearly demonstrate the goodness of fit of a particular distribution. The options are the Gaussian (<code>Gaus</code>), Gumbel (<code>Gum</code>), Laplace (<code>Lapl</code>), logistic (<code>Logis</code>) and reverse Gumbel (<code>RGum</code>) distributions.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/Diag_Non_Con_Sel.html">Diag_Non_Con_Sel</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Rainfall</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">OsWL</span>,x_lab<span class="op">=</span><span class="st">"O-sWL (ft NGVD 29)"</span>,</span>
<span>y_lim_min<span class="op">=</span><span class="fl">0</span>,y_lim_max<span class="op">=</span><span class="fl">1.5</span>,Selected<span class="op">=</span><span class="st">"Logis"</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-44-1.png"><!-- --></p>
<p>A generalized Pareto distribution is fitted to the marginal distribution of the conditioning variable i.e. the declustered excesses identified using <code><a href="reference/Con_Sampling_2D.html">Con_Sampling_2D()</a></code>.</p>
<p>The process of selecting a conditional sample and fitting marginal distributions is repeated but instead conditioning on O-sWL. The non-conditional variable in this case is (total daily) rainfall, which has a lower bound at zero, and thus requires a suitably truncated distribution. The <code>Diag_Non_Con_Trunc</code> fits a selection of truncated distributions to a vector of data. The <code>Diag_Non_Con_Sel_Trunc</code> function is analogous to the <code>Diag_Non_Con_Sel</code> function, available distributions are the Birnbaum-Saunders (<code>BS</code>), exponential (<code>Exp</code>), gamma (<code>Gam(2)</code>), inverse Gaussian (<code>InvG</code>), lognormal (<code>LogN</code>), Tweedie (<code>Twe</code>) and Weibull (<code>Weib</code>). If the gamlss and gamlss.mx packages are loaded then the three-parameter gamma (<code>Gam(3)</code>), two-parameter mixed gamma (<code>GamMix(2)</code>) and three-parameter mixed gamma (<code>GamMix(3)</code>) distributions are also tested.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.OsWL</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Con_Sampling_2D.html">Con_Sampling_2D</a></span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>Data_Declust<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>Con_Variable<span class="op">=</span><span class="st">"OsWL"</span>,u<span class="op">=</span><span class="va">OsWL.Thres.Quantile</span><span class="op">)</span></span>
<span><span class="va">S20.OsWL</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">&lt;-</span><span class="va">S20.OsWL</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S20.OsWL</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span>,<span class="fl">0.001</span>,<span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/Diag_Non_Con_Trunc.html">Diag_Non_Con_Trunc</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.OsWL</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">+</span><span class="fl">0.001</span>,x_lab<span class="op">=</span><span class="st">"Rainfall (Inches)"</span>,</span>
<span>y_lim_min<span class="op">=</span><span class="fl">0</span>,y_lim_max<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-45-1.png"><!-- --></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="do">## $AIC</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a><span class="do">##   Distribution         AIC</span></span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a><span class="do">## 1           BS   0.2630392</span></span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a><span class="do">## 2          Exp 109.0840279</span></span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a><span class="do">## 3       Gam(2)  27.8836710</span></span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a><span class="do">## 4       Gam(3)  28.9600006</span></span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a><span class="do">## 5        LNorm  24.4843990</span></span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a><span class="do">## 6        TNorm 216.4303270</span></span>
<span id="cb65-9"><a href="#cb65-9" tabindex="-1"></a><span class="do">## 7          Twe  22.8913129</span></span>
<span id="cb65-10"><a href="#cb65-10" tabindex="-1"></a><span class="do">## 8         Weib  26.2243487</span></span>
<span id="cb65-11"><a href="#cb65-11" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb65-12"><a href="#cb65-12" tabindex="-1"></a><span class="do">## $Best_fit</span></span>
<span id="cb65-13"><a href="#cb65-13" tabindex="-1"></a><span class="do">## [1] "BS"</span></span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/Diag_Non_Con_Trunc_Sel.html">Diag_Non_Con_Trunc_Sel</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.OsWL</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">+</span><span class="fl">0.001</span>,x_lab<span class="op">=</span><span class="st">"Rainfall (Inches)"</span>,</span>
<span>y_lim_min<span class="op">=</span><span class="fl">0</span>,y_lim_max<span class="op">=</span><span class="fl">2</span>,</span>
<span>Selected<span class="op">=</span><span class="st">"BS"</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-46-1.png"><!-- --></p>
<p>The <code><a href="reference/Design_Event_2D.html">Design_Event_2D()</a></code> function finds the isoline associated with a particular return period, by overlaying the two corresponding isolines from the joint distributions fitted to the conditional samples using the method in Bender et al. (2016). <code><a href="reference/Design_Event_2D.html">Design_Event_2D()</a></code> requires the copulas families chosen to model the dependence structure in the two conditional samples as input.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Copula.Rainfall</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Copula_Threshold_2D.html">Copula_Threshold_2D</a></span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>Data_Declust<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>u1<span class="op">=</span><span class="va">Rainfall.Thres.Quantile</span>,u2<span class="op">=</span><span class="cn">NA</span>,</span>
<span>y_lim_min<span class="op">=</span><span class="fl">0</span>,y_lim_max<span class="op">=</span><span class="fl">0.25</span>, GAP<span class="op">=</span><span class="fl">0.075</span><span class="op">)</span><span class="op">$</span><span class="va">Copula_Family_Var1</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-47-1.png"><!-- --></p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Copula.OsWL</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Copula_Threshold_2D.html">Copula_Threshold_2D</a></span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>Data_Declust<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>u1<span class="op">=</span><span class="cn">NA</span>,u2<span class="op">=</span><span class="va">OsWL.Thres.Quantile</span>,</span>
<span>y_lim_min<span class="op">=</span><span class="fl">0</span>,y_lim_max<span class="op">=</span><span class="fl">0.25</span>,GAP<span class="op">=</span><span class="fl">0.075</span><span class="op">)</span><span class="op">$</span><span class="va">Copula_Family_Var2</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-48-1.png"><!-- --></p>
<p>As input the function requires</p>
<ul>
<li>
<code>Data</code> = Original (detrended) rainfall and O-sWL series</li>
<li>
<code>Data_Con1</code>/<code>Data_Con2</code> = two conditionally sampled data sets,</li>
<li>
<code>u1</code>/<code>u2</code> or <code>Thres1</code>/<code>Thres2</code> = two thresholds associated with the conditionally sampled data sets</li>
<li>
<code>Copula_Family1</code>/<code>Copula_Family2</code> two families of the two fitted copulas</li>
<li>
<code>Marginal_Dist1</code>/<code>Marginal_Dist2</code>Selected non-extreme marginal distributions</li>
<li>
<code>RP</code> = Return Period of interest</li>
<li>
<code>N</code> = size of the sample from the fitted joint distributions used to estimate the density along the isoline of interest</li>
<li>
<code>N_Ensemble</code> = size of the ensemble of events sampled along the isoline of interest</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Bivariate</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Design_Event_2D.html">Design_Event_2D</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>, </span>
<span>Data_Con1<span class="op">=</span><span class="va">S20.Rainfall</span><span class="op">$</span><span class="va">Data</span>, </span>
<span>Data_Con2<span class="op">=</span><span class="va">S20.OsWL</span><span class="op">$</span><span class="va">Data</span>, </span>
<span>u1<span class="op">=</span><span class="va">Rainfall.Thres.Quantile</span>, </span>
<span>u2<span class="op">=</span><span class="va">OsWL.Thres.Quantile</span>, </span>
<span>Copula_Family1<span class="op">=</span><span class="va">S20.Copula.Rainfall</span>,</span>
<span>Copula_Family2<span class="op">=</span><span class="va">S20.Copula.OsWL</span>, </span>
<span>Marginal_Dist1<span class="op">=</span><span class="st">"Logis"</span>, Marginal_Dist2<span class="op">=</span><span class="st">"BS"</span>,</span>
<span>x_lab<span class="op">=</span><span class="st">"Rainfall (Inches)"</span>,y_lab<span class="op">=</span><span class="st">"O-sWL (ft NGVD 29)"</span>,</span>
<span>RP<span class="op">=</span><span class="fl">100</span>,N<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">7</span>,N_Ensemble<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-49-1.png"><!-- --></p>
<p>Design event according to the “Most likely” event approach (diamond in the plot)</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Bivariate</span><span class="op">$</span><span class="va">MostLikelyEvent</span><span class="op">$</span><span class="va">`100`</span></span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="do">##    Rainfall     OsWL</span></span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a><span class="do">## 1 0.1710665 3.175327</span></span></code></pre></div>
<p>Design event under the assumption of full dependence (triangle in the plot)</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Bivariate</span><span class="op">$</span><span class="va">FullDependence</span><span class="op">$</span><span class="va">`100`</span></span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="do">##   Rainfall OsWL</span></span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a><span class="do">## 1    14.56  3.3</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="cooley-2019-projection-method">Cooley (2019) projection method<a class="anchor" aria-label="anchor" href="#cooley-2019-projection-method"></a>
</h4>
<p><a href="https://doi.org/10.1007/s10687-019-00348-0" class="external-link">Cooley et al. (2019)</a> puts forward a non-parametric approach for constructing the isoline associated with exceedance probability <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;p" title="p" alt="p">. The approach centers around constructing a base isoline with a larger exceedance probability <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;p_%7Bbase%7D%20%3C%20p" title="p_{base} &lt; p" alt="p_{base} &lt; p"> and projecting it to more extreme levels. <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;p_%7Bbase%7D" title="p_{base}" alt="p_{base}"> should be small enough to be representative of the extremal dependence but large enough for sufficient data to be involved in the estimation procedure.</p>
<p>The approach begins by approximating the joint survival function via a kernel density estimator from which the base isoline is derived. For the marginal distributions, a GPD is fit above a sufficiently high threshold to allow extrapolation into the tails and the empirical distribution is used below the threshold. Unless the joint distribution of the two variables is regularly varying, a marginal transformation is required for the projection. The two marginals are thus transformed to Frechet scales. For asymptotic dependence, on the transformed scale the isoline with exceedance probability <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;p" title="p" alt="p"> can be obtained as <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;l_%7BT%7D%28p%29%3Ds%5E%7B%E2%88%921%7Dl_T%28p_%7Bbase%7D%29" title="l_{T}(p)=s^{−1}l_T(p_{base})" alt="l_{T}(p)=s^{−1}l_T(p_{base})"> where <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Cfrac%7Bp_%7Bbase%7D%7D%7Bp%7D%20%3E%201" title="\frac{p_{base}}{p} &gt; 1" alt=" &gt; 1">. For the case of asymptotic independence, <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;l_%7BT%7D%28p%29%3Ds%5E%7B%5Cfrac%7B1%7D%7B%5Ceta%7D%7Dl_%7BT%7D%28p_%7Bbase%7D%29" title="l_{T}(p)=s^{\frac{1}{\eta}}l_{T}(p_{base})" alt="l_{T}(p)=s^{}l_{T}(p_{base})">, where <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Ceta" title="\eta" alt=""> is the tail dependence coefficient. Applying the inverse Frechet transformation gives the isoline on the original scale.</p>
<p>Let’s estimate the 100-year (p=0.01) rainfall-OsWL isoline at S20 using the 10-year isoline as the base isoline.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Fitting the marginal distribution</span></span>
<span><span class="co">#See next section for information on the Migpd_Fit function</span></span>
<span><span class="va">S20.GPD</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Migpd_Fit.html">Migpd_Fit</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, Data_Full <span class="op">=</span> <span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, </span>
<span>                   mqu <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.99</span>,<span class="fl">0.99</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#10-year exceedance probability for daily data</span></span>
<span><span class="va">p.10</span><span class="op">&lt;-</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">365.25</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span>
<span><span class="co">#10-year exceedance probability for daily data</span></span>
<span><span class="va">p.100</span><span class="op">&lt;-</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">365.25</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span><span class="co">#Calculating the isoline</span></span>
<span><span class="va">isoline</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Cooley19.html">Cooley19</a></span><span class="op">(</span>Data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,Migpd<span class="op">=</span><span class="va">S20.GPD</span>,</span>
<span>                  p.base<span class="op">=</span><span class="va">p.10</span>,p.proj<span class="op">=</span><span class="va">p.100</span>,PLOT<span class="op">=</span><span class="cn">TRUE</span>,x_lim_max_T<span class="op">=</span><span class="fl">15000</span>,y_lim_max_T<span class="op">=</span><span class="fl">15000</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-52-1.png"><!-- --></p>
</div>
<div class="section level4">
<h4 id="radial-based-isolines">Radial-based isolines<a class="anchor" aria-label="anchor" href="#radial-based-isolines"></a>
</h4>
<p>When the dependence structure between two variables differs significantly across conditional samples — as captured by their respective copulas — it can produce an inflection point in certain regions of the probability space when overlaying the partial isolines. While these effects are mathematically sound, they represent methodological artifacts rather than natural phenomena, potentially limiting the physical interpretability of results in these regions of the joint distribution. <a href="https://doi.org/10.1002/env.2797" class="external-link">Murphy-Barltrop et al. (2023)</a> proposed new estimation methods for bivariate isolines that avoid fitting copulas while accounting for both asymptotic independence (AI) and asymptotic dependence (AD). Their techniques exploit existing bivariate extreme value models — specifically the <a href="https://doi.org/10.1111/j.1467-9868.2004.02050.x" class="external-link">Heffernan and Tawn (2004)</a> <a href="#ht04">HT04</a> and <a href="https://doi.org/10.3150/12-BEJ471" class="external-link">Wadsworth and Tawn (2013)</a> [WT13] approaches. An additional benefit of these new approaches is that it is possible to derive confidence intervals that account for the sampling uncertainty.</p>
<p>When employing the HT04 model to construct the isoline with exceedance probability <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;p" title="p" alt="p">, the first step is to convert the variables <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%28X%2CY%29" title="(X,Y)" alt="(X,Y)"> to the Laplace scale <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%28X_L%2CY_L%29" title="(X_L,Y_L)" alt="(X_L,Y_L)">. The HT04 model is a conditional exceedance model and is therefore fit twice, conditioning on both <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;X_L" title="X_L" alt="X_L"> and <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;Y_L" title="Y_L" alt="Y_L"> separately, thus allowing us to estimate the curve in different regions. In particular, we consider the regions defined by <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;R_%7BY_L%7D" title="R_{Y_L}" alt="R_{Y_L}"> where <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;y_L%3Ex_L" title="y_L&gt;x_L" alt="y_L&gt;x_L"> and <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;R_%7BX_L%7D" title="R_{X_L}" alt="R_{X_L}"> where $ y_{L} x_{L}$. For region <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;R_%7BY_L%7D" title="R_{Y_L}" alt="R_{Y_L}">, we start by selecting a high threshold <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;u_%7BY_L%7D" title="u_{Y_L}" alt="u_{Y_L}"> such that <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;P%28Y_%7BL%7D%3Eu_%7BY_L%7D%29%3Ep" title="P(Y_{L}&gt;u_{Y_L})&gt;p" alt="P(Y_{L}&gt;u_{Y_L})&gt;p"> and fit the HT04 model to observations where <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;y_L%3Eu_%7BY_L%7D" title="y_L&gt;u_{Y_L}" alt="y_L&gt;u_{Y_L}">. Next, a decreasing series of thresholds is defined in the interval <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%28u_%7BY_L%7D%2CF%5E%7B-1%7D_%7BY_L%7D%281-p%29%29" title="(u_{Y_L},F^{-1}_{Y_L}(1-p))" alt="(u_{Y_L},F^{-1}_{Y_L}(1-p))"> where <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;u_%7BY_L%7D" title="u_{Y_L}" alt="u_{Y_L}"> is the minimal quantile for which the fitted model is valid and <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;F%5E%7B-1%7D_%7BY_%7BL%7D%7D%281-p%29" title="F^{-1}_{Y_{L}}(1-p)" alt="F^{-1}_{Y_{L}}(1-p)"> is the limit that values can attain on this curve. For a given quantile in the interval <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;y%2A" title="y*" alt="y*">, use the model to simulate from the conditional distribution <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;X_%7BL%7D%20%7C%20Y_%7BL%7D%3Ey%2A" title="X_{L} | Y_{L}&gt;y*" alt="X_{L} | Y_{L}&gt;y*"> and estimate <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;x%2A" title="x*" alt="x*"> the <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%281-p%2Fq%29" title="(1-p/q)" alt="(1-p/q)">th quantile. Since <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;q%3DP%28Y_L%3Ey%2A%29" title="q=P(Y_L&gt;y*)" alt="q=P(Y_L&gt;y*)"> and</p>
<div class="float">
<img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;P%28X_L%3Ex%2A%20%2CY_L%3Ey%2A%29%20%3D%20P%28X_L%3Ex%2A%20%7C%20Y_L%3Ey%2A%29P%28Y_L%3Ey%2A%29%20%3D%20p%2Fq%20%5Ctimes%20q%20%3D%20p" title="P(X_L&gt;x* ,Y_L&gt;y*) = P(X_L&gt;x* | Y_L&gt;y*)P(Y_L&gt;y*) = p/q \times q = p" alt="P(X_L&gt;x* ,Y_L&gt;y*) = P(X_L&gt;x* | Y_L&gt;y*)P(Y_L&gt;y*) = p/q q = p"><div class="figcaption">P(X_L&gt;x* ,Y_L&gt;y*) = P(X_L&gt;x* | Y_L&gt;y*)P(Y_L&gt;y*) = p/q q = p</div>
</div>
<p>, the point <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%28x%2A%2Cy%2A%29" title="(x*,y*)" alt="(x*,y*)"> lies on the isoline. The process is repeated until a value <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;x%2A%2A" title="x**" alt="x**"> where <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;x%2A%2A%5Cleq%20y%2A" title="x**\leq y*" alt="x**y*"> is obtained or we exhaust all values in the interval. A very similar procedure is implemented for region <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;R_%7BX_L%7D" title="R_{X_L}" alt="R_{X_L}">, this time selecting <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;u_%7BX_L%7D" title="u_{X_L}" alt="u_{X_L}">, a high quantile of <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;X_L" title="X_L" alt="X_L"> for quantiles in the interval <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%28x%5E%7B%27%7D%2A%2A%2CF%5E%7B-1%7D_%7BX_L%7D%281-p%29%29" title="(x^{'}**,F^{-1}_{X_L}(1-p))" alt="(x{’}**,F{-1}_{X_L}(1-p))"> where <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%28x%5E%7B%27%7D%2A%2A%3Dx%2A%2A%29" title="(x^{'}**=x**)" alt="(x^{’}**=x**)"> if it exists and <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;u_%7BX_L%7D" title="u_{X_L}" alt="u_{X_L}"> otherwise.</p>
<p>The WT13 model is defined in terms of <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;T_w%20%3A%3D%20%5Cmin%5Cleft%5C%7B%5Cfrac%7BX%7D%7Bw%7D%2C%5Cfrac%7BY%7D%7B1-w%7D%5Cright%5C%7D" title="T_w := \min\left{\frac{X}{w},\frac{Y}{1-w}\right}" alt="T_w := \,\"> where <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%28X%2CY%29" title="(X,Y)" alt="(X,Y)"> are a pair of variables with standard exponential marginal distributions, for any ray in <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5B0%2C1%5D" title="[0,1]" alt="[0,1]">,</p>
<div class="float">
<img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5CPr%28T_w%20%3E%20t%29%20%3D%20L%28t%7Cw%29%20%5Cexp%28-%5Clambda%28w%29t%29%2C%20%5Cquad%20%5Clambda%28w%29%20%5Cgeq%20%5Cmax%28w%2C1-w%29" title="\Pr(T_w &gt; t) = L(t|w) \exp(-\lambda(w)t), \quad \lambda(w) \geq \max(w,1-w)" alt="(T_w &gt; t) = L(t|w) (-(w)t), (w) (w,1-w)"><div class="figcaption">(T_w &gt; t) = L(t|w) (-(w)t), (w) (w,1-w)</div>
</div>
<p>where <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;L%28%5Ccdot%7Cw%29" title="L(\cdot|w)" alt="L(|w)"> is slowly varying for each ray <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;w%20%5Cin%20%5B0%2C1%5D" title="w \in [0,1]" alt="w [0,1]"> and <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Clambda%28w%29" title="\lambda(w)" alt="(w)"> is termed the angular dependence function. To find the isoline with exceedance probability <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;p%20%3C%20p%5E%7B%5Cast%7D" title="p &lt; p^{\ast}" alt="p &lt; p^{}">, a set <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;W" title="W" alt="W"> of equally spaced rays on <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5B0%2C1%5D" title="[0,1]" alt="[0,1]"> is defined and for each ray estimating the angular dependence function via the Hill estimator <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Chat%7B%5Clambda%7D%28w%29" title="\hat{\lambda}(w)" alt="(w)"> using observations above the <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;95%5C%25" title="95%" alt="95\"> quantile of the variable <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;T_w" title="T_w" alt="T_w">. For any large <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;u" title="u" alt="u">, WT13 states that <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5CPr%28T_w%20%3E%20t%20%2B%20u%20%7C%20T_w%20%3E%20u%29%20%5Capprox%20%5Cexp%28-t%5Chat%7B%5Clambda%7D%28w%29%29" title="\Pr(T_w &gt; t + u | T_w &gt; u) \approx \exp(-t\hat{\lambda}(w))" alt="(T_w &gt; t + u | T_w &gt; u) (-t(w))"> for any <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;w%20%5Cin%20%5B0%2C1%5D" title="w \in [0,1]" alt="w [0,1]"> and <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;t%20%3E%200" title="t &gt; 0" alt="t &gt; 0">. If <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;u" title="u" alt="u"> is the <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%281-p%5E%7B%5Cast%7D%29%5E%7B%5Ctext%7Bth%7D%7D" title="(1-p^{\ast})^{\text{th}}" alt="(1-p{}){}"> quantile of <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;T_w" title="T_w" alt="T_w"> i.e., <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5CPr%28T_w%20%3E%20u%29%20%3D%20p%5E%7B%5Cast%7D" title="\Pr(T_w &gt; u) = p^{\ast}" alt="(T_w &gt; u) = p^{}">, then</p>
<div class="float">
<img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;p%3D%5CPr%28T_w%20%3E%20t%20%2B%20u%29%20%3D%20%5CPr%28T_w%20%3E%20t%20%2B%20u%20%7C%20T_w%20%3E%20u%29%5CPr%28T_w%20%3E%20u%29%20%3D%20p%5E%7B%5Cast%7D%5Cexp%28-t%5Chat%7B%5Clambda%7D%28w%29%29" title="p=\Pr(T_w &gt; t + u) = \Pr(T_w &gt; t + u | T_w &gt; u)\Pr(T_w &gt; u) = p^{\ast}\exp(-t\hat{\lambda}(w))" alt="p=(T_w &gt; t + u) = (T_w &gt; t + u | T_w &gt; u)(T_w &gt; u) = p^{}(-t(w))"><div class="figcaption">p=(T_w &gt; t + u) = (T_w &gt; t + u | T_w &gt; u)(T_w &gt; u) = p^{}(-t(w))</div>
</div>
<p>. Re-arranging for <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;t" title="t" alt="t"> gives <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;t%20%3D%20-%5Cfrac%7B1%7D%7B%5Chat%7B%5Clambda%7D%28w%29%7D%5Clog%5Cleft%28%5Cfrac%7Bp%7D%7Bp%5E%7B%5Cast%7D%7D%5Cright%29" title="t = -\frac{1}{\hat{\lambda}(w)}\log\left(\frac{p}{p^{\ast}}\right)" alt="t = -()">. An estimate for the return curve with exceedance probability <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;p" title="p" alt="p"> is obtained by letting <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%28x%2Cy%29%20%3D%20%28w%28t%2Bu%29%2C%281-w%29%28t%2Bu%29%29" title="(x,y) = (w(t+u),(1-w)(t+u))" alt="(x,y) = (w(t+u),(1-w)(t+u))">.</p>
<p>The confidence intervals for isolines are estimated using a bootstrap procedure following the methodology outlined in Murphy-Barltrop et al. (2023). In the procedure a set of rays are defined at equally-spaced angles within the interval <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%280%2C%5Cpi%2F2%29" title="(0,\pi/2)" alt="(0,/2)">. Each ray intersects the isoline exactly once, and since the angle is fixed, the L2 norm represents the radial distance to the intersection point. Next, the observed data set is bootstrapped a large number of times (e.g., 1000 iterations) to generate multiple samples of the same size as the original data set. For each bootstrap sample, the L2 norm is calculated for each ray’s intersection with the fitted isoline. The confidence intervals are then derived by computing the relevant percentiles (e.g., 2.5th and 97.5th percentiles for 95% confidence intervals) of these L2 norms across all bootstrap iterations.</p>
<p>The <code>return_curve_est</code> function derives isolines for a given <code>rp</code>. The quantiles <code>q</code> of the GPDs of the HT04 and WT13 models must be specified along with the average occurrence frequency of the events in the data <code>mu</code>. The methods for declustering the time series and the associated parameters are also required. The bootstrapping procedure for estimate the sampling uncertainty can be carried out using a basic (<code>boot_method = "basic"</code>), block (<code>boot_method = "block"</code>) or monthly (<code>boot_method = "month"</code>) bootstrap. The latter two are recommend where there is a temporal dependence in the data. For the basic bootstrap whether the sampling is carried out with <code>boot_replace = T</code> or without <code>boot_replace = F</code> replacement must be specified while the block bootstrap require <code>"block_length"</code>. The number of number of rays along which to compute points on the curve for each sample <code>n_grad</code> is another input. For the relative likelihood of points on the isoline to be estimated based on the observations set <code>most_likely =</code> T. For the HT04 model the number of simulations <code>n_sim</code> is required. The function is implemented to find the 100-year isoline at S-22.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Adding dates to complete final month of combined records</span></span>
<span><span class="va">final.month</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-02-04"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-02-28"</span><span class="op">)</span>,by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">final.month</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"Rainfall"</span>,<span class="st">"OsWL"</span>,<span class="st">"Groundwater"</span><span class="op">)</span></span>
<span><span class="va">S22.Detrend.df.extended</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">S22.Detrend.df</span>,<span class="va">final.month</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Derive return curves</span></span>
<span><span class="va">curve</span> <span class="op">=</span> <span class="fu"><a href="reference/return_curve_est.html">return_curve_est</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">S22.Detrend.df.extended</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>                         q<span class="op">=</span><span class="fl">0.985</span>,rp<span class="op">=</span><span class="fl">100</span>,mu<span class="op">=</span><span class="fl">365.25</span>,n_sim<span class="op">=</span><span class="fl">100</span>,</span>
<span>                         n_grad<span class="op">=</span><span class="fl">50</span>,n_boot<span class="op">=</span><span class="fl">100</span>,boot_method<span class="op">=</span><span class="st">"monthly"</span>,</span>
<span>                         boot_replace<span class="op">=</span><span class="cn">NA</span>, block_length<span class="op">=</span><span class="cn">NA</span>, boot_prop<span class="op">=</span><span class="fl">0.8</span>,</span>
<span>                         decl_method_x<span class="op">=</span><span class="st">"runs"</span>, decl_method_y<span class="op">=</span><span class="st">"runs"</span>,</span>
<span>                         window_length_x<span class="op">=</span><span class="cn">NA</span>,window_length_y<span class="op">=</span><span class="cn">NA</span>,</span>
<span>                         u_x<span class="op">=</span><span class="fl">0.95</span>, u_y<span class="op">=</span><span class="fl">0.95</span>,</span>
<span>                         sep_crit_x<span class="op">=</span><span class="fl">36</span>, sep_crit_y<span class="op">=</span><span class="fl">36</span>,</span>
<span>                         most_likely<span class="op">=</span><span class="cn">T</span>, n_ensemble<span class="op">=</span><span class="fl">10</span>,</span>
<span>                         alpha<span class="op">=</span><span class="fl">0.1</span>, x_lab<span class="op">=</span><span class="cn">NA</span>, y_lab<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-53-1.png"><!-- --></p>
<p>The first points on the median curve using the WT13 model are:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">curve</span><span class="op">$</span><span class="va">median_wt13</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="do">##    Rainfall     OsWL</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a><span class="do">## 1 0.2316079 8.538508</span></span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a><span class="do">## 2 0.2550617 8.535290</span></span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a><span class="do">## 3 0.2785156 8.532072</span></span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a><span class="do">## 4 0.3019694 8.528854</span></span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a><span class="do">## 5 0.3254232 8.525636</span></span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a><span class="do">## 6 0.3488771 8.522418</span></span></code></pre></div>
<p>and the corresponding elements of the upper and lower confident bounds are:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">curve</span><span class="op">$</span><span class="va">ub_wt13</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="do">##       Rainfall     OsWL</span></span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a><span class="do">## [1,] 0.5506227 18.89288</span></span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a><span class="do">## [2,] 0.7988372 13.97289</span></span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a><span class="do">## [3,] 1.1172359 13.07803</span></span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a><span class="do">## [4,] 1.3227231 11.70317</span></span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a><span class="do">## [5,] 1.6152622 11.42682</span></span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a><span class="do">## [6,] 1.8764467 11.05923</span></span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">curve</span><span class="op">$</span><span class="va">lb_wt13</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="do">##       Rainfall     OsWL</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a><span class="do">## [1,] 0.1194032 4.896642</span></span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a><span class="do">## [2,] 0.2327272 4.794399</span></span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a><span class="do">## [3,] 0.3496448 4.794399</span></span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a><span class="do">## [4,] 0.4672318 4.794399</span></span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a><span class="do">## [5,] 0.5857196 4.794399</span></span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a><span class="do">## [6,] 0.6924922 4.725637</span></span></code></pre></div>
<p>Events estimated to possess a <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;100" title="100" alt="100">-year joint return period.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#"Most-likely" design event</span></span>
<span><span class="va">curve</span><span class="op">$</span><span class="va">most_likely_wt13</span></span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="do">##   Rainfall     OsWL</span></span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a><span class="do">## 1 7.376893 3.880561</span></span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Ensemble of ten design events </span></span>
<span><span class="va">curve</span><span class="op">$</span><span class="va">ensemble_wt13</span></span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="do">##      Rainfall     OsWL</span></span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a><span class="do">## 249  2.009748 6.119263</span></span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a><span class="do">## 654  9.424851 3.476742</span></span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a><span class="do">## 680 10.012015 3.367404</span></span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a><span class="do">## 846 13.564076 2.557328</span></span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a><span class="do">## 864 13.855659 2.412782</span></span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a><span class="do">## 832 13.337290 2.669752</span></span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a><span class="do">## 616  8.548467 3.617731</span></span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a><span class="do">## 601  8.205264 3.676474</span></span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a><span class="do">## 710 10.681800 3.233014</span></span>
<span id="cb85-11"><a href="#cb85-11" tabindex="-1"></a><span class="do">## 509  6.391993 4.248779</span></span></code></pre></div>
<p>The <code><a href="reference/return_curve_diag.html">return_curve_diag()</a></code> function calculates the empirical probability of observing data within the survival regions defined by a subset of points on the return curve. If the curve is a good fit, the empirical probabilities should closely match the probabilities associated with the return level curve. The procedure which is introduced in <a href="https://doi.org/10.1002/env.2797" class="external-link">Murphy-Barltrop et al. (2023)</a> uses bootstrap resampling of the original data set to obtain confidence intervals for the empirical estimates. Since observations are required in the survival regions to estimate the empirical probabilities, it is recommended that this function be run for shorter return periods that may usually be considered for design e.g., for a 1-year return period rather than a 50-year return period. The inputs are almost identical to those of the <code>return_curve_est</code> function. The only additional arguments are <code>boot_method_all</code> which details the bootstrapping procedure - basic or block - to use when estimating the distribution of empirical (survival) probabilities from the original data set (without any declustering), <code>boot_replace_all</code> which specifies whether to sample with replacement in the case of a basic bootstrap and <code>block_length_all</code> which specifies the block length for the block bootstrap.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Diagnostic plots for the return curves</span></span>
<span><span class="va">curve</span> <span class="op">=</span> <span class="fu"><a href="reference/return_curve_diag.html">return_curve_diag</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">S22.Detrend.df.extended</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>                          q<span class="op">=</span><span class="fl">0.985</span>,rp<span class="op">=</span><span class="fl">1</span>,mu<span class="op">=</span><span class="fl">365.25</span>,n_sim<span class="op">=</span><span class="fl">100</span>,</span>
<span>                          n_grad<span class="op">=</span><span class="fl">50</span>,n_boot<span class="op">=</span><span class="fl">100</span>,boot_method<span class="op">=</span><span class="st">"monthly"</span>,</span>
<span>                          boot_replace<span class="op">=</span><span class="cn">NA</span>, block_length<span class="op">=</span><span class="cn">NA</span>, boot_prop<span class="op">=</span><span class="fl">0.8</span>,</span>
<span>                          decl_method_x<span class="op">=</span><span class="st">"runs"</span>, decl_method_y<span class="op">=</span><span class="st">"runs"</span>,</span>
<span>                          window_length_x<span class="op">=</span><span class="cn">NA</span>,window_length_y<span class="op">=</span><span class="cn">NA</span>,</span>
<span>                          u_x<span class="op">=</span><span class="fl">0.95</span>, u_y<span class="op">=</span><span class="fl">0.95</span>,</span>
<span>                          sep_crit_x<span class="op">=</span><span class="fl">36</span>, sep_crit_y<span class="op">=</span><span class="fl">36</span>,</span>
<span>                          alpha<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>                          boot_method_all<span class="op">=</span><span class="st">"block"</span>, boot_replace_all<span class="op">=</span><span class="cn">NA</span>,</span>
<span>                          block_length_all<span class="op">=</span><span class="fl">14</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-57-1.png"><!-- --><img src="README_files/figure-gfm/unnamed-chunk-57-2.png"><!-- --><img src="README_files/figure-gfm/unnamed-chunk-57-3.png"><!-- --></p>
</div>
</div>
<div class="section level2">
<h2 id="id_5-trivariate-analysis">5. Trivariate analysis<a class="anchor" aria-label="anchor" href="#id_5-trivariate-analysis"></a>
</h2>
<p>The package contains three higher dimensional <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%28%3E3%29" title="(&gt;3)" alt="(&gt;3)"> approaches are implemented to model the joint distribution of rainfall, O-sWL and groundwater level. They are:</p>
<ul>
<li>Standard (trivariate) copula</li>
<li>Pair Copula Construction</li>
<li>Heffernan and Tawn (2004)</li>
</ul>
<div class="section level4">
<h4 id="standard-trivariate-copula">Standard (trivariate) copula<a class="anchor" aria-label="anchor" href="#standard-trivariate-copula"></a>
</h4>
<p>In the package, each approach has a <code>_Fit</code> and <code>_Sim</code> function. The latter requires a <code>MIGPD</code> object as its <code>Marginals</code> input argument, in order for the simulations on <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5C%5B0%2C1%5C%5D%5E3" title="[0,1]^3" alt="\0,1\^3"> to be transformed back to the original scale. The <code>Migpd_Fit</code> command fits independent GPDs to the data in each row of a dataframe (excluding the first column if it is a “Date” object) creating a <code>MIGPD</code> object.</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Migpd</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Migpd_Fit.html">Migpd_Fit</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,Data_Full <span class="op">=</span> <span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                     mqu<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.975</span>,<span class="fl">0.975</span>,<span class="fl">0.9676</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">S20.Migpd</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a><span class="do">## A collection of 3 generalized Pareto models.</span></span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a><span class="do">## All models converged.</span></span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a><span class="do">## Penalty to the likelihood: gaussian</span></span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a><span class="do">## Summary of models:</span></span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a><span class="do">##                   Rainfall      OsWL Groundwater</span></span>
<span id="cb88-8"><a href="#cb88-8" tabindex="-1"></a><span class="do">## Threshold        1.6000000 1.9385406   2.8599327</span></span>
<span id="cb88-9"><a href="#cb88-9" tabindex="-1"></a><span class="do">## P(X &lt; threshold) 0.9750000 0.9750000   0.9676000</span></span>
<span id="cb88-10"><a href="#cb88-10" tabindex="-1"></a><span class="do">## sigma            0.9040271 0.1574806   0.3083846</span></span>
<span id="cb88-11"><a href="#cb88-11" tabindex="-1"></a><span class="do">## xi               0.1742220 0.2309118  -0.3441421</span></span>
<span id="cb88-12"><a href="#cb88-12" tabindex="-1"></a><span class="do">## Upper end point        Inf       Inf   3.7560295</span></span></code></pre></div>
<p>Standard (trivariate) copula are the most conceptually simple of the copula based models, using a single parametric multivariate probability distribution as the copula. The <code><a href="reference/Standard_Copula_Fit.html">Standard_Copula_Fit()</a></code> function fits elliptic (specified by <code>Gaussian</code> or <code>tcop</code>) or Archimedean (specified by <code>Gumbel</code>,<code>Clayton</code> or <code>Frank</code>) copula to a trivariate dataset. Let first fit a Gaussian copula</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Gaussian</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Standard_Copula_Fit.html">Standard_Copula_Fit</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.df</span>,Copula_Type<span class="op">=</span><span class="st">"Gaussian"</span><span class="op">)</span></span></code></pre></div>
<p>From which the <code><a href="reference/Standard_Copula_Sim.html">Standard_Copula_Sim()</a></code> function can be used to simulate a synthetic record of N years</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Gaussian.Sim</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Standard_Copula_Sim.html">Standard_Copula_Sim</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.df</span>,Marginals<span class="op">=</span><span class="va">S20.Migpd</span>,</span>
<span>                                      Copula<span class="op">=</span><span class="va">S20.Gaussian</span>,N<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the observed and simulated values</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Pairs.Plot.Data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="va">S20.Gaussian.Sim</span><span class="op">$</span><span class="va">x.Sim</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Observation"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Simulation"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">S20.Gaussian.Sim</span><span class="op">$</span><span class="va">x.Sim</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="st">"Type"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>      col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">$</span><span class="va">Type</span><span class="op">==</span><span class="st">"Observation"</span>,<span class="st">"Black"</span>,<span class="fu">alpha</span><span class="op">(</span><span class="st">"Red"</span>,<span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      upper.panel<span class="op">=</span><span class="cn">NULL</span>,pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-61-1.png"><!-- --></p>
<p>The <code><a href="reference/Standard_Copula_Sel.html">Standard_Copula_Sel()</a></code> function can be used to deduce the best fitting in terms of AIC</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/Standard_Copula_Sel.html">Standard_Copula_Sel</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="do">##     Copula        AIC</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a><span class="do">## 1 Gaussian -1389.1438</span></span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a><span class="do">## 2    t-cop -1434.7850</span></span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a><span class="do">## 3   Gumbel  -876.7537</span></span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a><span class="do">## 4  Clayton  -565.7595</span></span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a><span class="do">## 5    Frank  -854.4284</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="pair-copula-construction">Pair Copula Construction<a class="anchor" aria-label="anchor" href="#pair-copula-construction"></a>
</h4>
<p>Standard trivariate copulas lack flexibility to model joint distributions where heterogeneous dependencies exist between the variable pairs. Pair copula constructions construct multivariate distribution using a cascade of bivariate copulas (some of which are conditional). As the dimensionality of the problem increases the number of mathematically equally valid decompositions quickly becomes large. Bedford and Cooke (2001,2002) introduced the regular vine, a graphical model which helps to organize the possible decompositions. The Canonical (C-) and D- vine are two commonly utilized sub-categories of regular vines, in the trivariate case a vine copula is simultaneously a C- and D-vine. Let’s fit a regular vine copula model</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Vine</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Vine_Copula_Fit.html">Vine_Copula_Fit</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">)</span></span></code></pre></div>
<p>From which the <code><a href="reference/Vine_Copula_Sim.html">Vine_Copula_Sim()</a></code> function can be used to simulate a synthetic record of N years</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Vine.Sim</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Vine_Copula_Sim.html">Vine_Copula_Sim</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.df</span>,Vine_Model<span class="op">=</span><span class="va">S20.Vine</span>,Marginals<span class="op">=</span><span class="va">S20.Migpd</span>,N<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the observed and simulated values</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Pairs.Plot.Data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="va">S20.Vine.Sim</span><span class="op">$</span><span class="va">x.Sim</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Observation"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Simulation"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">S20.Vine.Sim</span><span class="op">$</span><span class="va">x.Sim</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="st">"Type"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>      col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">$</span><span class="va">Type</span><span class="op">==</span><span class="st">"Observation"</span>,<span class="st">"Black"</span>,<span class="fu">alpha</span><span class="op">(</span><span class="st">"Red"</span>,<span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      upper.panel<span class="op">=</span><span class="cn">NULL</span>,pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-65-1.png"><!-- --></p>
</div>
<div class="section level4">
<h4 id="ht04">HT04<a class="anchor" aria-label="anchor" href="#ht04"></a>
</h4>
<p>Finally, let us implement the Heffernan and Tawn (2004) approach, in which a non-linear regression model is fitted to joint observations where a conditioning variable exceeds a specified threshold. The regression model typically adopted is: <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Ctextbf%7BY%7D_%7B-i%7D%20%3D%20%5Ctextbf%7Ba%7DY_i%20%2B%20Y_i%5E%7B%5Ctextbf%7Bb%7D%7D%5Ctextbf%7BZ%7D%20%5Chspace%7B1cm%7D%20%5Ctext%7Bfor%7D%20%5Chspace%7B1cm%7D%20Y_i%20%3E%20v" title="\textbf{Y}_{-i} = \textbf{a}Y_i + Y_i^{\textbf{b}}\textbf{Z} \hspace{1cm} \text{for} \hspace{1cm} Y_i &gt; v" alt="_{-i} = Y_i + Y_i^{}    Y_i &gt; v"> where:</p>
<p><img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Ctextbf%7BY%7D" title="\textbf{Y}" alt=""> is a set of variables transformed to a common scale <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Ctextbf%7BY%7D_%7B-i%7D" title="\textbf{Y}_{-i}" alt="_{-i}"> is the set of variables excluding <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;Y_i" title="Y_i" alt="Y_i"><img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Ctextbf%7Ba%7D" title="\textbf{a}" alt=""> and <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Ctextbf%7Bb%7D" title="\textbf{b}" alt=""> are vectors of regression parameters <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Ctextbf%7BZ%7D" title="\textbf{Z}" alt=""> is a vector of residuals</p>
<p>The dependence structure when a specified variable is extreme is thus captured by the regression parameters and the joint residuals. The procedure is repeated, conditioning on each variable in turn, to build up the joint distribution when at least one variable is in an extreme state. The HT04 command fits the model and simulates N years’ worth of data from the fitted model.</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.HT04</span><span class="op">&lt;-</span><span class="fu"><a href="reference/HT04.html">HT04</a></span><span class="op">(</span>data_Detrend_Dependence_df<span class="op">=</span><span class="va">S20.Detrend.df</span>,</span>
<span>               data_Detrend_Declustered_df<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span>,</span>
<span>               u_Dependence<span class="op">=</span><span class="fl">0.995</span>,Migpd<span class="op">=</span><span class="va">S20.Migpd</span>,mu<span class="op">=</span><span class="fl">365.25</span>,N<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>Output of the function includes the three conditional <code>Models</code>, proportion of occasions where each variable is most extreme given at least one variable is extreme <code>prop</code>as well as, the simulations on the transformed scale <code>u.Sim</code> (Gumbel by default) and original scale <code>x.Sim</code>. Let’s view the fitted model when conditioning on rainfall</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.HT04</span><span class="op">$</span><span class="va">Model</span><span class="op">$</span><span class="va">Rainfall</span></span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="do">## mexDependence(x = Migpd, which = colnames(data_Detrend_Dependence_df)[i], </span></span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a><span class="do">##     dqu = u_Dependence, margins = "laplace", constrain = FALSE, </span></span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a><span class="do">##     v = V, maxit = Maxit)</span></span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a><span class="do">## Marginal models:</span></span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a><span class="do">## Dependence model:</span></span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a><span class="do">## Conditioning on Rainfall variable.</span></span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a><span class="do">## Thresholding quantiles for transformed data: dqu = 0.995</span></span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a><span class="do">## Using laplace margins for dependence estimation.</span></span>
<span id="cb99-13"><a href="#cb99-13" tabindex="-1"></a><span class="do">## Log-likelihood = -108.5807 -84.53349 </span></span>
<span id="cb99-14"><a href="#cb99-14" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb99-15"><a href="#cb99-15" tabindex="-1"></a><span class="do">## Dependence structure parameter estimates:</span></span>
<span id="cb99-16"><a href="#cb99-16" tabindex="-1"></a><span class="do">##     OsWL Groundwater</span></span>
<span id="cb99-17"><a href="#cb99-17" tabindex="-1"></a><span class="do">## a 1.0000      0.3295</span></span>
<span id="cb99-18"><a href="#cb99-18" tabindex="-1"></a><span class="do">## b 0.6948     -1.5240</span></span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.HT04</span><span class="op">$</span><span class="va">Prop</span></span></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="do">## [1] 0.3552632 0.3157895 0.3289474</span></span></code></pre></div>
<p>and the which the proporiton of the occasions in the original sample that rainfall is the most extreme of the drivers given that at least one driver is extreme.</p>
<p>The HT04 approach uses rejection sampling to generate synthetic records. The first step involves sampling a variable, conditioned to exceed the <code>u_Dependence</code> threshold. A joint residual associated with the corresponding regression is independently sampled and other variables estimated using the fitted regression parameters. If the variable conditioned to be extreme in step one is not the most extreme the sample is rejected. The process is repeated until the relative proportion of simulated events where each variable is a maximum, conditional on being above the threshold, is consistent with the empirical distribution. Labeling the simulations <code>S20.HT04.Sim</code></p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.HT04.Sim</span><span class="op">&lt;-</span><span class="va">S20.HT04</span><span class="op">$</span><span class="va">x.sim</span></span></code></pre></div>
<p>and now plotting the simulations from the HT04 model</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Pairs.Plot.Data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="va">S20.HT04.Sim</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Observation"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Simulation"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">S20.HT04.Sim</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="st">"Type"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>      col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">$</span><span class="va">Type</span><span class="op">==</span><span class="st">"Observation"</span>,<span class="st">"Black"</span>,<span class="fu">alpha</span><span class="op">(</span><span class="st">"Red"</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      upper.panel<span class="op">=</span><span class="cn">NULL</span>,pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-70-1.png"><!-- --></p>
</div>
</div>
<div class="section level2">
<h2 id="id_6-sea-level-rise">6. Sea Level Rise<a class="anchor" aria-label="anchor" href="#id_6-sea-level-rise"></a>
</h2>
<p>The <code>SLR_Scenarios</code> function estimates the time required for a user-specified amount of sea level rise ( <code>SeaLevelRise</code>) to occur under various sea level rise scenarios. The default scenarios are for Key West from the Southeast Florida Regional Climate Change Compact (2019). Let’s calculate how long before the O-sWL in the 100-year “most-likely” design event (see section 4) equals that of the corresponding design event derived under full dependence.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Difference in O-sWL between the most-likely and full dependence events</span></span>
<span><span class="va">Diff</span><span class="op">&lt;-</span><span class="va">S20.Bivariate</span><span class="op">$</span><span class="va">FullDependence</span><span class="op">$</span><span class="va">`100`</span><span class="op">$</span><span class="va">OsWL</span><span class="op">-</span><span class="va">S20.Bivariate</span><span class="op">$</span><span class="va">MostLikelyEvent</span><span class="op">$</span><span class="va">`100`</span><span class="op">$</span><span class="va">OsWL</span></span>
<span><span class="va">Diff</span></span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="do">## [1] 0.1246732</span></span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Time in years for the sea level rise to occur</span></span>
<span><span class="fu"><a href="reference/SLR_Scenarios.html">SLR_Scenarios</a></span><span class="op">(</span>SeaLevelRise<span class="op">=</span><span class="va">Diff</span>,Unit<span class="op">=</span><span class="st">"m"</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-72-1.png"><!-- --></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="do">## $High</span></span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a><span class="do">## [1] 2031</span></span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a><span class="do">## $Intermediate</span></span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a><span class="do">## [1] 2034</span></span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb107-7"><a href="#cb107-7" tabindex="-1"></a><span class="do">## $Low</span></span>
<span id="cb107-8"><a href="#cb107-8" tabindex="-1"></a><span class="do">## [1] 2044</span></span></code></pre></div>
<p>Scenarios from the Interagency Sea Level Rise Scenario Tool (2022) for Miami Beach and Naples can be utilized by changing the <code>Scenario</code> and <code>Location</code> arguments. Alternatively, a user can input other sea level rise scenarios into the function. For example, below we use the scenarios from the same tool but for Fort Myers.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Sea level rise scenarios for Fort Myers</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sl_taskforce_scenarios_psmsl_id_1106_Fort_Myers</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="do">##   psmsl_id process Units scenario quantile     X2020   X2030   X2040   X2050</span></span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a><span class="do">## 1     1106   total    mm      Low       17  79.48296 118.483 168.483 210.483</span></span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a><span class="do">## 2     1106   total    mm      Low       50 101.48296 154.483 210.483 264.483</span></span>
<span id="cb109-4"><a href="#cb109-4" tabindex="-1"></a><span class="do">## 3     1106   total    mm      Low       83 123.48296 193.483 258.483 320.483</span></span>
<span id="cb109-5"><a href="#cb109-5" tabindex="-1"></a><span class="do">## 4     1106   total    mm   IntLow       17  87.48296 134.483 189.483 244.483</span></span>
<span id="cb109-6"><a href="#cb109-6" tabindex="-1"></a><span class="do">## 5     1106   total    mm   IntLow       50 109.48296 171.483 239.483 307.483</span></span>
<span id="cb109-7"><a href="#cb109-7" tabindex="-1"></a><span class="do">## 6     1106   total    mm   IntLow       83 132.48296 210.483 289.483 369.483</span></span>
<span id="cb109-8"><a href="#cb109-8" tabindex="-1"></a><span class="do">##     X2060   X2070   X2080   X2090   X2100   X2110   X2120    X2130    X2140</span></span>
<span id="cb109-9"><a href="#cb109-9" tabindex="-1"></a><span class="do">## 1 248.483 285.483 313.483 336.483 361.483 389.483 417.483  442.483  465.483</span></span>
<span id="cb109-10"><a href="#cb109-10" tabindex="-1"></a><span class="do">## 2 309.483 350.483 383.483 412.483 453.483 493.483 531.483  566.483  601.483</span></span>
<span id="cb109-11"><a href="#cb109-11" tabindex="-1"></a><span class="do">## 3 378.483 421.483 462.483 505.483 566.483 619.483 674.483  725.483  777.483</span></span>
<span id="cb109-12"><a href="#cb109-12" tabindex="-1"></a><span class="do">## 4 306.483 369.483 431.483 492.483 550.483 612.483 675.483  732.483  792.483</span></span>
<span id="cb109-13"><a href="#cb109-13" tabindex="-1"></a><span class="do">## 5 374.483 442.483 512.483 577.483 646.483 722.483 798.483  877.483  955.483</span></span>
<span id="cb109-14"><a href="#cb109-14" tabindex="-1"></a><span class="do">## 6 445.483 521.483 603.483 680.483 767.483 858.483 952.483 1052.483 1161.483</span></span>
<span id="cb109-15"><a href="#cb109-15" tabindex="-1"></a><span class="do">##      X2150</span></span>
<span id="cb109-16"><a href="#cb109-16" tabindex="-1"></a><span class="do">## 1  489.483</span></span>
<span id="cb109-17"><a href="#cb109-17" tabindex="-1"></a><span class="do">## 2  634.483</span></span>
<span id="cb109-18"><a href="#cb109-18" tabindex="-1"></a><span class="do">## 3  829.483</span></span>
<span id="cb109-19"><a href="#cb109-19" tabindex="-1"></a><span class="do">## 4  848.483</span></span>
<span id="cb109-20"><a href="#cb109-20" tabindex="-1"></a><span class="do">## 5 1033.483</span></span>
<span id="cb109-21"><a href="#cb109-21" tabindex="-1"></a><span class="do">## 6 1274.483</span></span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Formatting to a data frame that can be interpreted by the tool</span></span>
<span><span class="va">SeaLevelRise.2022_input</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Year<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2020</span>,<span class="fl">2150</span>,<span class="fl">10</span><span class="op">)</span>,</span>
<span><span class="st">"High"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sl_taskforce_scenarios_psmsl_id_1106_Fort_Myers</span><span class="op">[</span><span class="fl">14</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span><span class="st">"Int_Medium"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sl_taskforce_scenarios_psmsl_id_1106_Fort_Myers</span><span class="op">[</span><span class="fl">11</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span><span class="st">"Medium"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sl_taskforce_scenarios_psmsl_id_1106_Fort_Myers</span><span class="op">[</span><span class="fl">8</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span><span class="st">"Int_Low"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sl_taskforce_scenarios_psmsl_id_1106_Fort_Myers</span><span class="op">[</span><span class="fl">5</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span><span class="st">"Low"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sl_taskforce_scenarios_psmsl_id_1106_Fort_Myers</span><span class="op">[</span><span class="fl">2</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Finding time in years for 0.8m of sea level rise to occur</span></span>
<span><span class="fu"><a href="reference/SLR_Scenarios.html">SLR_Scenarios</a></span><span class="op">(</span>SeaLevelRise<span class="op">=</span><span class="fl">0.8</span>, Scenario<span class="op">=</span><span class="st">"Other"</span>, Unit <span class="op">=</span> <span class="st">"m"</span>, Year<span class="op">=</span><span class="fl">2022</span>, </span>
<span>              Location<span class="op">=</span><span class="st">"Fort Myers"</span>, New_Scenario<span class="op">=</span><span class="va">SeaLevelRise.2022_input</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-73-1.png"><!-- --></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="do">## $SLR_Year</span></span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a><span class="do">## [1] 2150 2120 2085 2070 2064</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="id_7-simulating-temporally-varying-events">7. Simulating temporally varying events<a class="anchor" aria-label="anchor" href="#id_7-simulating-temporally-varying-events"></a>
</h2>
<p>By sampling peaks from a multivariate statistical model e.g., a vine copula that includes the relative lag between the rainfall and water level peaks as well as their magnitudes temporally-varying synthetic events can be simulated.</p>
<div class="section level4">
<h4 id="water-level-curves">Water level curves<a class="anchor" aria-label="anchor" href="#water-level-curves"></a>
</h4>
<p>The intensity of a storm surge event is defined in <a href="https://doi.org/10.5194/nhess-11-2925-2011" class="external-link">Wahl et al. 2011</a> as the area of the water level curve above a specified base line level from the first low water level of the preceding tide and last low tide of the following tide. The <code>intensity()</code> function calculates this metric with the default baseline level set as the mean of the water level time series (<code>Base_Line</code>=<code>"Mean "</code>). Let’s calculate the “intensity” of cluster maxima in the hourly O-sWL time series at control structure S-13.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Decluster O-sWL series at S-13 using a runs method</span></span>
<span><span class="va">S13.OsWL.Declust</span> <span class="op">=</span> <span class="fu"><a href="reference/Decluster.html">Decluster</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span>,</span>
<span>                            SepCrit<span class="op">=</span><span class="fl">24</span><span class="op">*</span><span class="fl">7</span>, u<span class="op">=</span><span class="fl">0.99667</span><span class="op">)</span></span>
<span><span class="co">#Calculate O-sWL of the identified cluster maximum</span></span>
<span><span class="va">intensity</span> <span class="op">=</span> <span class="fu"><a href="reference/Intensity.html">Intensity</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S13.Detrend.df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                      Cluster_Max<span class="op">=</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span>,</span>
<span>                      Base_Line<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Plotting a subset of the events:</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Plotting water levels</span></span>
<span><span class="co">#Converting Date_Time column to POSIXct class</span></span>
<span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span>, </span>
<span>                                         format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M:%S"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span><span class="op">[</span><span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">48</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">48</span><span class="op">)</span><span class="op">]</span>, </span>
<span>     <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">48</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">48</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Time"</span>, ylab<span class="op">=</span><span class="st">"O-sWL (ft NGVD 29)"</span>,type<span class="op">=</span><span class="st">'l'</span>,lwd<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Adding purple points denoting preceding and following high tides</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Pre.High</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, </span>
<span>     <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Pre.High</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">1.5</span>,col<span class="op">=</span><span class="st">"Purple"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Fol.High</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, </span>
<span>       <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Fol.High</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">1.5</span>,col<span class="op">=</span><span class="st">"Purple"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Adding orange points denoting preceding and following low tides</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Pre.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, </span>
<span>       <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Pre.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">1.5</span>,col<span class="op">=</span><span class="st">"Orange"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Fol.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, </span>
<span>       <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Fol.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">1.5</span>,col<span class="op">=</span><span class="st">"Orange"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Recall BaseLine=2</span></span>
<span><span class="va">baseline</span><span class="op">=</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Only create polygon showing intensity</span></span>
<span><span class="va">above</span><span class="op">&lt;-</span> <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Pre.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">:</span><span class="va">intensity</span><span class="op">$</span><span class="va">Fol.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">baseline</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">above</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">runs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rle.html" class="external-link">rle</a></span><span class="op">(</span><span class="va">above</span><span class="op">)</span></span>
<span>  <span class="va">ends</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">runs</span><span class="op">$</span><span class="va">lengths</span><span class="op">)</span></span>
<span>  <span class="va">starts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">ends</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ends</span><span class="op">)</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">runs</span><span class="op">$</span><span class="va">values</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">start_idx</span> <span class="op">&lt;-</span> <span class="va">starts</span><span class="op">[</span><span class="va">j</span><span class="op">]</span></span>
<span>    <span class="va">end_idx</span> <span class="op">&lt;-</span> <span class="va">ends</span><span class="op">[</span><span class="va">j</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">x_seg</span> <span class="op">&lt;-</span> <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Pre.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">:</span><span class="va">intensity</span><span class="op">$</span><span class="va">Fol.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">start_idx</span><span class="op">:</span><span class="va">end_idx</span><span class="op">]</span></span>
<span>    <span class="va">y_seg</span> <span class="op">&lt;-</span> <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Pre.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">:</span><span class="va">intensity</span><span class="op">$</span><span class="va">Fol.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">start_idx</span><span class="op">:</span><span class="va">end_idx</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x_seg</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">x_seg</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_seg</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">baseline</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x_seg</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            col <span class="op">=</span> <span class="st">"dark grey"</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-75-1.png"><!-- --></p>
<p>The <code><a href="reference/WL_Curve.html">WL_Curve()</a></code> function generates a water level curve conditioned on a water level event peak (<code>Peak</code>) and “intensity” (<code>Intensity</code>). The function works by re-scaling observed events curves between four time units before and after the peak such that the re-scaled peak coincides with conditioned peak. It then computes the intensity of the re-scaled events and selects the event with the highest intensity that’s less than conditioned intensity. Intensity units are then added to ensure the intensity of the simulated curve matches the conditioned intensity. The Intensity units, which manifest as increases in water level, are distributed in proportion with the decreases of water levels from the peak OsWL i.e., more units are added at lower water levels. No units are added about the peak. For conditioned event peaks below a user-specified threshold (<code>Thres</code>) an observed curve with an intensity less than some user-specified limit (<code>Limit</code>) is randomly sampled.</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Four synthetic events all with intensity of 60 units</span></span>
<span><span class="va">sim.peaks</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.4</span>,<span class="fl">4</span>,<span class="fl">4.2</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">sim.intensity</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>,<span class="fl">60</span>,<span class="fl">60</span>,<span class="fl">60</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Generating the water level curves</span></span>
<span><span class="va">oswl_ts_oswl</span> <span class="op">=</span> <span class="fu"><a href="reference/WL_Curve.html">WL_Curve</a></span><span class="op">(</span>Data <span class="op">=</span> <span class="va">S13.Detrend.df</span>,</span>
<span>                        Cluster_Max <span class="op">=</span> <span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span>,</span>
<span>                        Pre_Low <span class="op">=</span> <span class="va">intensity</span><span class="op">$</span><span class="va">Pre.Low</span>,</span>
<span>                        Fol_Low <span class="op">=</span> <span class="va">intensity</span><span class="op">$</span><span class="va">Fol.Low</span>,</span>
<span>                        Thres <span class="op">=</span> <span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">Threshold</span>, Limit <span class="op">=</span> <span class="fl">45</span>,</span>
<span>                        Peak <span class="op">=</span> <span class="va">sim.peaks</span>,</span>
<span>                        Base_Line<span class="op">=</span><span class="fl">2</span>,</span>
<span>                        Intensity <span class="op">=</span> <span class="va">sim.intensity</span><span class="op">)</span></span></code></pre></div>
<p>Superimposing the four simulated water level curves on the observed curves:</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Plot the water level curves of the observed peaks</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">-</span><span class="fl">144</span><span class="op">:</span><span class="fl">144</span>,</span>
<span>     <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">144</span><span class="op">)</span><span class="op">:</span></span>
<span>                         <span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">144</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Time relative to peak(hour)"</span>, ylab<span class="op">=</span><span class="st">"O-sWL (ft NGVD 29)"</span>, type<span class="op">=</span><span class="st">'l'</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="op">-</span><span class="fl">144</span><span class="op">:</span><span class="fl">144</span>,</span>
<span>        <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">-</span><span class="fl">144</span><span class="op">)</span><span class="op">:</span></span>
<span>                            <span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="fl">144</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#Superimpose the curves generated for the four synthetic events</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="op">-</span><span class="fl">144</span><span class="op">:</span><span class="fl">144</span>,<span class="va">oswl_ts_oswl</span><span class="op">$</span><span class="va">Series</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-77-1.png"><!-- --></p>
</div>
<div class="section level4">
<h4 id="hyetographs">Hyetographs<a class="anchor" aria-label="anchor" href="#hyetographs"></a>
</h4>
<p><a href="https://doi.org/10.1002/wrcr.20221" class="external-link">Serinaldi and Kilsby</a> studied the pairwise relationships between key hyetograph characteristics: maximum value <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;Xp" title="Xp" alt="Xp">, volume <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;V" title="V" alt="V">, duration <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;D" title="D" alt="D">, and average intensity <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;I" title="I" alt="I"> at <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;282" title="282" alt="282"> rain gauge stations in central eastern Europe with daily rainfall records and three 5-minutes record gauges in Italy. The authors found that at both temporal scales the only stochastic relationship was between volume and duration, and that simple bootstrap procedures could be used to generate events that preserve the pairwise relationships among the characteristics. The <code>U_Sample</code> function implements a bootstrap procedure referred to as the U-boot algorithm in <a href="https://doi.org/10.1002/wrcr.20221" class="external-link">Serinaldi and Kilsby (2013)</a> to generate hyetograhs. For a simulated peak <code>Xp</code>, a duration is independently sampled and a set of non-peaks are sampled at random from one of the events with the same duration. To implement the method exactly as in <a href="https://doi.org/10.1002/wrcr.20221" class="external-link">Serinaldi and Kilsby (2013)</a>, set <code>Xp</code> equal to a sample (taken with replacement) of the observed cluster maximum (peaks). An example application of the function is given below for rainfall recorded at control structure S-13. First the hourly time series is declustered to find the characteristics of the rainfall events containing the <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;500" title="500" alt="500"> highest peaks:</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#First decluster the rainfall series to find the 500 events</span></span>
<span><span class="co">#with the highest peaks</span></span>
<span><span class="va">S13.Rainfall.Declust</span> <span class="op">=</span> <span class="fu"><a href="reference/Decluster.html">Decluster</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span>,</span>
<span>                                 SepCrit<span class="op">=</span><span class="fl">24</span><span class="op">*</span><span class="fl">3</span>, u<span class="op">=</span><span class="fl">0.99667</span><span class="op">)</span></span>
<span><span class="co">#Hourly peaks</span></span>
<span><span class="va">peaks</span> <span class="op">=</span> <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">[</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">]</span></span>
<span><span class="co">#Set very small rainfall measurements to zero.</span></span>
<span><span class="co">#Assumed to be the result of uncertainty in measuring equipment.</span></span>
<span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">&lt;</span><span class="fl">0.01</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="co">#Find NAs in rainfall series</span></span>
<span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span><span class="op">==</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#Temporarily set NAs to zero</span></span>
<span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">[</span><span class="va">z</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="co">#Find times where there is 6-hours of no rainfall</span></span>
<span><span class="va">no.rain</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">6</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">no.rain</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">[</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">:</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">==</span><span class="fl">0</span>,<span class="va">i</span>,<span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#Remove NAs from results vector as these correspond to times where there is</span></span>
<span><span class="co">#rainfall at certain points in the 6 hour period.</span></span>
<span><span class="va">no.rain</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">no.rain</span><span class="op">)</span></span>
<span><span class="co">#Reset missing values in the rainfall record back to NA</span></span>
<span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">[</span><span class="va">z</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="co">#Find the start and end times of the 500 events.</span></span>
<span><span class="va">start</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">end</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="va">start</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">no.rain</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">no.rain</span><span class="op">&lt;</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span> <span class="va">end</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">no.rain</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">no.rain</span><span class="op">&gt;</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">start</span> <span class="op">=</span> <span class="va">start</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="va">end</span> <span class="op">=</span> <span class="va">end</span> <span class="op">-</span> <span class="fl">6</span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="va">end</span> <span class="op">-</span> <span class="va">start</span> <span class="op">+</span> <span class="fl">1</span> <span class="co">#Duration</span></span>
<span><span class="co">#Simulate some peaks by sampling observed peaks with replacement</span></span>
<span><span class="co">#I.e., applying the method exactly as in Serinaldi and Kilsby (2013)</span></span>
<span><span class="va">sim.peak</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">peaks</span>,size<span class="op">=</span><span class="fl">500</span>,replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Now the bootstrapping procedure can be carried out:</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample</span> <span class="op">=</span> <span class="fu"><a href="reference/U_Sample.html">U_Sample</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span>,</span>
<span>                  Cluster_Max<span class="op">=</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span>,</span>
<span>                  D<span class="op">=</span><span class="va">d</span>,Start<span class="op">=</span><span class="va">start</span>,End<span class="op">=</span><span class="va">end</span>,</span>
<span>                  Xp<span class="op">=</span><span class="va">sim.peak</span><span class="op">)</span></span></code></pre></div>
<p>Let’s check whether the characteristic of the bootstrapped events match those of the observed events. First, calculating the volume and intensity of the <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;500" title="500" alt="500"> observed events with the highest hourly peaks.</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Calculating volume and intensity</span></span>
<span><span class="va">v</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">500</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">v</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">[</span><span class="op">(</span><span class="va">start</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">end</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">I</span> <span class="op">=</span> <span class="va">v</span><span class="op">/</span><span class="va">d</span></span>
<span></span>
<span><span class="co">#Putting in a data.frame</span></span>
<span><span class="va">observations</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">peaks</span>,<span class="va">d</span>,<span class="va">v</span>,<span class="va">I</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">observations</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"peak"</span>,<span class="st">"d"</span>,<span class="st">"v"</span>,<span class="st">"I"</span><span class="op">)</span></span></code></pre></div>
<p>To aid the comparison information relating to the marginal distributions of the characteristics is removed by transforming the data to the <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5B0%2C1%5D%5E2" title="[0,1]^2" alt="[0,1]^2"> scale.</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Observations</span></span>
<span><span class="va">observations.u</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">pobs</span><span class="op">(</span><span class="va">observations</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">observations.u</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"peak"</span>,<span class="st">"d"</span>,<span class="st">"v"</span>,<span class="st">"I"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Sample</span></span>
<span><span class="va">sample.u</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">pobs</span><span class="op">(</span><span class="va">sample</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Scatter plots showing the pairwise relationships of the characteristics:</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Layout of the plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.2</span>,<span class="fl">4.2</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Characteristics of observations on original scale</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations</span><span class="op">$</span><span class="va">peak</span>,<span class="va">observations</span><span class="op">$</span><span class="va">I</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"I"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations</span><span class="op">$</span><span class="va">peak</span>,<span class="va">observations</span><span class="op">$</span><span class="va">v</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"V"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations</span><span class="op">$</span><span class="va">peak</span>,<span class="va">observations</span><span class="op">$</span><span class="va">d</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations</span><span class="op">$</span><span class="va">I</span>,<span class="va">observations</span><span class="op">$</span><span class="va">v</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"I"</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"V"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations</span><span class="op">$</span><span class="va">I</span>,<span class="va">observations</span><span class="op">$</span><span class="va">d</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"I"</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations</span><span class="op">$</span><span class="va">v</span>,<span class="va">observations</span><span class="op">$</span><span class="va">d</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"V"</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Characteristics of sample on original scale</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">Xp</span>,<span class="va">sample</span><span class="op">$</span><span class="va">I</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">Xp</span>,<span class="va">sample</span><span class="op">$</span><span class="va">V</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">Xp</span>,<span class="va">sample</span><span class="op">$</span><span class="va">D</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">I</span>,<span class="va">sample</span><span class="op">$</span><span class="va">V</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">I</span>,<span class="va">sample</span><span class="op">$</span><span class="va">D</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">V</span>,<span class="va">sample</span><span class="op">$</span><span class="va">D</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Characteristics of observations on the [0,1] scale</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations.u</span><span class="op">$</span><span class="va">peak</span>,<span class="va">observations.u</span><span class="op">$</span><span class="va">I</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations.u</span><span class="op">$</span><span class="va">peak</span>,<span class="va">observations.u</span><span class="op">$</span><span class="va">v</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations.u</span><span class="op">$</span><span class="va">peak</span>,<span class="va">observations.u</span><span class="op">$</span><span class="va">d</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'D'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations.u</span><span class="op">$</span><span class="va">I</span>,<span class="va">observations.u</span><span class="op">$</span><span class="va">v</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations.u</span><span class="op">$</span><span class="va">I</span>,<span class="va">observations.u</span><span class="op">$</span><span class="va">d</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'D'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations.u</span><span class="op">$</span><span class="va">v</span>,<span class="va">observations.u</span><span class="op">$</span><span class="va">d</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'D'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Characteristics of sample on the [0,1] scale</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample.u</span><span class="op">$</span><span class="va">Xp</span>,<span class="va">sample.u</span><span class="op">$</span><span class="va">I</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample.u</span><span class="op">$</span><span class="va">Xp</span>,<span class="va">sample.u</span><span class="op">$</span><span class="va">V</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample.u</span><span class="op">$</span><span class="va">Xp</span>,<span class="va">sample.u</span><span class="op">$</span><span class="va">D</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample.u</span><span class="op">$</span><span class="va">I</span>,<span class="va">sample.u</span><span class="op">$</span><span class="va">V</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample.u</span><span class="op">$</span><span class="va">I</span>,<span class="va">sample.u</span><span class="op">$</span><span class="va">D</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample.u</span><span class="op">$</span><span class="va">V</span>,<span class="va">sample.u</span><span class="op">$</span><span class="va">D</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-82-1.png"><!-- --></p>
<p>The figure demonstrates that the simulated events preserves the key characteristics of the observed events.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;=3) + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing MultiHazard</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Robert Jane <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0003-4194-852X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Robert Jane.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
