<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculates joint return periods — Joint_RP_2D • MultiHazard</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculates joint return periods — Joint_RP_2D"><meta name="description" content="Calculates joint return periods via simulation. A large number of realizations are simulated from the copulas fit to the conditioned samples, in proportion with the sizes of the conditional samples.
The realizations are transformed to the original scale and the relevant probabilities estimated empirically."><meta property="og:description" content="Calculates joint return periods via simulation. A large number of realizations are simulated from the copulas fit to the conditioned samples, in proportion with the sizes of the conditional samples.
The realizations are transformed to the original scale and the relevant probabilities estimated empirically."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MultiHazard</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.13</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MultiHazard.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculates joint return periods</h1>

      <div class="d-none name"><code>Joint_RP_2D.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates joint return periods via simulation. A large number of realizations are simulated from the copulas fit to the conditioned samples, in proportion with the sizes of the conditional samples.
The realizations are transformed to the original scale and the relevant probabilities estimated empirically.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Joint_RP_2D</span><span class="op">(</span></span>
<span>  <span class="va">Data</span>,</span>
<span>  <span class="va">Data_Con1</span>,</span>
<span>  <span class="va">Data_Con2</span>,</span>
<span>  <span class="va">u1</span>,</span>
<span>  <span class="va">u2</span>,</span>
<span>  Thres1 <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  Thres2 <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">Copula_Family1</span>,</span>
<span>  <span class="va">Copula_Family2</span>,</span>
<span>  <span class="va">Marginal_Dist1</span>,</span>
<span>  <span class="va">Marginal_Dist2</span>,</span>
<span>  Con1 <span class="op">=</span> <span class="st">"Rainfall"</span>,</span>
<span>  Con2 <span class="op">=</span> <span class="st">"OsWL"</span>,</span>
<span>  mu <span class="op">=</span> <span class="fl">365.25</span>,</span>
<span>  <span class="va">RP_Var1</span>,</span>
<span>  <span class="va">RP_Var2</span>,</span>
<span>  Var1 <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  Var2 <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  x_lab <span class="op">=</span> <span class="st">"Rainfall (mm)"</span>,</span>
<span>  y_lab <span class="op">=</span> <span class="st">"O-sWL (mNGVD 29)"</span>,</span>
<span>  x_lim_min <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  x_lim_max <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  y_lim_min <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  y_lim_max <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  DecP <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  N <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fl">6</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">Data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data frame containing two co-occurring time series.</p></dd>


<dt id="arg-data-con-">Data_Con1<a class="anchor" aria-label="anchor" href="#arg-data-con-"></a></dt>
<dd><p>Data frame containing the conditional sample (declustered excesses paired with concurrent values of other variable), conditioned on the variable in the first column.</p></dd>


<dt id="arg-data-con-">Data_Con2<a class="anchor" aria-label="anchor" href="#arg-data-con-"></a></dt>
<dd><p>Data frame containing the conditional sample (declustered excesses paired with concurrent values of other variable), conditioned on the variable in the second column. Can be obtained using the <code>Con_Sampling_2D</code> function.</p></dd>


<dt id="arg-u-">u1<a class="anchor" aria-label="anchor" href="#arg-u-"></a></dt>
<dd><p>Numeric vector of length one specifying the (quantile) threshold above which the variable in the first column was sampled in Data_Con1.</p></dd>


<dt id="arg-u-">u2<a class="anchor" aria-label="anchor" href="#arg-u-"></a></dt>
<dd><p>Numeric vector of length one specifying the (quantile) threshold above which the variable in the second column was sampled in Data_Con2.</p></dd>


<dt id="arg-thres-">Thres1<a class="anchor" aria-label="anchor" href="#arg-thres-"></a></dt>
<dd><p>Numeric vector of length one specifying the threshold above which the variable in the first column was sampled in Data_Con1. Only one of <code>u1</code> and <code>Thres1</code> should be supplied. Default is <code>NA</code>.</p></dd>


<dt id="arg-thres-">Thres2<a class="anchor" aria-label="anchor" href="#arg-thres-"></a></dt>
<dd><p>Numeric vector of length one specifying the threshold above which the variable in the second column was sampled in Data_Con2. Only one of <code>u2</code> and <code>Thres2</code> should be supplied. Default is <code>NA</code>.</p></dd>


<dt id="arg-copula-family-">Copula_Family1<a class="anchor" aria-label="anchor" href="#arg-copula-family-"></a></dt>
<dd><p>Numeric vector of length one specifying the copula family used to model the <code>Data_Con1</code> dataset.</p></dd>


<dt id="arg-copula-family-">Copula_Family2<a class="anchor" aria-label="anchor" href="#arg-copula-family-"></a></dt>
<dd><p>Numeric vector of length one specifying the copula family used to model the <code>Data_Con2</code> dataset. Best fitting of 40 copulas can be found using the <code>Copula_Threshold_2D</code> function.</p></dd>


<dt id="arg-marginal-dist-">Marginal_Dist1<a class="anchor" aria-label="anchor" href="#arg-marginal-dist-"></a></dt>
<dd><p>Character vector of length one specifying (non-extreme) distribution used to model the marginal distribution of the non-conditioned variable in <code>Data_Con1</code>.</p></dd>


<dt id="arg-marginal-dist-">Marginal_Dist2<a class="anchor" aria-label="anchor" href="#arg-marginal-dist-"></a></dt>
<dd><p>Character vector of length one specifying (non-extreme) distribution used to model the marginal distribution of the non-conditioned variable in <code>Data_Con2</code>.</p></dd>


<dt id="arg-con-">Con1<a class="anchor" aria-label="anchor" href="#arg-con-"></a></dt>
<dd><p>Character vector of length one specifying the name of variable in the first column of <code>Data</code>.</p></dd>


<dt id="arg-con-">Con2<a class="anchor" aria-label="anchor" href="#arg-con-"></a></dt>
<dd><p>Character vector of length one specifying the name of variable in the second column of <code>Data</code>.</p></dd>


<dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p>Numeric vector of length one specifying the (average) occurrence frequency of events in <code>Data</code>. Default is <code>365.25</code>, daily data.</p></dd>


<dt id="arg-rp-var-">RP_Var1<a class="anchor" aria-label="anchor" href="#arg-rp-var-"></a></dt>
<dd><p>Numeric vector of length one specifying the univariate return period of variable <code>Con1</code>.</p></dd>


<dt id="arg-rp-var-">RP_Var2<a class="anchor" aria-label="anchor" href="#arg-rp-var-"></a></dt>
<dd><p>Numeric vector of length one specifying the univariate return period of variable <code>Con2</code>.</p></dd>


<dt id="arg-var-">Var1<a class="anchor" aria-label="anchor" href="#arg-var-"></a></dt>
<dd><p>Numeric vector specifying the values of the variable in the first column of <code>Data</code>. Default is <code>NA</code>.</p></dd>


<dt id="arg-var-">Var2<a class="anchor" aria-label="anchor" href="#arg-var-"></a></dt>
<dd><p>Numeric vector specifying the values of the variable in the second column of <code>Data</code>. Default is <code>NA</code>.</p></dd>


<dt id="arg-x-lab">x_lab<a class="anchor" aria-label="anchor" href="#arg-x-lab"></a></dt>
<dd><p>Character vector specifying the x-axis label.</p></dd>


<dt id="arg-y-lab">y_lab<a class="anchor" aria-label="anchor" href="#arg-y-lab"></a></dt>
<dd><p>Character vector specifying the y-axis label.</p></dd>


<dt id="arg-x-lim-min">x_lim_min<a class="anchor" aria-label="anchor" href="#arg-x-lim-min"></a></dt>
<dd><p>Numeric vector of length one specifying x-axis minimum. Default is <code>NA</code>.</p></dd>


<dt id="arg-x-lim-max">x_lim_max<a class="anchor" aria-label="anchor" href="#arg-x-lim-max"></a></dt>
<dd><p>Numeric vector of length one specifying x-axis maximum. Default is <code>NA</code>.</p></dd>


<dt id="arg-y-lim-min">y_lim_min<a class="anchor" aria-label="anchor" href="#arg-y-lim-min"></a></dt>
<dd><p>Numeric vector of length one specifying y-axis minimum. Default is <code>NA</code>.</p></dd>


<dt id="arg-y-lim-max">y_lim_max<a class="anchor" aria-label="anchor" href="#arg-y-lim-max"></a></dt>
<dd><p>Numeric vector of length one specifying y-axis maximum. Default is <code>NA</code>.</p></dd>


<dt id="arg-decp">DecP<a class="anchor" aria-label="anchor" href="#arg-decp"></a></dt>
<dd><p>Numeric vector of length one specifying the number of decimal places to round the data in the conditional samples to in order to identify observations in both conditional samples. Default is <code>2</code>.</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Numeric vector of length one specifying the size of the sample from the fitted joint distributions used to estimate the density along an isoline. Samples are collected from the two joint distribution with proportions consistent with the total number of extreme events conditioned on each variable. Default is <code>10^6</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Console output is a vector <code>RP_Copula</code> of the joint return period of the specified (Var1,Var2) events according to the conditional sampling - copula theory approach.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="Design_Event_2D.html">Design_Event_2D</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">con.sample.Rainfall</span><span class="op">&lt;-</span><span class="fu"><a href="Con_Sampling_2D.html">Con_Sampling_2D</a></span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S22.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                     Data_Declust<span class="op">=</span><span class="va">S22.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                     Con_Variable<span class="op">=</span><span class="st">"Rainfall"</span>,u<span class="op">=</span><span class="fl">0.97</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">con.sample.OsWL</span><span class="op">&lt;-</span><span class="fu"><a href="Con_Sampling_2D.html">Con_Sampling_2D</a></span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S22.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                 Data_Declust<span class="op">=</span><span class="va">S22.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                 Con_Variable<span class="op">=</span><span class="st">"OsWL"</span>,u<span class="op">=</span><span class="fl">0.97</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">con.sample.OsWL</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Rainfall</span> <span class="op">&lt;-</span> <span class="va">con.sample.OsWL</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Rainfall</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                     <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">con.sample.OsWL</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span>,<span class="fl">0.001</span>,<span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cop.Rainfall</span><span class="op">&lt;-</span><span class="fu"><a href="Copula_Threshold_2D.html">Copula_Threshold_2D</a></span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S22.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                  Data_Declust<span class="op">=</span><span class="va">S22.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,u1 <span class="op">=</span><span class="fl">0.97</span>,</span></span>
<span class="r-in"><span>                                  y_lim_min<span class="op">=</span><span class="op">-</span><span class="fl">0.075</span>,y_lim_max<span class="op">=</span><span class="fl">0.25</span>,</span></span>
<span class="r-in"><span>                                  Upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">9</span><span class="op">)</span>,Lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">10</span><span class="op">)</span>,GAP<span class="op">=</span><span class="fl">0.15</span><span class="op">)</span><span class="op">$</span><span class="va">Copula_Family_Var1</span></span></span>
<span class="r-plt img"><img src="Joint_RP_2D-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">cop.OsWL</span><span class="op">&lt;-</span><span class="fu"><a href="Copula_Threshold_2D.html">Copula_Threshold_2D</a></span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S22.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                              Data_Declust<span class="op">=</span><span class="va">S22.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,u2 <span class="op">=</span><span class="fl">0.97</span>,</span></span>
<span class="r-in"><span>                              y_lim_min<span class="op">=</span><span class="op">-</span><span class="fl">0.075</span>, y_lim_max <span class="op">=</span><span class="fl">0.25</span>,</span></span>
<span class="r-in"><span>                              Upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">9</span><span class="op">)</span>,Lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">10</span><span class="op">)</span>,GAP<span class="op">=</span><span class="fl">0.15</span><span class="op">)</span><span class="op">$</span><span class="va">Copula_Family_Var2</span></span></span>
<span class="r-plt img"><img src="Joint_RP_2D-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#Joint excedence probability of a 5 inch rainfall and 2 ft O-sWL at S-22.</span></span></span>
<span class="r-in"><span><span class="fu">Joint_RP_2D</span><span class="op">(</span>Data<span class="op">=</span><span class="va">S22.Detrend.df</span>,</span></span>
<span class="r-in"><span>            Data_Con1<span class="op">=</span><span class="va">con.sample.Rainfall</span><span class="op">$</span><span class="va">Data</span>, Data_Con2<span class="op">=</span><span class="va">con.sample.OsWL</span><span class="op">$</span><span class="va">Data</span>,</span></span>
<span class="r-in"><span>            u1<span class="op">=</span><span class="fl">0.98</span>, u2<span class="op">=</span><span class="fl">0.98</span>,</span></span>
<span class="r-in"><span>            Copula_Family1<span class="op">=</span><span class="va">cop.Rainfall</span>,Copula_Family2<span class="op">=</span><span class="va">cop.OsWL</span>,</span></span>
<span class="r-in"><span>            Marginal_Dist1<span class="op">=</span><span class="st">"Logis"</span>, Marginal_Dist2<span class="op">=</span><span class="st">"BS"</span>,</span></span>
<span class="r-in"><span>            Con1 <span class="op">=</span> <span class="st">"Rainfall"</span>, Con2 <span class="op">=</span> <span class="st">"OsWL"</span>,</span></span>
<span class="r-in"><span>            mu <span class="op">=</span> <span class="fl">365.25</span>,</span></span>
<span class="r-in"><span>            RP_Var1 <span class="op">=</span><span class="fl">10</span>, RP_Var2 <span class="op">=</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>            x_lab <span class="op">=</span> <span class="st">"Rainfall (Inches)"</span>, y_lab <span class="op">=</span> <span class="st">"O-sWL (ft NGVD 29)"</span>,</span></span>
<span class="r-in"><span>            y_lim_max <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>            N<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50.79394</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robert Jane.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

