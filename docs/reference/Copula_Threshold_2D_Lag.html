<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Copula Selection With threshold 2D - Fit — Copula_Threshold_2D_Lag • MultiHazard</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Copula Selection With threshold 2D - Fit — Copula_Threshold_2D_Lag"><meta property="og:description" content="Declustered excesses of a (conditioning) variable are paired with co-occurences of the other variable before the best fitting bivariate copula is selected, using BiCopSelect function in the VineCopula package, for a single or range of thresholds. The procedure is automatically repeated with the variables switched."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MultiHazard</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Draft%201.html">Untitled</a>
    </li>
    <li>
      <a href="../articles/my-vignette.html">my-vignette</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Copula Selection With threshold 2D - Fit</h1>

    <div class="hidden name"><code>Copula_Threshold_2D_Lag.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Declustered excesses of a (conditioning) variable are paired with co-occurences of the other variable before the best fitting bivariate copula is selected, using <code>BiCopSelect</code> function in the <code>VineCopula</code> package, for a single or range of thresholds. The procedure is automatically repeated with the variables switched.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Copula_Threshold_2D_Lag</span><span class="op">(</span></span>
<span>  <span class="va">Data_Detrend</span>,</span>
<span>  <span class="va">Data_Declust</span>,</span>
<span>  u1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.99</span>, <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>  u2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.99</span>, <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>  PLOT <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Lag_Backward_Var1 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Lag_Forward_Var1 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Lag_Backward_Var2 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Lag_Forward_Var2 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  x_lim_min <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  x_lim_max <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  y_lim_min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  y_lim_max <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Upper <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  Lower <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  GAP <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  Legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Cex_Legend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Cex_Axis <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Cex_Axis_Original <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data-detrend">Data_Detrend<a class="anchor" aria-label="anchor" href="#arg-data-detrend"></a></dt>
<dd><p>Data frame containing two at least partially concurrent time series, detrended if necessary. Time steps must be equally spaced, with missing values assigned <code>NA</code>.</p></dd>


<dt id="arg-data-declust">Data_Declust<a class="anchor" aria-label="anchor" href="#arg-data-declust"></a></dt>
<dd><p>Data frame containing two (independently) declustered at least partially concurrent time series. Time steps must be equally spaced, with missing values assigned <code>NA</code>.</p></dd>


<dt id="arg-u-">u1<a class="anchor" aria-label="anchor" href="#arg-u-"></a></dt>
<dd><p>A single or sequence of thresholds, given as a quantile of the observations of the variable in the first column of <code>Data_Detrend</code> when it is used as the conditioning variable. Default, sequence from <code>0.9</code> to <code>0.99</code> at intervals of <code>0.01</code>.</p></dd>


<dt id="arg-u-">u2<a class="anchor" aria-label="anchor" href="#arg-u-"></a></dt>
<dd><p>A single or sequence of thresholds, given as a quantile of the observations of the variable in the second column of <code>Data_Detrend</code> when it is used as the conditioning variable. Default, sequence from <code>0.9</code> to <code>0.99</code> at intervals of <code>0.01</code>.</p></dd>


<dt id="arg-plot">PLOT<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Logical; whether to plot the results. Default is <code>"TRUE"</code>.</p></dd>


<dt id="arg-lag-backward-var-">Lag_Backward_Var1<a class="anchor" aria-label="anchor" href="#arg-lag-backward-var-"></a></dt>
<dd><p>Numeric vector of length one specifying the negative lag applied to variable in the first column of <code>Data_Detrend</code>. Default <code>1</code>.</p></dd>


<dt id="arg-lag-forward-var-">Lag_Forward_Var1<a class="anchor" aria-label="anchor" href="#arg-lag-forward-var-"></a></dt>
<dd><p>Numeric vector of length one specifying positive lag applied to variable in the first column of <code>Data_Detrend</code>. Default <code>1</code>.</p></dd>


<dt id="arg-lag-backward-var-">Lag_Backward_Var2<a class="anchor" aria-label="anchor" href="#arg-lag-backward-var-"></a></dt>
<dd><p>Numeric vector of length one specifying negative lag applied to variable in the second column of <code>Data_Detrend</code>. Default <code>1</code>.</p></dd>


<dt id="arg-lag-forward-var-">Lag_Forward_Var2<a class="anchor" aria-label="anchor" href="#arg-lag-forward-var-"></a></dt>
<dd><p>Numeric vector of length one specifying  positive lag applied to variable in the second column of <code>Data_Detrend</code>. Default <code>1</code>.</p></dd>


<dt id="arg-x-lim-min">x_lim_min<a class="anchor" aria-label="anchor" href="#arg-x-lim-min"></a></dt>
<dd><p>Numeric vector of length one specifying x-axis minimum. Default is <code>NA</code>.</p></dd>


<dt id="arg-x-lim-max">x_lim_max<a class="anchor" aria-label="anchor" href="#arg-x-lim-max"></a></dt>
<dd><p>Numeric vector of length one specifying x-axis maximum. Default is <code>NA</code>.</p></dd>


<dt id="arg-y-lim-min">y_lim_min<a class="anchor" aria-label="anchor" href="#arg-y-lim-min"></a></dt>
<dd><p>Numeric vector of length one specifying y-axis minimum. Default <code>-1.0</code>.</p></dd>


<dt id="arg-y-lim-max">y_lim_max<a class="anchor" aria-label="anchor" href="#arg-y-lim-max"></a></dt>
<dd><p>Numeric vector of length one specifying y-axis maximum. Default <code>1.0</code>.</p></dd>


<dt id="arg-upper">Upper<a class="anchor" aria-label="anchor" href="#arg-upper"></a></dt>
<dd><p>Numeric vector specifying the element number of the <code>u1</code> argument for which the copula family name label to appear above the corresponding point on the Kendall's tau coefficient vs uhold plot, when conditioning on the variable in column 1. Default is <code>NA</code>.</p></dd>


<dt id="arg-lower">Lower<a class="anchor" aria-label="anchor" href="#arg-lower"></a></dt>
<dd><p>Numeric vector specifying the element number of the <code>u2</code> argument for which the copula family name label to appear below the corresponding point on the Kendall's tau coefficient vs uhold plot, when conditioning on the variable in column 2. Default is <code>NA</code>.</p></dd>


<dt id="arg-gap">GAP<a class="anchor" aria-label="anchor" href="#arg-gap"></a></dt>
<dd><p>Numeric vector of length one specifying the distance above or below the copula family name label appears the corresponding point on the Kendall's tau coefficient vs uhold plot. Default is <code>0.05</code>.</p></dd>


<dt id="arg-legend">Legend<a class="anchor" aria-label="anchor" href="#arg-legend"></a></dt>
<dd><p>Logic vector of length one specifying whether a legend should be plotted. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-cex-legend">Cex_Legend<a class="anchor" aria-label="anchor" href="#arg-cex-legend"></a></dt>
<dd><p>Numeric vector of length one specifying the font size of the legend. Default is <code>1</code>.</p></dd>


<dt id="arg-cex-axis">Cex_Axis<a class="anchor" aria-label="anchor" href="#arg-cex-axis"></a></dt>
<dd><p>Numeric vector of length one specifying the font size of the axes. Default is <code>1</code>.</p></dd>


<dt id="arg-cex-axis-original">Cex_Axis_Original<a class="anchor" aria-label="anchor" href="#arg-cex-axis-original"></a></dt>
<dd><p>Numeric vector of length one specifying the font size of the values of the quantiles on the original (data) scale (i.e. second x-axis). Default is <code>1</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>List comprising:</p><ul><li><p><code>Kendalls_Tau1</code>
Kendall's tau of a sample</p></li>
<li><p><code>p_value_Var1</code>
p-value when testing the null hypothesis <code>H_0=0</code> i.e. that there is no correlation between the variables</p></li>
<li><p><code>N_Var1</code>
size of the dataset</p></li>
<li><p><code>Copula_Family_Var1</code>
best fitting copula for the specified thresholds</p></li>
</ul><p>when the dataset is conditioned on the variable in column 1.
Analogous vector <code>Kendalls_Tau2</code>, <code>p_value_Var2</code>, <code>N_Var2</code> and <code>Copula_Family_Var2</code> for the specified thresholds when the dataset is conditioned on the variable in column 2.
If <code>PLOT=TRUE</code> then a plot of the Kendall's tau correlation coefficient versus quantile threshold is also returned.
Filled circles denote statistically significant correlation at a <code>5%</code> significance level. Numbers inside the circles correspond to the sample size while the best fitting copula family is printed above.
Numbers below x-axis are the values of the corresponding quantiles on the original (data) scale.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="Dataframe_Combine.html">Dataframe_Combine</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">Copula_Threshold_2D_Lag</span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                        Data_Declust<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                        y_lim_min<span class="op">=</span><span class="op">-</span><span class="fl">0.075</span>, y_lim_max <span class="op">=</span><span class="fl">0.25</span>,</span></span>
<span class="r-in"><span>                        Upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">8</span><span class="op">)</span>, Lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">8</span><span class="op">)</span>,GAP<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Copula_Threshold_2D_Lag-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Kendalls_Tau1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.06927933 0.07008858 0.08656006 0.12093604 0.14377645 0.15781648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] 0.15400894 0.18224073 0.15389326 0.08945490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p_value_Var1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 2.020781e-03 3.284963e-03 8.638247e-04 1.807310e-05 1.423461e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] 1.247099e-06 1.354082e-05 4.957090e-06 1.248627e-03 1.731031e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $N_Var1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 893 791 666 565 506 425 360 284 200 107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Copula_Family_Var1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  6  6  6  6  6 13 13 13 13  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Kendalls_Tau2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.1194358 0.1387501 0.1409750 0.1822204 0.1448503 0.1465429 0.1572222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 0.1959247 0.1972220 0.1966452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p_value_Var2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 2.077031e-06 4.646026e-07 2.558094e-06 8.769150e-08 3.712186e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] 5.702464e-03 7.394536e-03 2.736557e-03 1.092366e-02 5.865988e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $N_Var2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 760 634 531 411 283 167 136 110  79  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Copula_Family_Var2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]   6   6   6  13   6  13  13 204   1   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Robert Jane.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

