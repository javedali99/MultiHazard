<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MultiHazard: Copula-based Joint Probability Analysis • MultiHazard</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="MultiHazard: Copula-based Joint Probability Analysis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MultiHazard</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li>
  <a href="../articles/MultiHazard.html">MultiHazard</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>MultiHazard: Copula-based Joint Probability
Analysis</h1>
            
      

      <div class="hidden name"><code>MultiHazard.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="multihazard">MultiHazard
<img src="https://user-images.githubusercontent.com/15319503/195926656-9d3d37b5-86ab-4d4b-9e6d-3c70d5399c73.png" align="right" height="200"><a class="anchor" aria-label="anchor" href="#multihazard"></a>
</h2>
<p>The <code>MultiHazard</code> package provides tools for stationary
multivariate statistical modeling, for example, to estimate joint
occurrence probabilities of MULTIple co-occurring HAZARDs. The package
contains functions for pre-processing data, including imputing missing
values, detrending and declustering time series as well as analyzing
pairwise correlations over a range of lags. Functionality is built in to
implement the conditional sampling - copula theory approach described in
<a href="https://doi.org/10.5194/nhess-20-2681-2020" class="external-link">Jane et
al. (2020)</a> including the automated threshold selection method from
<a href="https://doi.org/10.1002/2016WR019426" class="external-link">Solari et al. (2017)</a>.
There is a function that calculates joint probability contours using the
method of overlaying conditional contours given in <a href="https://doi.org/10.1080/02626667.2015.1052816" class="external-link">Bender et
al. (2016)</a> and extracts design events such as the “most likely”
event or an ensemble of possible design events. The package also
includes methods from <a href="https://doi.org/10.1002/env.2797" class="external-link">Murphy-Barltrop et
al. (2023)</a> and <a href="https://doi.org/10.1007/s10687-024-00490-4" class="external-link">Murphy-Barltrop et
al. (2024)</a> for deriving isolines using the <a href="https://doi.org/10.1111/j.1467-9868.2004.02050.x" class="external-link">Heffernan and
Tawn (2004)</a> [HT04] and <a href="https://doi.org/10.3150/12-BEJ471" class="external-link">Wadsworth and Tawn (2013)</a>
[WT13] models, together with a novel bootstrap procedure for quantifying
sampling uncertainty in the isolines. Three higher dimensional
approaches — standard (elliptic/Archimedean) copulas, Pair Copula
Constructions (PCCs) and a conditional threshold exceedance approach
(HT04) — are coded. Finally, the package can be implemented to derive
temporally coherent extreme events comprising a hyetograph and water
level curve for simulated peak rainfall and peak sea level events, as
outlined in (Report).</p>
<div class="section level4">
<h4 id="citation">Citation:<a class="anchor" aria-label="anchor" href="#citation"></a>
</h4>
<blockquote>
<p>Jane, R., Wahl, T., Peña, F., Obeysekera, J., Murphy-Barltrop, C.,
Ali, J., Maduwantha, P., Li, H., and Malagón Santos, V. (under review)
MultiHazard: Copula-based Joint Probability Analysis in R. Journal of
Open Source Software. [under revision]</p>
</blockquote>
<p><br></p>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>Install the latest version of this package by entering the following
in R:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"rjaneUCF/MultiHazard"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>The <code>MultiHazard</code> package provides tools for stationary
multivariate statistical modeling, for example, to estimate the joint
distribution of MULTIple co-occurring HAZARDs. This document is designed
to explain and demonstrate the functions contained within the package.
Section 1 looks at the functions concerned with pre-processing the data
including imputing missing values. Section 2 illustrates the functions
for detrending and declustering time series while Section 3 introduces a
function that analyzes pairwise correlations over a range of lags.
Section 4 shows how the conditional sampling - copula theory approach in
<a href="https://doi.org/10.5194/nhess-20-2681-2020" class="external-link">Jane et
al. (2020)</a> can be implemented including the automated threshold
selection method in <a href="https://doi.org/10.1002/2016WR019426" class="external-link">Solari et al. (2017)</a>.
Functions for selecting the best fitting among an array of (non-extreme,
truncated and non-truncated) parametric marginal distributions, and
copulas to model the dependence structure are demonstrated in this
section. Section 4 also contains an explanation of the function that
derives the joint probability contours according to the method of
overlaying (conditional) contours given in <a href="https://doi.org/10.1080/02626667.2015.1052816" class="external-link">Bender et
al. (2016)</a>, and extracts design events such as the “most likely”
event or an ensemble of possible design events. Section 4 also
introduces the functions that generate isolines using the methods from
<a href="https://doi.org/10.1002/env.2797" class="external-link">Murphy-Barltrop et
al. (2023)</a> and <a href="https://doi.org/10.1007/s10687-024-00490-4" class="external-link">Murphy-Barltrop et
al. (2024)</a>, and implements a novel bootstrap procedure for
quantifying sampling uncertainty in the isolines. Section 5 introduces
the functions for fitting and simulating synthetic events from three
higher-dimensional approaches - standard (elliptic/Archimedean) copulas,
Pair Copula Constructions (PCCs) and the conditional threshold
exceedance approach of HT04. Section 6 describes a function that
calculates the time for a user-specified height of sea level rise to
occur under various scenarios. Lastly, Section 7 shows the simulation of
temporally coherent extreme rainfall and ocean water level events.</p>
</div>
<div class="section level3">
<h3 id="pre-processing">2. Pre-processing<a class="anchor" aria-label="anchor" href="#pre-processing"></a>
</h3>
<div class="section level4">
<h4 id="imputation">Imputation<a class="anchor" aria-label="anchor" href="#imputation"></a>
</h4>
<p>Well G_3356 represents the groundwater level at Site S20, however, it
contains missing values. Let’s impute missing values in the record at
Well G_3356 using recordings at nearby Well G_3355. First, reading in
the two time series.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Viewing first few rows of in the groundwater level records</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">G_3356</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Date Value</span></span>
<span><span class="co">#&gt; 1 23-Oct-85  2.46</span></span>
<span><span class="co">#&gt; 2 24-Oct-85  2.47</span></span>
<span><span class="co">#&gt; 3 25-Oct-85  2.41</span></span>
<span><span class="co">#&gt; 4 26-Oct-85  2.37</span></span>
<span><span class="co">#&gt; 5 27-Oct-85  2.63</span></span>
<span><span class="co">#&gt; 6 28-Oct-85  2.54</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">G_3355</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Date Value</span></span>
<span><span class="co">#&gt; 1 20-Aug-85  2.53</span></span>
<span><span class="co">#&gt; 2 21-Aug-85  2.50</span></span>
<span><span class="co">#&gt; 3 22-Aug-85  2.46</span></span>
<span><span class="co">#&gt; 4 23-Aug-85  2.43</span></span>
<span><span class="co">#&gt; 5 24-Aug-85  2.40</span></span>
<span><span class="co">#&gt; 6 25-Aug-85  2.37</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Converting Date column to "Date"" object</span></span>
<span><span class="va">G_3356</span><span class="op">$</span><span class="va">Date</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1985-10-23"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-05-29"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">G_3355</span><span class="op">$</span><span class="va">Date</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1985-08-20"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-06-02"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="co">#Converting column containing the readings to a "numeric"" object</span></span>
<span><span class="va">G_3356</span><span class="op">$</span><span class="va">Value</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">G_3356</span><span class="op">$</span><span class="va">Value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G_3355</span><span class="op">$</span><span class="va">Value</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">G_3355</span><span class="op">$</span><span class="va">Value</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Warning message confirms there are NAs in the record at Well G_3356.
Before carrying out the imputation the two data frames need to be
merged.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Merge the two dataframes by date</span></span>
<span><span class="va">GW_S20</span><span class="op">&lt;-</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">G_3356</span>,<span class="va">G_3355</span>,by<span class="op">=</span><span class="st">"Date"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">GW_S20</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"G3356"</span>,<span class="st">"G3355"</span><span class="op">)</span></span>
<span><span class="co">#Carrying out imputation</span></span>
<span><span class="va">Imp</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Imputation.html">Imputation</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">GW_S20</span>,Variable<span class="op">=</span><span class="st">"G3356"</span>,</span>
<span>                x_lab<span class="op">=</span><span class="st">"G-3355 (ft NGVD 29)"</span>, y_lab<span class="op">=</span><span class="st">"G-3356 (ft NGVD 29)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-5-1.png" width="700"></p>
<p>The completed record is given in the <code>ValuesFilled</code> column
of the data frame outputted as the <code>Data</code> object while the
linear regression model including its coefficient of determinant are
given by the <code>model</code> output argument.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Date G3356 G3355 ValuesFilled</span></span>
<span><span class="co">#&gt; 1 1985-10-23  2.46  2.87         2.46</span></span>
<span><span class="co">#&gt; 2 1985-10-24  2.47  2.85         2.47</span></span>
<span><span class="co">#&gt; 3 1985-10-25  2.41  2.82         2.41</span></span>
<span><span class="co">#&gt; 4 1985-10-26  2.37  2.79         2.37</span></span>
<span><span class="co">#&gt; 5 1985-10-27  2.63  2.96         2.63</span></span>
<span><span class="co">#&gt; 6 1985-10-28  2.54  2.96         2.54</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Imp</span><span class="op">$</span><span class="va">Model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = data[, variable] ~ data[, Other.variable])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -1.60190 -0.16654  0.00525  0.16858  1.73824 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)            0.275858   0.012366   22.31   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; data[, Other.variable] 0.700724   0.004459  157.15   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.2995 on 11825 degrees of freedom</span></span>
<span><span class="co">#&gt;   (445 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.6762, Adjusted R-squared:  0.6762 </span></span>
<span><span class="co">#&gt; F-statistic: 2.47e+04 on 1 and 11825 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Are any values still NA?</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G_3356_ValueFilled_NA</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">G_3356_ValueFilled_NA</span><span class="op">)</span> </span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p>Linear interpolating the three remaining NAs.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G3356_approx</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,<span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span>,</span>
<span>                     xout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span></span>
<span>  <span class="va">G3356_approx</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="detrending">Detrending<a class="anchor" aria-label="anchor" href="#detrending"></a>
</h4>
<p>In the analysis completed O-sWL (Ocean-side Water Level) and
groundwater level series are subsequently detrended. The Detrend()
function uses either a linear fit covering the entire data
(<code>Method</code>=<code>linear</code>) or moving average window
(<code>Method</code>=<code>window</code>) of a specified length
(<code>Window_Width</code>) to remove trends from a time series. The
residuals are added to the final <code>End_Length</code> observations.
The default <code><a href="../reference/Detrend.html">Detrend()</a></code> parameters specify a moving average
(<code>Method</code>=<code>window</code>) three month window
(<code>Window_Width</code>=<code>89</code>), to remove any seasonality
from the time series. The default is then to add the residuals to the
average of the final five years of observations
(<code>End_Length</code>=<code>1826</code>) to bring the record to the
present day level, accounting for the Perigean tide in the case of
O-sWL. The mean of the observations over the first three months were
subtracted from the values during this period before the present day
(5-year) average was added. The following R code detrends the record at
Well G_3356. Note the function requires a Date object and the completed
series.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Creating a data frame with the imputed series alongside the corresponding dates </span></span>
<span><span class="va">G_3356_Imp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Date</span>,<span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">G_3356_Imp</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"ValuesFilled"</span><span class="op">)</span></span>
<span><span class="co">#Detrending</span></span>
<span><span class="va">G_3356_Detrend</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Detrend.html">Detrend</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">G_3356_Imp</span>,PLOT<span class="op">=</span><span class="cn">TRUE</span>,x_lab<span class="op">=</span><span class="st">"Date"</span>,</span>
<span>                        y_lab<span class="op">=</span><span class="st">"Groundwater level (ft NGVD 29)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-10-1.png" width="700"></p>
<p>Output of the function is simply the detrended time series.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">G_3356_Detrend</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.394700 2.411588 2.360033 2.327588 2.595588 2.520255</span></span></code></pre></div>
<p>Creating a data frame containing the detrended groundwater series at
site S_20 i.e. G_3356_Detrend and their corresponding dates</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Groundwater.Detrend.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">GW_S20</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>,<span class="va">G_3356_Detrend</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.Groundwater.Detrend.df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"Groundwater"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="declustering">Declustering<a class="anchor" aria-label="anchor" href="#declustering"></a>
</h4>
<p>The <code><a href="../reference/Decluster.html">Decluster()</a></code> function declusters a time series using
a threshold u specified as a quantile of the completed series and
separation criterion <code>SepCrit</code> to ensure independent events.
If <code>mu</code>=<code>365.25</code> then <code>SepCrit</code> denotes
the minimum number of days readings must remain below the threshold
before a new event is defined.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G_3356.Declustered</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Decluster.html">Decluster</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">G_3356_Detrend</span>,u<span class="op">=</span><span class="fl">0.95</span>,SepCrit<span class="op">=</span><span class="fl">3</span>,mu<span class="op">=</span><span class="fl">365.25</span><span class="op">)</span></span></code></pre></div>
<p>Plot showing the completed, detrended record at Well G-3356 (grey
circles) along with cluster maxima (red circles) identified using a 95%
threshold (green line) and three day separation criterion.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G_3356_Imp</span><span class="op">$</span><span class="va">Detrend</span><span class="op">&lt;-</span><span class="va">G_3356_Detrend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">G_3356_Imp</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>,<span class="va">G_3356_Imp</span><span class="op">$</span><span class="va">Detrend</span>,col<span class="op">=</span><span class="st">"Grey"</span>,pch<span class="op">=</span><span class="fl">16</span>,</span>
<span>     cex<span class="op">=</span><span class="fl">0.25</span>,xlab<span class="op">=</span><span class="st">"Date"</span>,ylab<span class="op">=</span><span class="st">"Groundwater level (ft NGVD 29)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">Threshold</span>,col<span class="op">=</span><span class="st">"Dark Green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">G_3356_Imp</span><span class="op">$</span><span class="va">Date</span><span class="op">[</span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       <span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">Declustered</span><span class="op">[</span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">]</span>,</span>
<span>       col<span class="op">=</span><span class="st">"Red"</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-14-1.png" width="700"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Robert Jane.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
