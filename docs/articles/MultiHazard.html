<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>MultiHazard: Copula-based Joint Probability Analysis • MultiHazard</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MultiHazard: Copula-based Joint Probability Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MultiHazard</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.13</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/MultiHazard.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rjaneucf/MultiHazard/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>MultiHazard: Copula-based Joint Probability Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rjaneucf/MultiHazard/blob/HEAD/vignettes/MultiHazard.Rmd" class="external-link"><code>vignettes/MultiHazard.Rmd</code></a></small>
      <div class="d-none name"><code>MultiHazard.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="multihazard">MultiHazard
<img src="https://user-images.githubusercontent.com/15319503/195926656-9d3d37b5-86ab-4d4b-9e6d-3c70d5399c73.png" align="right" height="200"><a class="anchor" aria-label="anchor" href="#multihazard"></a>
</h2>
<p>The <code>MultiHazard</code> package provides tools for stationary
multivariate statistical modeling, for example, to estimate joint
occurrence probabilities of MULTIple co-occurring HAZARDs. The package
contains functions for pre-processing data, including imputing missing
values, detrending and declustering time series as well as analyzing
pairwise correlations over a range of lags. Functionality is built in to
implement the conditional sampling - copula theory approach described in
<a href="https://doi.org/10.5194/nhess-20-2681-2020" class="external-link">Jane et
al. (2020)</a> including the automated threshold selection method from
<a href="https://doi.org/10.1002/2016WR019426" class="external-link">Solari et al. (2017)</a>.
There is a function that calculates joint probability contours using the
method of overlaying conditional contours given in <a href="https://doi.org/10.1080/02626667.2015.1052816" class="external-link">Bender et
al. (2016)</a> and extracts design events such as the “most likely”
event or an ensemble of possible design events. The package also
includes methods from <a href="https://doi.org/10.1002/env.2797" class="external-link">Murphy-Barltrop et
al. (2023)</a> and <a href="https://doi.org/10.1007/s10687-024-00490-4" class="external-link">Murphy-Barltrop et
al. (2024)</a> for deriving isolines using the <a href="https://doi.org/10.1111/j.1467-9868.2004.02050.x" class="external-link">Heffernan and
Tawn (2004)</a> <a href="#ht04">HT04</a> and <a href="https://doi.org/10.3150/12-BEJ471" class="external-link">Wadsworth and Tawn (2013)</a>
[WT13] models, together with a novel bootstrap procedure for quantifying
sampling uncertainty in the isolines. Three higher dimensional
approaches — standard (elliptic/Archimedean) copulas, Pair Copula
Constructions (PCCs) and a conditional threshold exceedance approach
(HT04) — are coded. Finally, the package can be implemented to derive
temporally coherent extreme events comprising a hyetograph and water
level curve for simulated peak rainfall and peak sea level events, as
outlined in (Report).</p>
<div class="section level4">
<h4 id="citation">Citation:<a class="anchor" aria-label="anchor" href="#citation"></a>
</h4>
<blockquote>
<p>Jane, R., Wahl, T., Peña, F., Obeysekera, J., Murphy-Barltrop, C.,
Ali, J., Maduwantha, P., Li, H., and Malagón Santos, V. (under review)
MultiHazard: Copula-based Joint Probability Analysis in R. Journal of
Open Source Software. [under revision]</p>
</blockquote>
<p><br></p>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>Install the latest version of this package by entering the following
in R:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"rjaneUCF/MultiHazard"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>The <code>MultiHazard</code> package provides tools for stationary
multivariate statistical modeling, for example, to estimate the joint
distribution of MULTIple co-occurring HAZARDs. This document is designed
to explain and demonstrate the functions contained within the package.
Section 1 looks at the functions concerned with pre-processing the data
including imputing missing values. Section 2 illustrates the functions
for detrending and declustering time series while Section 3 introduces a
function that analyzes pairwise correlations over a range of lags.
Section 4 shows how the conditional sampling - copula theory approach in
<a href="https://doi.org/10.5194/nhess-20-2681-2020" class="external-link">Jane et
al. (2020)</a> can be implemented including the automated threshold
selection method in <a href="https://doi.org/10.1002/2016WR019426" class="external-link">Solari et al. (2017)</a>.
Functions for selecting the best fitting among an array of (non-extreme,
truncated and non-truncated) parametric marginal distributions, and
copulas to model the dependence structure are demonstrated in this
section. Section 4 also contains an explanation of the function that
derives the joint probability contours according to the method of
overlaying (conditional) contours given in <a href="https://doi.org/10.1080/02626667.2015.1052816" class="external-link">Bender et
al. (2016)</a>, and extracts design events such as the “most likely”
event or an ensemble of possible design events. Section 4 also
introduces the functions that generate isolines using the methods from
<a href="https://doi.org/10.1002/env.2797" class="external-link">Murphy-Barltrop et
al. (2023)</a> and <a href="https://doi.org/10.1007/s10687-024-00490-4" class="external-link">Murphy-Barltrop et
al. (2024)</a>, and implements a novel bootstrap procedure for
quantifying sampling uncertainty in the isolines. Section 5 introduces
the functions for fitting and simulating synthetic events from three
higher-dimensional approaches - standard (elliptic/Archimedean) copulas,
Pair Copula Constructions (PCCs) and the conditional threshold
exceedance approach of HT04. Section 6 describes a function that
calculates the time for a user-specified height of sea level rise to
occur under various scenarios. Lastly, Section 7 shows the simulation of
temporally coherent extreme rainfall and ocean water level events.</p>
</div>
<div class="section level3">
<h3 id="pre-processing">2. Pre-processing<a class="anchor" aria-label="anchor" href="#pre-processing"></a>
</h3>
<div class="section level4">
<h4 id="imputation">Imputation<a class="anchor" aria-label="anchor" href="#imputation"></a>
</h4>
<p>Well G_3356 represents the groundwater level at Site S20, however, it
contains missing values. Let’s impute missing values in the record at
Well G_3356 using recordings at nearby Well G_3355. First, reading in
the two time series.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Viewing first few rows of in the groundwater level records</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">G_3356</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Date Value</span></span>
<span><span class="co">#&gt; 1 1985-10-23  2.46</span></span>
<span><span class="co">#&gt; 2 1985-10-24  2.47</span></span>
<span><span class="co">#&gt; 3 1985-10-25  2.41</span></span>
<span><span class="co">#&gt; 4 1985-10-26  2.37</span></span>
<span><span class="co">#&gt; 5 1985-10-27  2.63</span></span>
<span><span class="co">#&gt; 6 1985-10-28  2.54</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">G_3355</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Date Value</span></span>
<span><span class="co">#&gt; 1 1985-08-20  2.53</span></span>
<span><span class="co">#&gt; 2 1985-08-21  2.50</span></span>
<span><span class="co">#&gt; 3 1985-08-22  2.46</span></span>
<span><span class="co">#&gt; 4 1985-08-23  2.43</span></span>
<span><span class="co">#&gt; 5 1985-08-24  2.40</span></span>
<span><span class="co">#&gt; 6 1985-08-25  2.37</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Converting Date column to "Date"" object</span></span>
<span><span class="va">G_3356</span><span class="op">$</span><span class="va">Date</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1985-10-23"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-05-29"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">G_3355</span><span class="op">$</span><span class="va">Date</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1985-08-20"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-06-02"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="co">#Converting column containing the readings to a "numeric"" object</span></span>
<span><span class="va">G_3356</span><span class="op">$</span><span class="va">Value</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">G_3356</span><span class="op">$</span><span class="va">Value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G_3355</span><span class="op">$</span><span class="va">Value</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">G_3355</span><span class="op">$</span><span class="va">Value</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Warning message confirms there are NAs in the record at Well G_3356.
Before carrying out the imputation the two data frames need to be
merged.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Merge the two dataframes by date</span></span>
<span><span class="va">GW_S20</span><span class="op">&lt;-</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">G_3356</span>,<span class="va">G_3355</span>,by<span class="op">=</span><span class="st">"Date"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">GW_S20</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"G3356"</span>,<span class="st">"G3355"</span><span class="op">)</span></span>
<span><span class="co">#Carrying out imputation</span></span>
<span><span class="va">Imp</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Imputation.html">Imputation</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">GW_S20</span>,Variable<span class="op">=</span><span class="st">"G3356"</span>,</span>
<span>                x_lab<span class="op">=</span><span class="st">"G-3355 (ft NGVD 29)"</span>, y_lab<span class="op">=</span><span class="st">"G-3356 (ft NGVD 29)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-5-1.png" width="700"></p>
<p>The completed record is given in the <code>ValuesFilled</code> column
of the data frame outputted as the <code>Data</code> object while the
linear regression model including its coefficient of determinant are
given by the <code>model</code> output argument.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Date G3356 G3355 ValuesFilled</span></span>
<span><span class="co">#&gt; 1 1985-10-23  2.46  2.87         2.46</span></span>
<span><span class="co">#&gt; 2 1985-10-24  2.47  2.85         2.47</span></span>
<span><span class="co">#&gt; 3 1985-10-25  2.41  2.82         2.41</span></span>
<span><span class="co">#&gt; 4 1985-10-26  2.37  2.79         2.37</span></span>
<span><span class="co">#&gt; 5 1985-10-27  2.63  2.96         2.63</span></span>
<span><span class="co">#&gt; 6 1985-10-28  2.54  2.96         2.54</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Imp</span><span class="op">$</span><span class="va">Model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = data[, variable] ~ data[, Other.variable])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -1.60190 -0.16654  0.00525  0.16858  1.73824 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)            0.275858   0.012366   22.31   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; data[, Other.variable] 0.700724   0.004459  157.15   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.2995 on 11825 degrees of freedom</span></span>
<span><span class="co">#&gt;   (445 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.6762, Adjusted R-squared:  0.6762 </span></span>
<span><span class="co">#&gt; F-statistic: 2.47e+04 on 1 and 11825 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Are any values still NA?</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G_3356_ValueFilled_NA</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">G_3356_ValueFilled_NA</span><span class="op">)</span> </span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p>Linear interpolating the three remaining NAs.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G3356_approx</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,<span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span>,</span>
<span>                     xout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span></span>
<span>  <span class="va">G3356_approx</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="detrending">Detrending<a class="anchor" aria-label="anchor" href="#detrending"></a>
</h4>
<p>In the analysis completed O-sWL (Ocean-side Water Level) and
groundwater level series are subsequently detrended. The Detrend()
function uses either a linear fit covering the entire data
(<code>Method</code>=<code>linear</code>) or moving average window
(<code>Method</code>=<code>window</code>) of a specified length
(<code>Window_Width</code>) to remove trends from a time series. The
residuals are added to the final <code>End_Length</code> observations.
The default <code><a href="../reference/Detrend.html">Detrend()</a></code> parameters specify a moving average
(<code>Method</code>=<code>window</code>) three month window
(<code>Window_Width</code>=<code>89</code>), to remove any seasonality
from the time series. The default is then to add the residuals to the
average of the final five years of observations
(<code>End_Length</code>=<code>1826</code>) to bring the record to the
present day level, accounting for the Perigean tide in the case of
O-sWL. The mean of the observations over the first three months were
subtracted from the values during this period before the present day
(5-year) average was added. The following R code detrends the record at
Well G_3356. Note the function requires a Date object and the completed
series.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Creating a data frame with the imputed series alongside the corresponding dates </span></span>
<span><span class="va">G_3356_Imp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Date</span>,<span class="va">Imp</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">ValuesFilled</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">G_3356_Imp</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"ValuesFilled"</span><span class="op">)</span></span>
<span><span class="co">#Detrending</span></span>
<span><span class="va">G_3356_Detrend</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Detrend.html">Detrend</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">G_3356_Imp</span>,PLOT<span class="op">=</span><span class="cn">TRUE</span>,x_lab<span class="op">=</span><span class="st">"Date"</span>,</span>
<span>                        y_lab<span class="op">=</span><span class="st">"Groundwater level (ft NGVD 29)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-10-1.png" width="700"></p>
<p>Output of the function is simply the detrended time series.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">G_3356_Detrend</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.394700 2.411588 2.360033 2.327588 2.595588 2.520255</span></span></code></pre></div>
<p>Creating a data frame containing the detrended groundwater series at
site S_20 i.e. G_3356_Detrend and their corresponding dates</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Groundwater.Detrend.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">GW_S20</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>,<span class="va">G_3356_Detrend</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.Groundwater.Detrend.df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"Groundwater"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="declustering">Declustering<a class="anchor" aria-label="anchor" href="#declustering"></a>
</h4>
<p>The <code><a href="../reference/Decluster.html">Decluster()</a></code> function declusters a time series using
a threshold u specified as a quantile of the completed series and
separation criterion <code>SepCrit</code> to ensure independent events.
If <code>mu</code>=<code>365.25</code> then <code>SepCrit</code> denotes
the minimum number of days readings must remain below the threshold
before a new event is defined.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G_3356.Declustered</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Decluster.html">Decluster</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">G_3356_Detrend</span>,u<span class="op">=</span><span class="fl">0.95</span>,SepCrit<span class="op">=</span><span class="fl">3</span>,mu<span class="op">=</span><span class="fl">365.25</span><span class="op">)</span></span></code></pre></div>
<p>Plot showing the completed, detrended record at Well G-3356 (grey
circles) along with cluster maxima (red circles) identified using a 95%
threshold (green line) and three day separation criterion.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G_3356_Imp</span><span class="op">$</span><span class="va">Detrend</span><span class="op">&lt;-</span><span class="va">G_3356_Detrend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">G_3356_Imp</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>,<span class="va">G_3356_Imp</span><span class="op">$</span><span class="va">Detrend</span>,col<span class="op">=</span><span class="st">"Grey"</span>,pch<span class="op">=</span><span class="fl">16</span>,</span>
<span>     cex<span class="op">=</span><span class="fl">0.25</span>,xlab<span class="op">=</span><span class="st">"Date"</span>,ylab<span class="op">=</span><span class="st">"Groundwater level (ft NGVD 29)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">Threshold</span>,col<span class="op">=</span><span class="st">"Dark Green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">G_3356_Imp</span><span class="op">$</span><span class="va">Date</span><span class="op">[</span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       <span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">Declustered</span><span class="op">[</span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">]</span>,</span>
<span>       col<span class="op">=</span><span class="st">"Red"</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-14-1.png" width="700"></p>
<p>Other outputs from the <code><a href="../reference/Decluster.html">Decluster()</a></code> function include the
threshold on the original scale</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">Threshold</span></span>
<span><span class="co">#&gt; [1] 2.751744</span></span></code></pre></div>
<p>and the number of events per year</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">Rate</span></span>
<span><span class="co">#&gt; [1] 7.857399</span></span></code></pre></div>
<p>In preparation for later work, lets assign the detrended and
declustered groundwater series at site S20 a name.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Groundwater.Detrend.Declustered</span><span class="op">&lt;-</span><span class="va">G_3356.Declustered</span><span class="op">$</span><span class="va">Declustered</span></span></code></pre></div>
<p>Reading in the other rainfall and O-sWL series at Site S20</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Changing names of the data frames</span></span>
<span><span class="va">S20.Rainfall.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1958-12-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-06-03"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span>,<span class="va">Perrine_df</span><span class="op">$</span><span class="va">Value</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.Rainfall.df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"Value"</span><span class="op">)</span></span>
<span><span class="va">S20.OsWL.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1969-03-25"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-05-21"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span>,</span>
<span>                        <span class="va">S20_T_MAX_Daily_Completed_Detrend_Declustered</span><span class="op">$</span><span class="va">ValueFilled</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.OsWL.df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"OsWL"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Converting Date column to "Date"" object</span></span>
<span><span class="co">#S20.Rainfall.df$Date&lt;-as.Date(as.character(S20.Rainfall.df$Date), format = "%m/%d/%Y")</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#S20.OsWL.df$Date&lt;- as.Date(as.character(unlist(S20.OsWL.df$Date)), format = "%m/%d/%Y")</span></span></code></pre></div>
<p>Detrending and declustering the rainfall and O-sWL series at Site
S20</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.OsWL.Detrend</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Detrend.html">Detrend</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.OsWL.df</span>,Method <span class="op">=</span> <span class="st">"window"</span>,PLOT<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                          x_lab<span class="op">=</span><span class="st">"Date"</span>,y_lab<span class="op">=</span><span class="st">"O-sWL (ft NGVD 29)"</span><span class="op">)</span></span></code></pre></div>
<p>Creating a dataframe with the date alongside the detrended OsWL
series</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.OsWL.Detrend.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">S20.OsWL.df</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>,<span class="va">S20.OsWL.Detrend</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.OsWL.Detrend.df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"OsWL"</span><span class="op">)</span></span></code></pre></div>
<p>Declustering rainfall and O-sWL series at site S20,</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Declustering rainfall and O-sWL series</span></span>
<span><span class="va">S20.Rainfall.Declustered</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Decluster.html">Decluster</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Value</span>,u<span class="op">=</span><span class="fl">0.95</span>,SepCrit<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">Declustered</span></span>
<span><span class="va">S20.OsWL.Detrend.Declustered</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Decluster.html">Decluster</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.OsWL.Detrend</span>,u<span class="op">=</span><span class="fl">0.95</span>,SepCrit<span class="op">=</span><span class="fl">3</span>,mu<span class="op">=</span><span class="fl">365.25</span><span class="op">)</span><span class="op">$</span><span class="va">Declustered</span></span></code></pre></div>
<p>Creating data frames with the date alongside declustered series</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.OsWL.Detrend.Declustered.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">S20.OsWL.df</span><span class="op">$</span><span class="va">Date</span>,<span class="va">S20.OsWL.Detrend.Declustered</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.OsWL.Detrend.Declustered.df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"OsWL"</span><span class="op">)</span></span>
<span><span class="va">S20.Rainfall.Declustered.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Date</span>,<span class="va">S20.Rainfall.Declustered</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.Rainfall.Declustered.df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"Rainfall"</span><span class="op">)</span></span>
<span><span class="va">S20.Groundwater.Detrend.Declustered.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">G_3356</span><span class="op">$</span><span class="va">Date</span>,<span class="va">S20.Groundwater.Detrend.Declustered</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.Groundwater.Detrend.Declustered.df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"Groundwater"</span><span class="op">)</span></span></code></pre></div>
<p>Use the <code><a href="../reference/Dataframe_Combine.html">Dataframe_Combine()</a></code> function to create data
frames containing all observations of the original, detrended if
necessary, and declustered time series. On dates where not all variables
are observed, missing values are assigned NA.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Detrend.df</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Dataframe_Combine.html">Dataframe_Combine</a></span><span class="op">(</span><span class="va">data.1</span><span class="op">&lt;-</span><span class="va">S20.Rainfall.df</span>,</span>
<span>                                  <span class="va">data.2</span><span class="op">&lt;-</span><span class="va">S20.OsWL.Detrend.df</span>,</span>
<span>                                  <span class="va">data.3</span><span class="op">&lt;-</span><span class="va">S20.Groundwater.Detrend.df</span>,</span>
<span>                                  names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rainfall"</span>,<span class="st">"OsWL"</span>,<span class="st">"Groundwater"</span><span class="op">)</span>, n<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">S20.Detrend.Declustered.df</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Dataframe_Combine.html">Dataframe_Combine</a></span><span class="op">(</span><span class="va">data.1</span><span class="op">&lt;-</span><span class="va">S20.Rainfall.Declustered.df</span>,</span>
<span>                                              <span class="va">data.2</span><span class="op">&lt;-</span><span class="va">S20.OsWL.Detrend.Declustered.df</span>,</span>
<span>                                              <span class="va">data.3</span><span class="op">&lt;-</span><span class="va">S20.Groundwater.Detrend.Declustered.df</span>,</span>
<span>                                              names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rainfall"</span>,<span class="st">"OsWL"</span>,<span class="st">"Groundwater"</span><span class="op">)</span>, n<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>The package contains two other declustering functions. The
<code><a href="../reference/Decluster_SW.html">Decluster_SW()</a></code> function declusters a time series via a
storm window approach. A moving window of length
(<code>Window_Width</code>) is moved over the time series, if the
maximum value is located at the center of the window then the value is
considered a peak and retained, otherwise it is set equal to NA. For a
seven day window at S20:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Rainfall.Declustered.SW</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Decluster_SW.html">Decluster_SW</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Rainfall.df</span>,Window_Width<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the original and detrended series:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Date</span>,<span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Value</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Date"</span>,ylab<span class="op">=</span><span class="st">"Total daily rainfall (Inches)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Date</span>,<span class="va">S20.Rainfall.Declustered.SW</span><span class="op">$</span><span class="va">Declustered</span>,pch<span class="op">=</span><span class="fl">16</span>,col<span class="op">=</span><span class="fl">2</span>,cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-27-1.png" width="700"></p>
<p>Repeating the analysis for the O-sWL with a 3-day window.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.OsWL.Declustered.SW</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Decluster_SW.html">Decluster_SW</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.OsWL.df</span>,Window_Width<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/Decluster_S_SW.html">Decluster_S_SW()</a></code> function declusters a summed time
series via a storm window approach. First a moving window of width
(<code>Window_Width_Sum</code>) travels across the data and each time
the values are summed. As with the <code><a href="../reference/Decluster_SW.html">Decluster_SW()</a></code> function
a moving window of length <code>(Window_Width</code>) is then moved over
the time series, if the maximum value in a window is located at its
center then the value considered a peak and retained, otherwise it is
set equal to NA. To decluster weekly precipitation totals using a seven
day storm window at S20:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Declustering</span></span>
<span><span class="va">S20.Rainfall.Declustered.S.SW</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Decluster_S_SW.html">Decluster_S_SW</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Rainfall.df</span>, </span>
<span>                                              Window_Width_Sum<span class="op">=</span><span class="fl">7</span>, Window_Width<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="co">#First twenty values of the weekly totals</span></span>
<span><span class="va">S20.Rainfall.Declustered.S.SW</span><span class="op">$</span><span class="va">Totals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1]   NA   NA   NA 0.23 0.19 0.10 1.56 1.94 2.04 2.04 2.04 2.91 3.02 2.75 3.15</span></span>
<span><span class="co">#&gt; [16] 3.05 3.05 3.05 2.18 2.03</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#First ten values of the declustered weekly totals</span></span>
<span><span class="va">S20.Rainfall.Declustered.S.SW</span><span class="op">$</span><span class="va">Declustered</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1]   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA 3.15</span></span>
<span><span class="co">#&gt; [16]   NA   NA   NA   NA   NA</span></span></code></pre></div>
<p>Plotting the original and detrended series:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Date</span>,<span class="va">S20.Rainfall.Declustered.S.SW</span><span class="op">$</span><span class="va">Totals</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Date"</span>,ylab<span class="op">=</span><span class="st">"Total weekly rainfall (Inches)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">S20.Rainfall.df</span><span class="op">$</span><span class="va">Date</span>,<span class="va">S20.Rainfall.Declustered.S.SW</span><span class="op">$</span><span class="va">Declustered</span>,pch<span class="op">=</span><span class="fl">16</span>,col<span class="op">=</span><span class="fl">2</span>,cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-31-1.png" width="700"></p>
<div class="section level5">
<h5 id="fit-gpd">Fit GPD<a class="anchor" aria-label="anchor" href="#fit-gpd"></a>
</h5>
<p>The <code><a href="../reference/GPD_Fit.html">GPD_Fit()</a></code> function fits a generalized Pareto
distribution (GPD) to observations above a threshold u, specified as a
quantile of the completed time series. To fit the distribution the
<code><a href="../reference/GPD_Fit.html">GPD_Fit()</a></code> function requires the declustered series as its
Data argument and the entire completed series, detrended if necessary,
as its <code>Data_Full</code> argument. The completed series is required
to calculate the value on the original scale corresponding to u. If
<code>PLOT=TRUE</code> then diagnostic plots are produced to allow an
assessment of the fit.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GPD_Fit.html">GPD_Fit</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">$</span><span class="va">Rainfall</span>,Data_Full<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span>,</span>
<span>        u<span class="op">=</span><span class="fl">0.997</span>,PLOT<span class="op">=</span><span class="cn">TRUE</span>,xlab_hist<span class="op">=</span><span class="st">"Rainfall (Inches)"</span>,y_lab<span class="op">=</span><span class="st">"Rainfall (Inches)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-32-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; $Threshold</span></span>
<span><span class="co">#&gt; [1] 3.5465</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Rate</span></span>
<span><span class="co">#&gt; [1] 1.021938</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sigma</span></span>
<span><span class="co">#&gt; [1] 1.421037</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $xi</span></span>
<span><span class="co">#&gt; [1] 0.1696554</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sigma.SE</span></span>
<span><span class="co">#&gt; [1] 0.2365755</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $xi.SE</span></span>
<span><span class="co">#&gt; [1] 0.1781031</span></span></code></pre>
</div>
<div class="section level5">
<h5 id="solari-2017-automated-threshold-selection">Solari (2017) automated threshold selection<a class="anchor" aria-label="anchor" href="#solari-2017-automated-threshold-selection"></a>
</h5>
<p><a href="https://doi.org/10.1002/2016WR019426" class="external-link">Solari et
al. (2017)</a> proposes a methodology for automatic threshold
estimation, based on an EDF-statistic and a goodness of fit test to test
the null hypothesis that exceedances of a high threshold come from a GPD
distribution.</p>
<p>EDF-statistics measure the distance between the empirical
distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>n</mi></msub><annotation encoding="application/x-tex">F_n</annotation></semantics></math>
obtained from the sample and the parametric distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(x)</annotation></semantics></math>.
The Anderson Darling
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>A</mi><mn>2</mn></msup><annotation encoding="application/x-tex">A^2</annotation></semantics></math>
statistic is an EDF-statistic, which assigns more weight to the tails of
the data than similar measures. <a href="https://doi.org/10.1080/03610929008830405" class="external-link">Sinclair et
al. (1990)</a> proposed the right-tail weighted Anderson Darling
statistic
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>A</mi><mi>R</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">A_R^2</annotation></semantics></math>
which allocates more weight to the upper tail and less to the lower tail
of the distribution than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>A</mi><mn>2</mn></msup><annotation encoding="application/x-tex">A^2</annotation></semantics></math>
and is given by: <span class="math display">$${A}_{R}^{2}= -\frac{n}{2}
-  \sum\_{i=1}^{n}
\left\[\left(2-\frac{(2i-1)}{n}\right)\text{log}(1-z\_{i})+2z\_{i}\right\]
$$</span> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">z=F(x)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is the sample size. The approach in <a href="https://doi.org/10.1002/2016WR019426" class="external-link">Solari et al. (2017)</a> is
implemented as follows:</p>
<ol style="list-style-type: decimal">
<li>A time series is declustered using the storm window approach to
identify independent peaks.</li>
<li>Candidate thresholds are defined by ordering the peaks and removing
any repeated values. A GPD is fit to all the peaks above each candidate
threshold. The right-tail weighted Anderson-Darling statistic
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>A</mi><mi>R</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">A_R^2</annotation></semantics></math>
and its corresponding p-value are calculated for each threshold.</li>
<li>The threshold that minimizes one minus the p-value is then
selected.</li>
</ol>
<p>The <code><a href="../reference/GPD_Threshold_Solari.html">GPD_Threshold_Solari()</a></code> function carries out these
steps.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Rainfall.Solari</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/GPD_Threshold_Solari.html">GPD_Threshold_Solari</a></span><span class="op">(</span>Event<span class="op">=</span><span class="va">S20.Rainfall.Declustered.SW</span><span class="op">$</span><span class="va">Declustered</span>,</span>
<span>                                          Data<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in solve.default(family$info(o)) : </span></span>
<span><span class="co">#&gt;   Lapack routine dgesv: system is exactly singular: U[2,2] = 0</span></span>
<span><span class="co">#&gt; Error in diag(o$cov) : invalid 'nrow' value (too large or NA)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-33-1.png" width="700"></p>
<p>The optimum threshold according to the Solari approach is</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Rainfall.Solari</span><span class="op">$</span><span class="va">Candidate_Thres</span></span>
<span><span class="co">#&gt; [1] 2.6</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Rainfall.Thres.Quantile</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span><span class="op">(</span><span class="va">S20.Rainfall.Solari</span><span class="op">$</span><span class="va">Candidate_Thres</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/GPD_Threshold_Solari_Sel.html">GPD_Threshold_Solari_Sel()</a></code> allows the
goodness-of-fit at a particular threshold (<code>Thres</code>) to be
investigated in more detail. Let’s study the fit of the threshold
selected by the method.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Solari.Sel</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/GPD_Threshold_Solari_Sel.html">GPD_Threshold_Solari_Sel</a></span><span class="op">(</span>Event<span class="op">=</span><span class="va">S20.Rainfall.Declustered.SW</span><span class="op">$</span><span class="va">Declustered</span>,</span>
<span>                                    Data<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span>,</span>
<span>                                    Solari_Output<span class="op">=</span><span class="va">S20.Rainfall.Solari</span>,</span>
<span>                                    Thres<span class="op">=</span><span class="va">S20.Rainfall.Solari</span><span class="op">$</span><span class="va">Candidate_Thres</span>,</span>
<span>                                    RP_Max<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-36-1.png" width="700"></p>
<p>Repeating the automated threshold selection procedure for O-sWL.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.OsWL.Solari</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/GPD_Threshold_Solari.html">GPD_Threshold_Solari</a></span><span class="op">(</span>Event<span class="op">=</span><span class="va">S20.OsWL.Declustered.SW</span><span class="op">$</span><span class="va">Declustered</span>,</span>
<span>                                      Data<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in solve.default(family$info(o)) : </span></span>
<span><span class="co">#&gt;   Lapack routine dgesv: system is exactly singular: U[2,2] = 0</span></span>
<span><span class="co">#&gt; Error in diag(o$cov) : invalid 'nrow' value (too large or NA)</span></span>
<span><span class="co">#&gt; Error in solve.default(family$info(o)) : </span></span>
<span><span class="co">#&gt;   Lapack routine dgesv: system is exactly singular: U[2,2] = 0</span></span>
<span><span class="co">#&gt; Error in diag(o$cov) : invalid 'nrow' value (too large or NA)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-37-1.png" width="700"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.OsWL.Solari</span><span class="op">$</span><span class="va">Candidate_Thres</span></span>
<span><span class="co">#&gt; [1] 2.032</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">OsWL.Thres.Quantile</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">)</span><span class="op">(</span><span class="va">S20.OsWL.Solari</span><span class="op">$</span><span class="va">Candidate_Thres</span><span class="op">)</span></span></code></pre></div>
<p>and checking the fit of the GPD at the selected threshold.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Solari.Sel</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/GPD_Threshold_Solari_Sel.html">GPD_Threshold_Solari_Sel</a></span><span class="op">(</span>Event<span class="op">=</span><span class="va">S20.OsWL.Declustered.SW</span><span class="op">$</span><span class="va">Declustered</span>,</span>
<span>                                     Data<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span>,</span>
<span>                                     Solari_Output<span class="op">=</span><span class="va">S20.OsWL.Solari</span>,</span>
<span>                                     Thres<span class="op">=</span><span class="va">S20.OsWL.Solari</span><span class="op">$</span><span class="va">Candidate_Thres</span>,</span>
<span>                                     RP_Max<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-40-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="correlation-analysis">3. Correlation analysis<a class="anchor" aria-label="anchor" href="#correlation-analysis"></a>
</h3>
<p>We can use the <code><a href="../reference/Kendall_Lag.html">Kendall_Lag()</a></code> function to view the
Kendall’s rank correlations coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
between the time series over a range of lags</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Kendall.Results</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Kendall_Lag.html">Kendall_Lag</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.df</span>,GAP<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-41-1.png" width="700"></p>
<p>Let’s pull out the Kendall correlation coefficient values between
rainfall and O-sWL for lags of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>5</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mn>0</mn><mo>,</mo><mi>.</mi><mi>.</mi><mo>,</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">−5, ..., 0, ..,5</annotation></semantics></math>
applied to the latter quantity</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Kendall.Results</span><span class="op">$</span><span class="va">Value</span><span class="op">$</span><span class="va">Rainfall_OsWL</span></span>
<span><span class="co">#&gt;  [1]  0.046483308  0.051860955  0.051392298  0.051311970  0.054097316</span></span>
<span><span class="co">#&gt;  [6]  0.058316831  0.061388245  0.035305812  0.004206059 -0.014356749</span></span>
<span><span class="co">#&gt; [11] -0.025993095 -0.030431776 -0.029481162</span></span></code></pre></div>
<p>and the corresponding p-values testing the null hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\tau=0</annotation></semantics></math></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Kendall.Results</span><span class="op">$</span><span class="va">Test</span><span class="op">$</span><span class="va">Rainfall_OsWL_Test</span></span>
<span><span class="co">#&gt;  [1] 5.819748e-13 1.014698e-15 8.196547e-16 1.030482e-15 5.160274e-17</span></span>
<span><span class="co">#&gt;  [6] 1.887733e-19 1.987221e-20 2.232548e-07 4.033739e-01 7.669577e-02</span></span>
<span><span class="co">#&gt; [11] 1.186248e-03 6.352872e-05 3.864403e-05</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bivariate-analysis">4. Bivariate Analysis<a class="anchor" aria-label="anchor" href="#bivariate-analysis"></a>
</h3>
<div class="section level5">
<h5 id="two-sided-conditional-sampling---copula-theory-method">Two-sided conditional sampling - copula theory method<a class="anchor" aria-label="anchor" href="#two-sided-conditional-sampling---copula-theory-method"></a>
</h5>
<p>In the report the 2D analysis considers the two forcings currently
accounted for in structural design assessments undertaken by SFWMD:
rainfall and O-sWL. The 2D analysis commences with the well-established
two-sided conditional sampling approach, where excesses of a
conditioning variable are paired with co-occurring values of another
variable to create two samples. For each sample the marginals (one
extreme, one non-extreme) and joint distribution are then modeled.</p>
<p>The two (conditional) joint distributions are modeled independently
of the marginals by using a copula. The
<code><a href="../reference/Copula_Threshold_2D.html">Copula_Threshold_2D()</a></code> function explores the sensitivity of
the best fitting copula, in terms of Akaike Information Criterion (AIC),
to allow the practitioner to make an informed choice with regards to
threshold selection. It undertakes the conditional sampling described
above and reports the best fitting bivariate copula. The procedure is
carried out for a single or range of thresholds specified by the
<code>u</code> argument and the procedure is automatically repeated with
the variables switched.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Copula_Threshold_2D.html">Copula_Threshold_2D</a></span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>Data_Declust<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>y_lim_min<span class="op">=</span><span class="op">-</span><span class="fl">0.075</span>, y_lim_max <span class="op">=</span><span class="fl">0.25</span>,</span>
<span>Upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">9</span><span class="op">)</span>, Lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">10</span><span class="op">)</span>,GAP<span class="op">=</span><span class="fl">0.15</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-44-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; $Kendalls_Tau1</span></span>
<span><span class="co">#&gt;  [1] 0.05627631 0.05803451 0.05900376 0.08072261 0.10731477 0.14151449</span></span>
<span><span class="co">#&gt;  [7] 0.14427232 0.14762199 0.13101587 0.05056147</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p_value_Var1</span></span>
<span><span class="co">#&gt;  [1] 7.698074e-03 9.251524e-03 1.424015e-02 1.974145e-03 1.559739e-04</span></span>
<span><span class="co">#&gt;  [6] 1.171141e-05 4.256557e-05 2.055448e-04 6.000832e-03 4.413023e-01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N_Var1</span></span>
<span><span class="co">#&gt;  [1] 1008  904  776  661  559  432  363  286  200  107</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Copula_Family_Var1</span></span>
<span><span class="co">#&gt;  [1]  6  6  6  6  6  6  6 13  6  6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Kendalls_Tau2</span></span>
<span><span class="co">#&gt;  [1] 0.1113049 0.1359921 0.1377104 0.1561184 0.1579352 0.1359861 0.1183870</span></span>
<span><span class="co">#&gt;  [8] 0.1463056 0.1482198 0.1904729</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p_value_Var2</span></span>
<span><span class="co">#&gt;  [1] 2.720713e-05 2.549673e-06 1.199322e-05 1.143046e-05 1.879301e-04</span></span>
<span><span class="co">#&gt;  [6] 1.335664e-02 5.199742e-02 3.145804e-02 6.891926e-02 8.220838e-02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N_Var2</span></span>
<span><span class="co">#&gt;  [1] 760 639 535 416 290 168 136 110  77  43</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Copula_Family_Var2</span></span>
<span><span class="co">#&gt;  [1]   6   6   6   6 204 204 204 204   1 204</span></span></code></pre>
<p>The <code><a href="../reference/Diag_Non_Con.html">Diag_Non_Con()</a></code> function is designed to aid in the
selection of the appropriate (non-extreme) unbounded marginal
distribution for the non-conditioned variable.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Rainfall</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Con_Sampling_2D.html">Con_Sampling_2D</a></span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>Data_Declust<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>Con_Variable<span class="op">=</span><span class="st">"Rainfall"</span>,u <span class="op">=</span> <span class="va">Rainfall.Thres.Quantile</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Diag_Non_Con.html">Diag_Non_Con</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Rainfall</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">OsWL</span>,Omit<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gum"</span>,<span class="st">"RGum"</span><span class="op">)</span>,x_lab<span class="op">=</span><span class="st">"O-sWL (ft NGVD 29)"</span>,y_lim_min<span class="op">=</span><span class="fl">0</span>,y_lim_max<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-45-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; $AIC</span></span>
<span><span class="co">#&gt;   Distribution      AIC</span></span>
<span><span class="co">#&gt; 1         Gaus 81.27871</span></span>
<span><span class="co">#&gt; 2          Gum       NA</span></span>
<span><span class="co">#&gt; 3         Lapl 92.82204</span></span>
<span><span class="co">#&gt; 4        Logis 84.19031</span></span>
<span><span class="co">#&gt; 5         RGum       NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Best_fit</span></span>
<span><span class="co">#&gt; [1] "Gaus"</span></span></code></pre>
<p>The <code><a href="../reference/Diag_Non_Con_Sel.html">Diag_Non_Con_Sel()</a></code> function, is similar to the
<code><a href="../reference/Diag_Non_Con.html">Diag_Non_Con()</a></code> command, but only plots the probability
density function and cumulative distribution function of a (single)
selected univariate distribution in order to more clearly demonstrate
the goodness of fit of a particular distribution. The options are the
Gaussian (<code>Gaus</code>), Gumbel (<code>Gum</code>), Laplace
(<code>Lapl</code>), logistic (<code>Logis</code>) and reverse Gumbel
(<code>RGum</code>) distributions.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Diag_Non_Con_Sel.html">Diag_Non_Con_Sel</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Rainfall</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">OsWL</span>,x_lab<span class="op">=</span><span class="st">"O-sWL (ft NGVD 29)"</span>,</span>
<span>y_lim_min<span class="op">=</span><span class="fl">0</span>,y_lim_max<span class="op">=</span><span class="fl">1.5</span>,Selected<span class="op">=</span><span class="st">"Logis"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-46-1.png" width="700"></p>
<p>A generalized Pareto distribution is fitted to the marginal
distribution of the conditioning variable i.e. the declustered excesses
identified using <code><a href="../reference/Con_Sampling_2D.html">Con_Sampling_2D()</a></code>.</p>
<p>The process of selecting a conditional sample and fitting marginal
distributions is repeated but instead conditioning on O-sWL. The
non-conditional variable in this case is (total daily) rainfall, which
has a lower bound at zero, and thus requires a suitably truncated
distribution. The <code>Diag_Non_Con_Trunc</code> fits a selection of
truncated distributions to a vector of data. The
<code>Diag_Non_Con_Sel_Trunc</code> function is analogous to the
<code>Diag_Non_Con_Sel</code> function, available distributions are the
Birnbaum-Saunders (<code>BS</code>), exponential (<code>Exp</code>),
gamma (<code>Gam(2)</code>), inverse Gaussian (<code>InvG</code>),
lognormal (<code>LogN</code>), Tweedie (<code>Twe</code>) and Weibull
(<code>Weib</code>). If the gamlss and gamlss.mx packages are loaded
then the three-parameter gamma (<code>Gam(3)</code>), two-parameter
mixed gamma (<code>GamMix(2)</code>) and three-parameter mixed gamma
(<code>GamMix(3)</code>) distributions are also tested.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.OsWL</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Con_Sampling_2D.html">Con_Sampling_2D</a></span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>Data_Declust<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>Con_Variable<span class="op">=</span><span class="st">"OsWL"</span>,u<span class="op">=</span><span class="va">OsWL.Thres.Quantile</span><span class="op">)</span></span>
<span><span class="va">S20.OsWL</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">&lt;-</span><span class="va">S20.OsWL</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S20.OsWL</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span>,<span class="fl">0.001</span>,<span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Diag_Non_Con_Trunc.html">Diag_Non_Con_Trunc</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.OsWL</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">+</span><span class="fl">0.001</span>,x_lab<span class="op">=</span><span class="st">"Rainfall (Inches)"</span>,</span>
<span>y_lim_min<span class="op">=</span><span class="fl">0</span>,y_lim_max<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-47-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; $AIC</span></span>
<span><span class="co">#&gt;   Distribution        AIC</span></span>
<span><span class="co">#&gt; 1           BS   2.058415</span></span>
<span><span class="co">#&gt; 2          Exp 109.079681</span></span>
<span><span class="co">#&gt; 3       Gam(2)  30.987116</span></span>
<span><span class="co">#&gt; 4       Gam(3)  31.072202</span></span>
<span><span class="co">#&gt; 5        LNorm  26.612261</span></span>
<span><span class="co">#&gt; 6        TNorm 216.413645</span></span>
<span><span class="co">#&gt; 7          Twe  25.866156</span></span>
<span><span class="co">#&gt; 8         Weib  28.999196</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Best_fit</span></span>
<span><span class="co">#&gt; [1] "BS"</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Diag_Non_Con_Trunc_Sel.html">Diag_Non_Con_Trunc_Sel</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.OsWL</span><span class="op">$</span><span class="va">Data</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">+</span><span class="fl">0.001</span>,x_lab<span class="op">=</span><span class="st">"Rainfall (Inches)"</span>,</span>
<span>y_lim_min<span class="op">=</span><span class="fl">0</span>,y_lim_max<span class="op">=</span><span class="fl">2</span>,</span>
<span>Selected<span class="op">=</span><span class="st">"BS"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-48-1.png" width="700"></p>
<p>The <code><a href="../reference/Design_Event_2D.html">Design_Event_2D()</a></code> function finds the isoline
associated with a particular return period, by overlaying the two
corresponding isolines from the joint distributions fitted to the
conditional samples using the method in Bender et al. (2016).
<code><a href="../reference/Design_Event_2D.html">Design_Event_2D()</a></code> requires the copulas families chosen to
model the dependence structure in the two conditional samples as
input.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Copula.Rainfall</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Copula_Threshold_2D.html">Copula_Threshold_2D</a></span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>Data_Declust<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>u1<span class="op">=</span><span class="va">Rainfall.Thres.Quantile</span>,u2<span class="op">=</span><span class="cn">NA</span>,</span>
<span>y_lim_min<span class="op">=</span><span class="fl">0</span>,y_lim_max<span class="op">=</span><span class="fl">0.25</span>, GAP<span class="op">=</span><span class="fl">0.075</span><span class="op">)</span><span class="op">$</span><span class="va">Copula_Family_Var1</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-49-1.png" width="700"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Copula.OsWL</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Copula_Threshold_2D.html">Copula_Threshold_2D</a></span><span class="op">(</span>Data_Detrend<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>Data_Declust<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>u1<span class="op">=</span><span class="cn">NA</span>,u2<span class="op">=</span><span class="va">OsWL.Thres.Quantile</span>,</span>
<span>y_lim_min<span class="op">=</span><span class="fl">0</span>,y_lim_max<span class="op">=</span><span class="fl">0.25</span>,GAP<span class="op">=</span><span class="fl">0.075</span><span class="op">)</span><span class="op">$</span><span class="va">Copula_Family_Var2</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-50-1.png" width="700"></p>
<p>As input the function requires</p>
<ul>
<li>
<code>Data</code> = Original (detrended) rainfall and O-sWL
series</li>
<li>
<code>Data_Con1</code>/<code>Data_Con2</code> = two conditionally
sampled data sets,</li>
<li>
<code>u1</code>/<code>u2</code> or
<code>Thres1</code>/<code>Thres2</code> = two thresholds associated with
the conditionally sampled data sets</li>
<li>
<code>Copula_Family1</code>/<code>Copula_Family2</code> two families
of the two fitted copulas</li>
<li>
<code>Marginal_Dist1</code>/<code>Marginal_Dist2</code>Selected
non-extreme marginal distributions</li>
<li>
<code>RP</code> = Return Period of interest</li>
<li>
<code>N</code> = size of the sample from the fitted joint
distributions used to estimate the density along the isoline of
interest</li>
<li>
<code>N_Ensemble</code> = size of the ensemble of events sampled
along the isoline of interest</li>
</ul>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Bivariate</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Design_Event_2D.html">Design_Event_2D</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>, </span>
<span>Data_Con1<span class="op">=</span><span class="va">S20.Rainfall</span><span class="op">$</span><span class="va">Data</span>, </span>
<span>Data_Con2<span class="op">=</span><span class="va">S20.OsWL</span><span class="op">$</span><span class="va">Data</span>, </span>
<span>u1<span class="op">=</span><span class="va">Rainfall.Thres.Quantile</span>, </span>
<span>u2<span class="op">=</span><span class="va">OsWL.Thres.Quantile</span>, </span>
<span>Copula_Family1<span class="op">=</span><span class="va">S20.Copula.Rainfall</span>,</span>
<span>Copula_Family2<span class="op">=</span><span class="va">S20.Copula.OsWL</span>, </span>
<span>Marginal_Dist1<span class="op">=</span><span class="st">"Logis"</span>, Marginal_Dist2<span class="op">=</span><span class="st">"BS"</span>,</span>
<span>x_lab<span class="op">=</span><span class="st">"Rainfall (Inches)"</span>,y_lab<span class="op">=</span><span class="st">"O-sWL (ft NGVD 29)"</span>,</span>
<span>RP<span class="op">=</span><span class="fl">100</span>,N<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">7</span>,N_Ensemble<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-51-1.png" width="700"></p>
<p>Design event according to the “Most likely” event approach (diamond
in the plot)</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Bivariate</span><span class="op">$</span><span class="va">MostLikelyEvent</span><span class="op">$</span><span class="va">`100`</span></span>
<span><span class="co">#&gt;    Rainfall     OsWL</span></span>
<span><span class="co">#&gt; 1 0.1508948 3.183035</span></span></code></pre></div>
<p>Design event under the assumption of full dependence (triangle in the
plot)</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Bivariate</span><span class="op">$</span><span class="va">FullDependence</span><span class="op">$</span><span class="va">`100`</span></span>
<span><span class="co">#&gt;   Rainfall OsWL</span></span>
<span><span class="co">#&gt; 1    14.56 3.31</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="cooley-2019-projection-method">Cooley (2019) projection method<a class="anchor" aria-label="anchor" href="#cooley-2019-projection-method"></a>
</h5>
<p><a href="https://doi.org/10.1007/s10687-019-00348-0" class="external-link">Cooley et
al. (2019)</a> puts forward a non-parametric approach for constructing
the isoline associated with exceedance probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>.
The approach centers around constructing a base isoline with a larger
exceedance probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>&lt;</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">p_{base} &lt; p</annotation></semantics></math>
and projecting it to more extreme levels.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><annotation encoding="application/x-tex">p_{base}</annotation></semantics></math>
should be small enough to be representative of the extremal dependence
but large enough for sufficient data to be involved in the estimation
procedure.</p>
<p>The approach begins by approximating the joint survival function via
a kernel density estimator from which the base isoline is derived. For
the marginal distributions, a GPD is fit above a sufficiently high
threshold to allow extrapolation into the tails and the empirical
distribution is used below the threshold. Unless the joint distribution
of the two variables is regularly varying, a marginal transformation is
required for the projection. The two marginals are thus transformed to
Frechet scales. For asymptotic dependence, on the transformed scale the
isoline with exceedance probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
can be obtained as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>T</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>s</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><msub><mi>l</mi><mi>T</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">l_{T}(p)=s^{−1}l_T(p_{base})</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msub><mi>p</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mi>p</mi></mfrac><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\frac{p_{base}}{p} &gt; 1</annotation></semantics></math>.
For the case of asymptotic independence,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>T</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>s</mi><mfrac><mn>1</mn><mi>η</mi></mfrac></msup><msub><mi>l</mi><mi>T</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">l_{T}(p)=s^{\frac{1}{\eta}}l_{T}(p_{base})</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>η</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
is the tail dependence coefficient. Applying the inverse Frechet
transformation gives the isoline on the original scale.</p>
<p>Let’s estimate the 100-year (p=0.01) rainfall-OsWL isoline at S20
using the 10-year isoline as the base isoline.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Fitting the marginal distribution</span></span>
<span><span class="co">#See next section for information on the Migpd_Fit function</span></span>
<span><span class="va">S20.GPD</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Migpd_Fit.html">Migpd_Fit</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, Data_Full <span class="op">=</span> <span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, </span>
<span>                   mqu <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.99</span>,<span class="fl">0.99</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#10-year exceedance probability for daily data</span></span>
<span><span class="va">p.10</span><span class="op">&lt;-</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">365.25</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span>
<span><span class="co">#10-year exceedance probability for daily data</span></span>
<span><span class="va">p.100</span><span class="op">&lt;-</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">365.25</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span><span class="co">#Calculating the isoline</span></span>
<span><span class="va">isoline</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Cooley19.html">Cooley19</a></span><span class="op">(</span>Data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,Migpd<span class="op">=</span><span class="va">S20.GPD</span>,</span>
<span>                  p.base<span class="op">=</span><span class="va">p.10</span>,p.proj<span class="op">=</span><span class="va">p.100</span>,PLOT<span class="op">=</span><span class="cn">TRUE</span>,x_lim_max_T<span class="op">=</span><span class="fl">15000</span>,y_lim_max_T<span class="op">=</span><span class="fl">15000</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-54-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="radial-based-isolines">Radial-based isolines<a class="anchor" aria-label="anchor" href="#radial-based-isolines"></a>
</h5>
<p>When the dependence structure between two variables differs
significantly across conditional samples — as captured by their
respective copulas — it can produce an inflection point in certain
regions of the probability space when overlaying the partial isolines.
While these effects are mathematically sound, they represent
methodological artifacts rather than natural phenomena, potentially
limiting the physical interpretability of results in these regions of
the joint distribution. <a href="https://doi.org/10.1002/env.2797" class="external-link">Murphy-Barltrop et
al. (2023)</a> proposed new estimation methods for bivariate isolines
that avoid fitting copulas while accounting for both asymptotic
independence (AI) and asymptotic dependence (AD). Their techniques
exploit existing bivariate extreme value models — specifically the <a href="https://doi.org/10.1111/j.1467-9868.2004.02050.x" class="external-link">Heffernan and
Tawn (2004)</a> <a href="#ht04">HT04</a> and <a href="https://doi.org/10.3150/12-BEJ471" class="external-link">Wadsworth and Tawn (2013)</a>
[WT13] approaches. An additional benefit of these new approaches is that
it is possible to derive confidence intervals that account for the
sampling uncertainty.</p>
<p>When employing the HT04 model to construct the isoline with
exceedance probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>,
the first step is to convert the variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(X,Y)</annotation></semantics></math>
to the Laplace scale
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>L</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>L</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(X_L,Y_L)</annotation></semantics></math>.
The HT04 model is a conditional exceedance model and is therefore fit
twice, conditioning on both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>L</mi></msub><annotation encoding="application/x-tex">X_L</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>L</mi></msub><annotation encoding="application/x-tex">Y_L</annotation></semantics></math>
separately, thus allowing us to estimate the curve in different regions.
In particular, we consider the regions defined by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><msub><mi>Y</mi><mi>L</mi></msub></msub><annotation encoding="application/x-tex">R_{Y_L}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>L</mi></msub><mo>&gt;</mo><msub><mi>x</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">y_L&gt;x_L</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><msub><mi>X</mi><mi>L</mi></msub></msub><annotation encoding="application/x-tex">R_{X_L}</annotation></semantics></math>
where $ y_{L} x_{L}$. For region
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><msub><mi>Y</mi><mi>L</mi></msub></msub><annotation encoding="application/x-tex">R_{Y_L}</annotation></semantics></math>,
we start by selecting a high threshold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><msub><mi>Y</mi><mi>L</mi></msub></msub><annotation encoding="application/x-tex">u_{Y_L}</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>L</mi></msub><mo>&gt;</mo><msub><mi>u</mi><msub><mi>Y</mi><mi>L</mi></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">P(Y_{L}&gt;u_{Y_L})&gt;p</annotation></semantics></math>
and fit the HT04 model to observations where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>L</mi></msub><mo>&gt;</mo><msub><mi>u</mi><msub><mi>Y</mi><mi>L</mi></msub></msub></mrow><annotation encoding="application/x-tex">y_L&gt;u_{Y_L}</annotation></semantics></math>.
Next, a decreasing series of thresholds is defined in the interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>u</mi><msub><mi>Y</mi><mi>L</mi></msub></msub><mo>,</mo><msubsup><mi>F</mi><msub><mi>Y</mi><mi>L</mi></msub><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(u_{Y_L},F^{-1}_{Y_L}(1-p))</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><msub><mi>Y</mi><mi>L</mi></msub></msub><annotation encoding="application/x-tex">u_{Y_L}</annotation></semantics></math>
is the minimal quantile for which the fitted model is valid and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><msub><mi>Y</mi><mi>L</mi></msub><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F^{-1}_{Y_{L}}(1-p)</annotation></semantics></math>
is the limit that values can attain on this curve. For a given quantile
in the interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>*</mo></mrow><annotation encoding="application/x-tex">y*</annotation></semantics></math>,
use the model to simulate from the conditional distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>L</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>Y</mi><mi>L</mi></msub><mo>&gt;</mo><mi>y</mi><mo>*</mo></mrow><annotation encoding="application/x-tex">X_{L} | Y_{L}&gt;y*</annotation></semantics></math>
and estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>*</mo></mrow><annotation encoding="application/x-tex">x*</annotation></semantics></math>
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mi>/</mi><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1-p/q)</annotation></semantics></math>th
quantile. Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>L</mi></msub><mo>&gt;</mo><mi>y</mi><mo>*</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">q=P(Y_L&gt;y*)</annotation></semantics></math>
and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>L</mi></msub><mo>&gt;</mo><mi>x</mi><mi>*</mi><mo>,</mo><msub><mi>Y</mi><mi>L</mi></msub><mo>&gt;</mo><mi>y</mi><mo>*</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>L</mi></msub><mo>&gt;</mo><mi>x</mi><mo>*</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>Y</mi><mi>L</mi></msub><mo>&gt;</mo><mi>y</mi><mo>*</mo><mo stretchy="true" form="postfix">)</mo></mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>L</mi></msub><mo>&gt;</mo><mi>y</mi><mo>*</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>p</mi><mi>/</mi><mi>q</mi><mo>×</mo><mi>q</mi><mo>=</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">P(X_L&gt;x* ,Y_L&gt;y*) = P(X_L&gt;x* | Y_L&gt;y*)P(Y_L&gt;y*) = p/q \times q = p</annotation></semantics></math>,
the point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mi>*</mi><mo>,</mo><mi>y</mi><mo>*</mo><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x*,y*)</annotation></semantics></math>
lies on the isoline. The process is repeated until a value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>*</mo><mi>*</mi></mrow><annotation encoding="application/x-tex">x**</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>*</mo><mi>*</mi><mo>≤</mo><mi>y</mi><mo>*</mo></mrow><annotation encoding="application/x-tex">x**\leq y*</annotation></semantics></math>
is obtained or we exhaust all values in the interval. A very similar
procedure is implemented for region
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><msub><mi>X</mi><mi>L</mi></msub></msub><annotation encoding="application/x-tex">R_{X_L}</annotation></semantics></math>,
this time selecting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><msub><mi>X</mi><mi>L</mi></msub></msub><annotation encoding="application/x-tex">u_{X_L}</annotation></semantics></math>,
a high quantile of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>L</mi></msub><annotation encoding="application/x-tex">X_L</annotation></semantics></math>
for quantiles in the interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>x</mi><mi>′</mi></msup><mo>*</mo><mi>*</mi><mo>,</mo><msubsup><mi>F</mi><msub><mi>X</mi><mi>L</mi></msub><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x^{'}**,F^{-1}_{X_L}(1-p))</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>x</mi><mi>′</mi></msup><mo>*</mo><mi>*</mi><mo>=</mo><mi>x</mi><mo>*</mo><mi>*</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x^{'}**=x**)</annotation></semantics></math>
if it exists and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><msub><mi>X</mi><mi>L</mi></msub></msub><annotation encoding="application/x-tex">u_{X_L}</annotation></semantics></math>
otherwise.</p>
<p>The WT13 model is defined in terms of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>w</mi></msub><mo>:=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">{</mo><mfrac><mi>X</mi><mi>w</mi></mfrac><mo>,</mo><mfrac><mi>Y</mi><mrow><mn>1</mn><mo>−</mo><mi>w</mi></mrow></mfrac><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">T_w := \min\left\{\frac{X}{w},\frac{Y}{1-w}\right\}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(X,Y)</annotation></semantics></math>
are a pair of variables with standard exponential marginal
distributions, for any ray in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math>,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>w</mi></msub><mo>&gt;</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≥</mo><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mn>1</mn><mo>−</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Pr(T_w &gt; t) = L(t|w) \exp(-\lambda(w)t), \quad \lambda(w) \geq \max(w,1-w)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>⋅</mi><mo stretchy="false" form="prefix">|</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L(\cdot|w)</annotation></semantics></math>
is slowly varying for each ray
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">w \in [0,1]</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda(w)</annotation></semantics></math>
is termed the angular dependence function. To find the isoline with
exceedance probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><msup><mi>p</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">p &lt; p^{\ast}</annotation></semantics></math>,
a set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>W</mi><annotation encoding="application/x-tex">W</annotation></semantics></math>
of equally spaced rays on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math>
is defined and for each ray estimating the angular dependence function
via the Hill estimator
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>λ</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\lambda}(w)</annotation></semantics></math>
using observations above the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">95\%</annotation></semantics></math>
quantile of the variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>w</mi></msub><annotation encoding="application/x-tex">T_w</annotation></semantics></math>.
For any large
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>,
WT13 states that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>w</mi></msub><mo>&gt;</mo><mi>t</mi><mo>+</mo><mi>u</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mi>w</mi></msub><mo>&gt;</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mi>t</mi><mover><mi>λ</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Pr(T_w &gt; t + u | T_w &gt; u) \approx \exp(-t\hat{\lambda}(w))</annotation></semantics></math>
for any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">w \in [0,1]</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t &gt; 0</annotation></semantics></math>.
If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>p</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">th</mtext></msup><annotation encoding="application/x-tex">(1-p^{\ast})^{\text{th}}</annotation></semantics></math>
quantile of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>w</mi></msub><annotation encoding="application/x-tex">T_w</annotation></semantics></math>
i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>w</mi></msub><mo>&gt;</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>p</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">\Pr(T_w &gt; u) = p^{\ast}</annotation></semantics></math>,
then
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>w</mi></msub><mo>&gt;</mo><mi>t</mi><mo>+</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>w</mi></msub><mo>&gt;</mo><mi>t</mi><mo>+</mo><mi>u</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mi>w</mi></msub><mo>&gt;</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>w</mi></msub><mo>&gt;</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>p</mi><mo>*</mo></msup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mi>t</mi><mover><mi>λ</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p=\Pr(T_w &gt; t + u) = \Pr(T_w &gt; t + u | T_w &gt; u)\Pr(T_w &gt; u) = p^{\ast}\exp(-t\hat{\lambda}(w))</annotation></semantics></math>.
Re-arranging for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
gives
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mi>−</mi><mfrac><mn>1</mn><mrow><mover><mi>λ</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>p</mi><msup><mi>p</mi><mo>*</mo></msup></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">t = -\frac{1}{\hat{\lambda}(w)}\log\left(\frac{p}{p^{\ast}}\right)</annotation></semantics></math>.
An estimate for the return curve with exceedance probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
is obtained by letting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(x,y) = (w(t+u),(1-w)(t+u))</annotation></semantics></math>.</p>
<p>The confidence intervals for isolines are estimated using a bootstrap
procedure following the methodology outlined in Murphy-Barltrop et
al. (2023). In the procedure a set of rays are defined at equally-spaced
angles within the interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>π</mi><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0,\pi/2)</annotation></semantics></math>.
Each ray intersects the isoline exactly once, and since the angle is
fixed, the L2 norm represents the radial distance to the intersection
point. Next, the observed data set is bootstrapped a large number of
times (e.g., 1000 iterations) to generate multiple samples of the same
size as the original data set. For each bootstrap sample, the L2 norm is
calculated for each ray’s intersection with the fitted isoline. The
confidence intervals are then derived by computing the relevant
percentiles (e.g., 2.5th and 97.5th percentiles for 95% confidence
intervals) of these L2 norms across all bootstrap iterations.</p>
<p>The <code>return_curve_est</code> function derives isolines for a
given <code>rp</code>. The quantiles <code>q</code> of the GPDs of the
HT04 and WT13 models must be specified along with the average occurrence
frequency of the events in the data <code>mu</code>. The methods for
declustering the time series and the associated parameters are also
required. The bootstrapping procedure for estimate the sampling
uncertainty can be carried out using a basic
(<code>boot_method = "basic"</code>), block
(<code>boot_method = "block"</code>) or monthly
(<code>boot_method = "month"</code>) bootstrap. The latter two are
recommend where there is a temporal dependence in the data. For the
basic bootstrap whether the sampling is carried out with
<code>boot_replace = T</code> or without <code>boot_replace = F</code>
replacement must be specified while the block bootstrap require
<code>"block_length"</code>. The number of number of rays along which to
compute points on the curve for each sample <code>n_grad</code> is
another input. For the relative likelihood of points on the isoline to
be estimated based on the observations set <code>most_likely =</code> T.
For the HT04 model the number of simulations <code>n_sim</code> is
required. The function is implemented to find the 100-year isoline at
S-22.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Adding dates to complete final month of combined records</span></span>
<span><span class="co">#S22.Detrend.df$Date&lt;-as.Date(as.character(S22.Detrend.df$Date), format = "%m/%d/%Y")</span></span>
<span><span class="va">final.month</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-02-04"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-02-28"</span><span class="op">)</span>,by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">final.month</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>,<span class="st">"Rainfall"</span>,<span class="st">"OsWL"</span>,<span class="st">"Groundwater"</span><span class="op">)</span></span>
<span><span class="va">S22.Detrend.df.extended</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">S22.Detrend.df</span>,<span class="va">final.month</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Derive return curves</span></span>
<span><span class="va">curve</span> <span class="op">=</span> <span class="fu"><a href="../reference/return_curve_est.html">return_curve_est</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">S22.Detrend.df.extended</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>                         q<span class="op">=</span><span class="fl">0.985</span>,rp<span class="op">=</span><span class="fl">100</span>,mu<span class="op">=</span><span class="fl">365.25</span>,n_sim<span class="op">=</span><span class="fl">100</span>,</span>
<span>                         n_grad<span class="op">=</span><span class="fl">50</span>,n_boot<span class="op">=</span><span class="fl">100</span>,boot_method<span class="op">=</span><span class="st">"monthly"</span>,</span>
<span>                         boot_replace<span class="op">=</span><span class="cn">NA</span>, block_length<span class="op">=</span><span class="cn">NA</span>, boot_prop<span class="op">=</span><span class="fl">0.8</span>,</span>
<span>                         decl_method_x<span class="op">=</span><span class="st">"runs"</span>, decl_method_y<span class="op">=</span><span class="st">"runs"</span>,</span>
<span>                         window_length_x<span class="op">=</span><span class="cn">NA</span>,window_length_y<span class="op">=</span><span class="cn">NA</span>,</span>
<span>                         u_x<span class="op">=</span><span class="fl">0.95</span>, u_y<span class="op">=</span><span class="fl">0.95</span>,</span>
<span>                         sep_crit_x<span class="op">=</span><span class="fl">36</span>, sep_crit_y<span class="op">=</span><span class="fl">36</span>,</span>
<span>                         most_likely<span class="op">=</span><span class="cn">T</span>, n_ensemble<span class="op">=</span><span class="fl">10</span>,</span>
<span>                         alpha<span class="op">=</span><span class="fl">0.1</span>, x_lab<span class="op">=</span><span class="cn">NA</span>, y_lab<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-55-1.png" width="700"></p>
<p>The first points on the median curve using the WT13 model are:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">curve</span><span class="op">$</span><span class="va">median_wt13</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Rainfall     OsWL</span></span>
<span><span class="co">#&gt; 1 0.2672374 9.694948</span></span>
<span><span class="co">#&gt; 2 0.2799752 9.684196</span></span>
<span><span class="co">#&gt; 3 0.2927129 9.673444</span></span>
<span><span class="co">#&gt; 4 0.3054506 9.662692</span></span>
<span><span class="co">#&gt; 5 0.3181883 9.651940</span></span>
<span><span class="co">#&gt; 6 0.3309260 9.641188</span></span></code></pre></div>
<p>and the corresponding elements of the upper and lower confident
bounds are:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">curve</span><span class="op">$</span><span class="va">ub_wt13</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Rainfall     OsWL</span></span>
<span><span class="co">#&gt; [1,] 0.6174237 21.06106</span></span>
<span><span class="co">#&gt; [2,] 0.8872747 15.40675</span></span>
<span><span class="co">#&gt; [3,] 1.1984116 13.95405</span></span>
<span><span class="co">#&gt; [4,] 1.4575731 12.79219</span></span>
<span><span class="co">#&gt; [5,] 1.6204284 11.46010</span></span>
<span><span class="co">#&gt; [6,] 1.7966694 10.63246</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">curve</span><span class="op">$</span><span class="va">lb_wt13</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Rainfall     OsWL</span></span>
<span><span class="co">#&gt; [1,] 0.1307650 5.265416</span></span>
<span><span class="co">#&gt; [2,] 0.2617785 5.265416</span></span>
<span><span class="co">#&gt; [3,] 0.3932909 5.265416</span></span>
<span><span class="co">#&gt; [4,] 0.5252973 5.263323</span></span>
<span><span class="co">#&gt; [5,] 0.6063044 4.927009</span></span>
<span><span class="co">#&gt; [6,] 0.7209362 4.877799</span></span></code></pre></div>
<p>Events estimated to possess a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>100</mn><annotation encoding="application/x-tex">100</annotation></semantics></math>-year
joint return period.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#"Most-likely" design event</span></span>
<span><span class="va">curve</span><span class="op">$</span><span class="va">most_likely_wt13</span></span>
<span><span class="co">#&gt;        Rainfall     OsWL</span></span>
<span><span class="co">#&gt; 1     0.2672374 9.694948</span></span>
<span><span class="co">#&gt; 2     0.2799752 9.684196</span></span>
<span><span class="co">#&gt; 3     0.2927129 9.673444</span></span>
<span><span class="co">#&gt; 4     0.3054506 9.662692</span></span>
<span><span class="co">#&gt; 5     0.3181883 9.651940</span></span>
<span><span class="co">#&gt; 6     0.3309260 9.641188</span></span>
<span><span class="co">#&gt; 7     0.3436637 9.630436</span></span>
<span><span class="co">#&gt; 8     0.3564014 9.619684</span></span>
<span><span class="co">#&gt; 9     0.3691391 9.608932</span></span>
<span><span class="co">#&gt; 10    0.3818768 9.598180</span></span>
<span><span class="co">#&gt; 11    0.3946146 9.587428</span></span>
<span><span class="co">#&gt; 12    0.4073523 9.576675</span></span>
<span><span class="co">#&gt; 13    0.4200900 9.565923</span></span>
<span><span class="co">#&gt; 14    0.4328277 9.555171</span></span>
<span><span class="co">#&gt; 15    0.4455654 9.544419</span></span>
<span><span class="co">#&gt; 16    0.4583031 9.533667</span></span>
<span><span class="co">#&gt; 17    0.4710408 9.522915</span></span>
<span><span class="co">#&gt; 18    0.4837785 9.512163</span></span>
<span><span class="co">#&gt; 19    0.4965162 9.501411</span></span>
<span><span class="co">#&gt; 20    0.5092540 9.490659</span></span>
<span><span class="co">#&gt; 21    0.5217634 9.479869</span></span>
<span><span class="co">#&gt; 22    0.5232648 9.467223</span></span>
<span><span class="co">#&gt; 23    0.5247661 9.454576</span></span>
<span><span class="co">#&gt; 24    0.5262674 9.441930</span></span>
<span><span class="co">#&gt; 25    0.5277688 9.429284</span></span>
<span><span class="co">#&gt; 26    0.5292701 9.416638</span></span>
<span><span class="co">#&gt; 27    0.5307715 9.403992</span></span>
<span><span class="co">#&gt; 28    0.5322728 9.391346</span></span>
<span><span class="co">#&gt; 29    0.5337741 9.378700</span></span>
<span><span class="co">#&gt; 30    0.5352755 9.366054</span></span>
<span><span class="co">#&gt; 31    0.5367768 9.353408</span></span>
<span><span class="co">#&gt; 32    0.5382782 9.340761</span></span>
<span><span class="co">#&gt; 33    0.5397795 9.328115</span></span>
<span><span class="co">#&gt; 34    0.5412808 9.315469</span></span>
<span><span class="co">#&gt; 35    0.5427822 9.302823</span></span>
<span><span class="co">#&gt; 36    0.5442835 9.290177</span></span>
<span><span class="co">#&gt; 37    0.5457849 9.277531</span></span>
<span><span class="co">#&gt; 38    0.5472862 9.264885</span></span>
<span><span class="co">#&gt; 39    0.5487875 9.252239</span></span>
<span><span class="co">#&gt; 40    0.5502889 9.239592</span></span>
<span><span class="co">#&gt; 41    0.5517902 9.226946</span></span>
<span><span class="co">#&gt; 42    0.5532916 9.214300</span></span>
<span><span class="co">#&gt; 43    0.5547929 9.201654</span></span>
<span><span class="co">#&gt; 44    0.5562942 9.189008</span></span>
<span><span class="co">#&gt; 45    0.5577956 9.176362</span></span>
<span><span class="co">#&gt; 46    0.5592969 9.163716</span></span>
<span><span class="co">#&gt; 47    0.5607983 9.151070</span></span>
<span><span class="co">#&gt; 48    0.5622996 9.138423</span></span>
<span><span class="co">#&gt; 49    0.5638009 9.125777</span></span>
<span><span class="co">#&gt; 50    0.5653023 9.113131</span></span>
<span><span class="co">#&gt; 51    0.5668036 9.100485</span></span>
<span><span class="co">#&gt; 52    0.5683050 9.087839</span></span>
<span><span class="co">#&gt; 53    0.5698063 9.075193</span></span>
<span><span class="co">#&gt; 54    0.5713076 9.062547</span></span>
<span><span class="co">#&gt; 55    0.5728090 9.049901</span></span>
<span><span class="co">#&gt; 56    0.5743103 9.037254</span></span>
<span><span class="co">#&gt; 57    0.5758116 9.024608</span></span>
<span><span class="co">#&gt; 58    0.5773130 9.011962</span></span>
<span><span class="co">#&gt; 59    0.5788143 8.999316</span></span>
<span><span class="co">#&gt; 60    0.5803157 8.986670</span></span>
<span><span class="co">#&gt; 61    0.5818170 8.974024</span></span>
<span><span class="co">#&gt; 62    0.5833183 8.961378</span></span>
<span><span class="co">#&gt; 63    0.5848197 8.948732</span></span>
<span><span class="co">#&gt; 64    0.5863210 8.936085</span></span>
<span><span class="co">#&gt; 65    0.5878224 8.923439</span></span>
<span><span class="co">#&gt; 66    0.5893237 8.910793</span></span>
<span><span class="co">#&gt; 67    0.5908250 8.898147</span></span>
<span><span class="co">#&gt; 68    0.5923264 8.885501</span></span>
<span><span class="co">#&gt; 69    0.5938277 8.872855</span></span>
<span><span class="co">#&gt; 70    0.5953291 8.860209</span></span>
<span><span class="co">#&gt; 71    0.5968304 8.847563</span></span>
<span><span class="co">#&gt; 72    0.5983317 8.834916</span></span>
<span><span class="co">#&gt; 73    0.5998331 8.822270</span></span>
<span><span class="co">#&gt; 74    0.6013344 8.809624</span></span>
<span><span class="co">#&gt; 75    0.6028358 8.796978</span></span>
<span><span class="co">#&gt; 76    0.6043371 8.784332</span></span>
<span><span class="co">#&gt; 77    0.6058384 8.771686</span></span>
<span><span class="co">#&gt; 78    0.6073398 8.759040</span></span>
<span><span class="co">#&gt; 79    0.6088411 8.746394</span></span>
<span><span class="co">#&gt; 80    0.6103425 8.733747</span></span>
<span><span class="co">#&gt; 81    0.6118438 8.721101</span></span>
<span><span class="co">#&gt; 82    0.6133451 8.708455</span></span>
<span><span class="co">#&gt; 83    0.6148465 8.695809</span></span>
<span><span class="co">#&gt; 84    0.6163478 8.683163</span></span>
<span><span class="co">#&gt; 85    0.6178492 8.670517</span></span>
<span><span class="co">#&gt; 86    0.6193505 8.657871</span></span>
<span><span class="co">#&gt; 87    0.6208518 8.645225</span></span>
<span><span class="co">#&gt; 88    0.6223532 8.632578</span></span>
<span><span class="co">#&gt; 89    0.6238545 8.619932</span></span>
<span><span class="co">#&gt; 90    0.6253559 8.607286</span></span>
<span><span class="co">#&gt; 91    0.6268572 8.594640</span></span>
<span><span class="co">#&gt; 92    0.6283585 8.581994</span></span>
<span><span class="co">#&gt; 93    0.6298599 8.569348</span></span>
<span><span class="co">#&gt; 94    0.6313612 8.556702</span></span>
<span><span class="co">#&gt; 95    0.6328626 8.544056</span></span>
<span><span class="co">#&gt; 96    0.6343639 8.531410</span></span>
<span><span class="co">#&gt; 97    0.6358652 8.518763</span></span>
<span><span class="co">#&gt; 98    0.6373666 8.506117</span></span>
<span><span class="co">#&gt; 99    0.6388679 8.493471</span></span>
<span><span class="co">#&gt; 100   0.6403692 8.480825</span></span>
<span><span class="co">#&gt; 101   0.6418706 8.468179</span></span>
<span><span class="co">#&gt; 102   0.6433719 8.455533</span></span>
<span><span class="co">#&gt; 103   0.6448733 8.442887</span></span>
<span><span class="co">#&gt; 104   0.6463746 8.430241</span></span>
<span><span class="co">#&gt; 105   0.6478759 8.417594</span></span>
<span><span class="co">#&gt; 106   0.6493773 8.404948</span></span>
<span><span class="co">#&gt; 107   0.6508786 8.392302</span></span>
<span><span class="co">#&gt; 108   0.6523800 8.379656</span></span>
<span><span class="co">#&gt; 109   0.6538813 8.367010</span></span>
<span><span class="co">#&gt; 110   0.6553826 8.354364</span></span>
<span><span class="co">#&gt; 111   0.6568840 8.341718</span></span>
<span><span class="co">#&gt; 112   0.6583853 8.329072</span></span>
<span><span class="co">#&gt; 113   0.6598867 8.316425</span></span>
<span><span class="co">#&gt; 114   0.6613880 8.303779</span></span>
<span><span class="co">#&gt; 115   0.6628893 8.291133</span></span>
<span><span class="co">#&gt; 116   0.6643907 8.278487</span></span>
<span><span class="co">#&gt; 117   0.6658920 8.265841</span></span>
<span><span class="co">#&gt; 118   0.6673934 8.253195</span></span>
<span><span class="co">#&gt; 119   0.6688947 8.240549</span></span>
<span><span class="co">#&gt; 120   0.6722271 8.228001</span></span>
<span><span class="co">#&gt; 121   0.6756180 8.215457</span></span>
<span><span class="co">#&gt; 122   0.6790090 8.202912</span></span>
<span><span class="co">#&gt; 123   0.6823999 8.190368</span></span>
<span><span class="co">#&gt; 124   0.6857908 8.177823</span></span>
<span><span class="co">#&gt; 125   0.6891818 8.165279</span></span>
<span><span class="co">#&gt; 126   0.6925727 8.152734</span></span>
<span><span class="co">#&gt; 127   0.6959637 8.140190</span></span>
<span><span class="co">#&gt; 128   0.6993546 8.127645</span></span>
<span><span class="co">#&gt; 129   0.7027456 8.115101</span></span>
<span><span class="co">#&gt; 130   0.7061365 8.102556</span></span>
<span><span class="co">#&gt; 131   0.7095274 8.090012</span></span>
<span><span class="co">#&gt; 132   0.7129184 8.077467</span></span>
<span><span class="co">#&gt; 133   0.7163093 8.064923</span></span>
<span><span class="co">#&gt; 134   0.7197003 8.052378</span></span>
<span><span class="co">#&gt; 135   0.7230912 8.039834</span></span>
<span><span class="co">#&gt; 136   0.7264822 8.027290</span></span>
<span><span class="co">#&gt; 137   0.7298731 8.014745</span></span>
<span><span class="co">#&gt; 138   0.7332640 8.002201</span></span>
<span><span class="co">#&gt; 139   0.7366550 7.989656</span></span>
<span><span class="co">#&gt; 140   0.7400459 7.977112</span></span>
<span><span class="co">#&gt; 141   0.7434369 7.964567</span></span>
<span><span class="co">#&gt; 142   0.7468278 7.952023</span></span>
<span><span class="co">#&gt; 143   0.7502188 7.939478</span></span>
<span><span class="co">#&gt; 144   0.7536097 7.926934</span></span>
<span><span class="co">#&gt; 145   0.7570006 7.914389</span></span>
<span><span class="co">#&gt; 146   0.7603916 7.901845</span></span>
<span><span class="co">#&gt; 147   0.7637825 7.889300</span></span>
<span><span class="co">#&gt; 148   0.7671735 7.876756</span></span>
<span><span class="co">#&gt; 149   0.7705644 7.864211</span></span>
<span><span class="co">#&gt; 150   0.7739554 7.851667</span></span>
<span><span class="co">#&gt; 151   0.7773463 7.839122</span></span>
<span><span class="co">#&gt; 152   0.7807372 7.826578</span></span>
<span><span class="co">#&gt; 153   0.7841282 7.814034</span></span>
<span><span class="co">#&gt; 154   0.7875191 7.801489</span></span>
<span><span class="co">#&gt; 155   0.7909101 7.788945</span></span>
<span><span class="co">#&gt; 156   0.7943010 7.776400</span></span>
<span><span class="co">#&gt; 157   0.7976920 7.763856</span></span>
<span><span class="co">#&gt; 158   0.8010829 7.751311</span></span>
<span><span class="co">#&gt; 159   0.8044738 7.738767</span></span>
<span><span class="co">#&gt; 160   0.8078648 7.726222</span></span>
<span><span class="co">#&gt; 161   0.8112557 7.713678</span></span>
<span><span class="co">#&gt; 162   0.8146467 7.701133</span></span>
<span><span class="co">#&gt; 163   0.8180376 7.688589</span></span>
<span><span class="co">#&gt; 164   0.8214286 7.676044</span></span>
<span><span class="co">#&gt; 165   0.8286519 7.664171</span></span>
<span><span class="co">#&gt; 166   0.8402245 7.653060</span></span>
<span><span class="co">#&gt; 167   0.8517970 7.641950</span></span>
<span><span class="co">#&gt; 168   0.8633696 7.630839</span></span>
<span><span class="co">#&gt; 169   0.8749422 7.619728</span></span>
<span><span class="co">#&gt; 170   0.8865147 7.608617</span></span>
<span><span class="co">#&gt; 171   0.8980873 7.597506</span></span>
<span><span class="co">#&gt; 172   0.9096599 7.586395</span></span>
<span><span class="co">#&gt; 173   0.9212324 7.575284</span></span>
<span><span class="co">#&gt; 174   0.9328050 7.564173</span></span>
<span><span class="co">#&gt; 175   0.9443775 7.553062</span></span>
<span><span class="co">#&gt; 176   0.9559501 7.541951</span></span>
<span><span class="co">#&gt; 177   0.9675227 7.530841</span></span>
<span><span class="co">#&gt; 178   0.9790952 7.519730</span></span>
<span><span class="co">#&gt; 179   0.9906678 7.508619</span></span>
<span><span class="co">#&gt; 180   1.0022403 7.497508</span></span>
<span><span class="co">#&gt; 181   1.0087456 7.485409</span></span>
<span><span class="co">#&gt; 182   1.0137237 7.473012</span></span>
<span><span class="co">#&gt; 183   1.0187019 7.460615</span></span>
<span><span class="co">#&gt; 184   1.0236800 7.448218</span></span>
<span><span class="co">#&gt; 185   1.0286582 7.435821</span></span>
<span><span class="co">#&gt; 186   1.0336363 7.423424</span></span>
<span><span class="co">#&gt; 187   1.0386145 7.411027</span></span>
<span><span class="co">#&gt; 188   1.0435926 7.398630</span></span>
<span><span class="co">#&gt; 189   1.0485708 7.386233</span></span>
<span><span class="co">#&gt; 190   1.0535489 7.373836</span></span>
<span><span class="co">#&gt; 191   1.0585270 7.361439</span></span>
<span><span class="co">#&gt; 192   1.0635052 7.349042</span></span>
<span><span class="co">#&gt; 193   1.0684833 7.336645</span></span>
<span><span class="co">#&gt; 194   1.0734615 7.324248</span></span>
<span><span class="co">#&gt; 195   1.0784396 7.311851</span></span>
<span><span class="co">#&gt; 196   1.0834178 7.299455</span></span>
<span><span class="co">#&gt; 197   1.0883959 7.287058</span></span>
<span><span class="co">#&gt; 198   1.0933741 7.274661</span></span>
<span><span class="co">#&gt; 199   1.0983522 7.262264</span></span>
<span><span class="co">#&gt; 200   1.1033304 7.249867</span></span>
<span><span class="co">#&gt; 201   1.1083085 7.237470</span></span>
<span><span class="co">#&gt; 202   1.1132866 7.225073</span></span>
<span><span class="co">#&gt; 203   1.1182648 7.212676</span></span>
<span><span class="co">#&gt; 204   1.1232429 7.200279</span></span>
<span><span class="co">#&gt; 205   1.1282211 7.187882</span></span>
<span><span class="co">#&gt; 206   1.1331992 7.175485</span></span>
<span><span class="co">#&gt; 207   1.1381774 7.163088</span></span>
<span><span class="co">#&gt; 208   1.1431555 7.150691</span></span>
<span><span class="co">#&gt; 209   1.1478900 7.138268</span></span>
<span><span class="co">#&gt; 210   1.1524849 7.125830</span></span>
<span><span class="co">#&gt; 211   1.1570798 7.113393</span></span>
<span><span class="co">#&gt; 212   1.1616747 7.100955</span></span>
<span><span class="co">#&gt; 213   1.1662696 7.088517</span></span>
<span><span class="co">#&gt; 214   1.1708645 7.076079</span></span>
<span><span class="co">#&gt; 215   1.1754594 7.063641</span></span>
<span><span class="co">#&gt; 216   1.1800543 7.051203</span></span>
<span><span class="co">#&gt; 217   1.1846492 7.038765</span></span>
<span><span class="co">#&gt; 218   1.1892441 7.026327</span></span>
<span><span class="co">#&gt; 219   1.1938390 7.013890</span></span>
<span><span class="co">#&gt; 220   1.1984339 7.001452</span></span>
<span><span class="co">#&gt; 221   1.2030288 6.989014</span></span>
<span><span class="co">#&gt; 222   1.2076237 6.976576</span></span>
<span><span class="co">#&gt; 223   1.2122186 6.964138</span></span>
<span><span class="co">#&gt; 224   1.2168135 6.951700</span></span>
<span><span class="co">#&gt; 225   1.2214084 6.939262</span></span>
<span><span class="co">#&gt; 226   1.2260033 6.926825</span></span>
<span><span class="co">#&gt; 227   1.2305982 6.914387</span></span>
<span><span class="co">#&gt; 228   1.2351931 6.901949</span></span>
<span><span class="co">#&gt; 229   1.2397880 6.889511</span></span>
<span><span class="co">#&gt; 230   1.2443829 6.877073</span></span>
<span><span class="co">#&gt; 231   1.2489778 6.864635</span></span>
<span><span class="co">#&gt; 232   1.2535727 6.852197</span></span>
<span><span class="co">#&gt; 233   1.2581676 6.839759</span></span>
<span><span class="co">#&gt; 234   1.2627625 6.827322</span></span>
<span><span class="co">#&gt; 235   1.2673574 6.814884</span></span>
<span><span class="co">#&gt; 236   1.2741139 6.802737</span></span>
<span><span class="co">#&gt; 237   1.2814248 6.790664</span></span>
<span><span class="co">#&gt; 238   1.2887357 6.778592</span></span>
<span><span class="co">#&gt; 239   1.2960467 6.766519</span></span>
<span><span class="co">#&gt; 240   1.3033576 6.754447</span></span>
<span><span class="co">#&gt; 241   1.3106685 6.742375</span></span>
<span><span class="co">#&gt; 242   1.3179794 6.730302</span></span>
<span><span class="co">#&gt; 243   1.3252903 6.718230</span></span>
<span><span class="co">#&gt; 244   1.3326013 6.706157</span></span>
<span><span class="co">#&gt; 245   1.3399122 6.694085</span></span>
<span><span class="co">#&gt; 246   1.3472231 6.682012</span></span>
<span><span class="co">#&gt; 247   1.3545340 6.669940</span></span>
<span><span class="co">#&gt; 248   1.3618449 6.657868</span></span>
<span><span class="co">#&gt; 249   1.3691559 6.645795</span></span>
<span><span class="co">#&gt; 250   1.3764668 6.633723</span></span>
<span><span class="co">#&gt; 251   1.3837777 6.621650</span></span>
<span><span class="co">#&gt; 252   1.3910886 6.609578</span></span>
<span><span class="co">#&gt; 253   1.3983996 6.597506</span></span>
<span><span class="co">#&gt; 254   1.4084669 6.586068</span></span>
<span><span class="co">#&gt; 255   1.4203542 6.575049</span></span>
<span><span class="co">#&gt; 256   1.4322415 6.564031</span></span>
<span><span class="co">#&gt; 257   1.4441288 6.553012</span></span>
<span><span class="co">#&gt; 258   1.4560161 6.541994</span></span>
<span><span class="co">#&gt; 259   1.4679033 6.530975</span></span>
<span><span class="co">#&gt; 260   1.4797906 6.519957</span></span>
<span><span class="co">#&gt; 261   1.4916779 6.508939</span></span>
<span><span class="co">#&gt; 262   1.5035652 6.497920</span></span>
<span><span class="co">#&gt; 263   1.5154525 6.486902</span></span>
<span><span class="co">#&gt; 264   1.5273398 6.475883</span></span>
<span><span class="co">#&gt; 265   1.5392271 6.464865</span></span>
<span><span class="co">#&gt; 266   1.5530762 6.454649</span></span>
<span><span class="co">#&gt; 267   1.5704477 6.445877</span></span>
<span><span class="co">#&gt; 268   1.5878192 6.437104</span></span>
<span><span class="co">#&gt; 269   1.6051908 6.428332</span></span>
<span><span class="co">#&gt; 270   1.6225623 6.419559</span></span>
<span><span class="co">#&gt; 271   1.6399339 6.410786</span></span>
<span><span class="co">#&gt; 272   1.6573054 6.402014</span></span>
<span><span class="co">#&gt; 273   1.6746769 6.393241</span></span>
<span><span class="co">#&gt; 274   1.6920485 6.384468</span></span>
<span><span class="co">#&gt; 275   1.7080041 6.375094</span></span>
<span><span class="co">#&gt; 276   1.7206259 6.364305</span></span>
<span><span class="co">#&gt; 277   1.7332477 6.353515</span></span>
<span><span class="co">#&gt; 278   1.7458695 6.342725</span></span>
<span><span class="co">#&gt; 279   1.7584913 6.331935</span></span>
<span><span class="co">#&gt; 280   1.7711131 6.321145</span></span>
<span><span class="co">#&gt; 281   1.7837349 6.310355</span></span>
<span><span class="co">#&gt; 282   1.7963567 6.299566</span></span>
<span><span class="co">#&gt; 283   1.8089785 6.288776</span></span>
<span><span class="co">#&gt; 284   1.8216003 6.277986</span></span>
<span><span class="co">#&gt; 285   1.8342221 6.267196</span></span>
<span><span class="co">#&gt; 286   1.8463829 6.256285</span></span>
<span><span class="co">#&gt; 287   1.8552267 6.244500</span></span>
<span><span class="co">#&gt; 288   1.8640706 6.232715</span></span>
<span><span class="co">#&gt; 289   1.8729144 6.220930</span></span>
<span><span class="co">#&gt; 290   1.8817582 6.209145</span></span>
<span><span class="co">#&gt; 291   1.8906020 6.197360</span></span>
<span><span class="co">#&gt; 292   1.8994459 6.185575</span></span>
<span><span class="co">#&gt; 293   1.9082897 6.173791</span></span>
<span><span class="co">#&gt; 294   1.9171335 6.162006</span></span>
<span><span class="co">#&gt; 295   1.9259773 6.150221</span></span>
<span><span class="co">#&gt; 296   1.9348212 6.138436</span></span>
<span><span class="co">#&gt; 297   1.9436650 6.126651</span></span>
<span><span class="co">#&gt; 298   1.9525088 6.114866</span></span>
<span><span class="co">#&gt; 299   1.9613526 6.103081</span></span>
<span><span class="co">#&gt; 300   1.9723390 6.091896</span></span>
<span><span class="co">#&gt; 301   1.9859680 6.081451</span></span>
<span><span class="co">#&gt; 302   1.9995971 6.071006</span></span>
<span><span class="co">#&gt; 303   2.0132261 6.060561</span></span>
<span><span class="co">#&gt; 304   2.0268551 6.050117</span></span>
<span><span class="co">#&gt; 305   2.0404842 6.039672</span></span>
<span><span class="co">#&gt; 306   2.0541132 6.029227</span></span>
<span><span class="co">#&gt; 307   2.0677422 6.018782</span></span>
<span><span class="co">#&gt; 308   2.0813712 6.008337</span></span>
<span><span class="co">#&gt; 309   2.0950003 5.997892</span></span>
<span><span class="co">#&gt; 310   2.1118826 5.989643</span></span>
<span><span class="co">#&gt; 311   2.1344521 5.985233</span></span>
<span><span class="co">#&gt; 312   2.1570216 5.980822</span></span>
<span><span class="co">#&gt; 313   2.1795911 5.976412</span></span>
<span><span class="co">#&gt; 314   2.2021606 5.972002</span></span>
<span><span class="co">#&gt; 315   2.2247302 5.967591</span></span>
<span><span class="co">#&gt; 316   2.2472997 5.963181</span></span>
<span><span class="co">#&gt; 317   2.2698692 5.958771</span></span>
<span><span class="co">#&gt; 318   2.2887985 5.951017</span></span>
<span><span class="co">#&gt; 319   2.3074394 5.942998</span></span>
<span><span class="co">#&gt; 320   2.3260804 5.934980</span></span>
<span><span class="co">#&gt; 321   2.3447213 5.926961</span></span>
<span><span class="co">#&gt; 322   2.3633623 5.918943</span></span>
<span><span class="co">#&gt; 323   2.3820032 5.910924</span></span>
<span><span class="co">#&gt; 324   2.4006442 5.902906</span></span>
<span><span class="co">#&gt; 325   2.4192851 5.894887</span></span>
<span><span class="co">#&gt; 326   2.4399750 5.888567</span></span>
<span><span class="co">#&gt; 327   2.4616920 5.883098</span></span>
<span><span class="co">#&gt; 328   2.4834090 5.877629</span></span>
<span><span class="co">#&gt; 329   2.5051260 5.872160</span></span>
<span><span class="co">#&gt; 330   2.5268430 5.866691</span></span>
<span><span class="co">#&gt; 331   2.5485600 5.861223</span></span>
<span><span class="co">#&gt; 332   2.5702770 5.855754</span></span>
<span><span class="co">#&gt; 333   2.5919939 5.850285</span></span>
<span><span class="co">#&gt; 334   2.6067521 5.840360</span></span>
<span><span class="co">#&gt; 335   2.6211520 5.830205</span></span>
<span><span class="co">#&gt; 336   2.6355520 5.820051</span></span>
<span><span class="co">#&gt; 337   2.6499519 5.809897</span></span>
<span><span class="co">#&gt; 338   2.6643519 5.799742</span></span>
<span><span class="co">#&gt; 339   2.6787519 5.789588</span></span>
<span><span class="co">#&gt; 340   2.6931518 5.779434</span></span>
<span><span class="co">#&gt; 341   2.7075518 5.769279</span></span>
<span><span class="co">#&gt; 342   2.7219517 5.759125</span></span>
<span><span class="co">#&gt; 343   2.7376862 5.749633</span></span>
<span><span class="co">#&gt; 344   2.7561029 5.741472</span></span>
<span><span class="co">#&gt; 345   2.7745195 5.733311</span></span>
<span><span class="co">#&gt; 346   2.7929362 5.725150</span></span>
<span><span class="co">#&gt; 347   2.8113529 5.716990</span></span>
<span><span class="co">#&gt; 348   2.8297695 5.708829</span></span>
<span><span class="co">#&gt; 349   2.8481862 5.700668</span></span>
<span><span class="co">#&gt; 350   2.8666028 5.692507</span></span>
<span><span class="co">#&gt; 351   2.8850195 5.684346</span></span>
<span><span class="co">#&gt; 352   2.9065366 5.678753</span></span>
<span><span class="co">#&gt; 353   2.9283939 5.673441</span></span>
<span><span class="co">#&gt; 354   2.9502513 5.668129</span></span>
<span><span class="co">#&gt; 355   2.9721087 5.662818</span></span>
<span><span class="co">#&gt; 356   2.9939661 5.657506</span></span>
<span><span class="co">#&gt; 357   3.0158235 5.652194</span></span>
<span><span class="co">#&gt; 358   3.0376809 5.646883</span></span>
<span><span class="co">#&gt; 359   3.0595383 5.641571</span></span>
<span><span class="co">#&gt; 360   3.0826139 5.638001</span></span>
<span><span class="co">#&gt; 361   3.1057981 5.634586</span></span>
<span><span class="co">#&gt; 362   3.1289822 5.631171</span></span>
<span><span class="co">#&gt; 363   3.1521664 5.627756</span></span>
<span><span class="co">#&gt; 364   3.1753505 5.624341</span></span>
<span><span class="co">#&gt; 365   3.1985347 5.620926</span></span>
<span><span class="co">#&gt; 366   3.2217188 5.617511</span></span>
<span><span class="co">#&gt; 367   3.2449030 5.614097</span></span>
<span><span class="co">#&gt; 368   3.2669378 5.609088</span></span>
<span><span class="co">#&gt; 369   3.2885903 5.603548</span></span>
<span><span class="co">#&gt; 370   3.3102429 5.598009</span></span>
<span><span class="co">#&gt; 371   3.3318954 5.592470</span></span>
<span><span class="co">#&gt; 372   3.3535480 5.586931</span></span>
<span><span class="co">#&gt; 373   3.3752005 5.581391</span></span>
<span><span class="co">#&gt; 374   3.3968531 5.575852</span></span>
<span><span class="co">#&gt; 375   3.4185056 5.570313</span></span>
<span><span class="co">#&gt; 376   3.4400020 5.564613</span></span>
<span><span class="co">#&gt; 377   3.4612040 5.558610</span></span>
<span><span class="co">#&gt; 378   3.4824061 5.552608</span></span>
<span><span class="co">#&gt; 379   3.5036082 5.546605</span></span>
<span><span class="co">#&gt; 380   3.5248103 5.540603</span></span>
<span><span class="co">#&gt; 381   3.5460124 5.534600</span></span>
<span><span class="co">#&gt; 382   3.5672144 5.528598</span></span>
<span><span class="co">#&gt; 383   3.5884165 5.522595</span></span>
<span><span class="co">#&gt; 384   3.6096186 5.516592</span></span>
<span><span class="co">#&gt; 385   3.6275690 5.508355</span></span>
<span><span class="co">#&gt; 386   3.6441115 5.499149</span></span>
<span><span class="co">#&gt; 387   3.6606540 5.489943</span></span>
<span><span class="co">#&gt; 388   3.6771965 5.480737</span></span>
<span><span class="co">#&gt; 389   3.6937390 5.471531</span></span>
<span><span class="co">#&gt; 390   3.7102815 5.462325</span></span>
<span><span class="co">#&gt; 391   3.7268239 5.453120</span></span>
<span><span class="co">#&gt; 392   3.7433664 5.443914</span></span>
<span><span class="co">#&gt; 393   3.7599089 5.434708</span></span>
<span><span class="co">#&gt; 394   3.7764946 5.425524</span></span>
<span><span class="co">#&gt; 395   3.7933867 5.416496</span></span>
<span><span class="co">#&gt; 396   3.8102789 5.407467</span></span>
<span><span class="co">#&gt; 397   3.8271710 5.398439</span></span>
<span><span class="co">#&gt; 398   3.8440631 5.389411</span></span>
<span><span class="co">#&gt; 399   3.8609552 5.380383</span></span>
<span><span class="co">#&gt; 400   3.8778474 5.371355</span></span>
<span><span class="co">#&gt; 401   3.8947395 5.362326</span></span>
<span><span class="co">#&gt; 402   3.9116316 5.353298</span></span>
<span><span class="co">#&gt; 403   3.9285237 5.344270</span></span>
<span><span class="co">#&gt; 404   3.9445305 5.334826</span></span>
<span><span class="co">#&gt; 405   3.9596553 5.324968</span></span>
<span><span class="co">#&gt; 406   3.9747800 5.315109</span></span>
<span><span class="co">#&gt; 407   3.9899048 5.305251</span></span>
<span><span class="co">#&gt; 408   4.0050295 5.295393</span></span>
<span><span class="co">#&gt; 409   4.0201542 5.285535</span></span>
<span><span class="co">#&gt; 410   4.0352790 5.275677</span></span>
<span><span class="co">#&gt; 411   4.0504037 5.265819</span></span>
<span><span class="co">#&gt; 412   4.0655285 5.255960</span></span>
<span><span class="co">#&gt; 413   4.0806532 5.246102</span></span>
<span><span class="co">#&gt; 414   4.0987149 5.238806</span></span>
<span><span class="co">#&gt; 415   4.1223376 5.236362</span></span>
<span><span class="co">#&gt; 416   4.1459602 5.233917</span></span>
<span><span class="co">#&gt; 417   4.1695829 5.231473</span></span>
<span><span class="co">#&gt; 418   4.1932056 5.229028</span></span>
<span><span class="co">#&gt; 419   4.2168283 5.226584</span></span>
<span><span class="co">#&gt; 420   4.2404509 5.224139</span></span>
<span><span class="co">#&gt; 421   4.2640736 5.221695</span></span>
<span><span class="co">#&gt; 422   4.2876963 5.219250</span></span>
<span><span class="co">#&gt; 423   4.3113190 5.216806</span></span>
<span><span class="co">#&gt; 424   4.3349539 5.214395</span></span>
<span><span class="co">#&gt; 425   4.3586072 5.212033</span></span>
<span><span class="co">#&gt; 426   4.3822604 5.209672</span></span>
<span><span class="co">#&gt; 427   4.4059137 5.207311</span></span>
<span><span class="co">#&gt; 428   4.4295669 5.204950</span></span>
<span><span class="co">#&gt; 429   4.4532202 5.202588</span></span>
<span><span class="co">#&gt; 430   4.4768734 5.200227</span></span>
<span><span class="co">#&gt; 431   4.5005267 5.197866</span></span>
<span><span class="co">#&gt; 432   4.5241800 5.195505</span></span>
<span><span class="co">#&gt; 433   4.5478332 5.193144</span></span>
<span><span class="co">#&gt; 434   4.5714865 5.190782</span></span>
<span><span class="co">#&gt; 435   4.5846291 5.180611</span></span>
<span><span class="co">#&gt; 436   4.5967122 5.169651</span></span>
<span><span class="co">#&gt; 437   4.6087954 5.158692</span></span>
<span><span class="co">#&gt; 438   4.6208785 5.147733</span></span>
<span><span class="co">#&gt; 439   4.6329616 5.136773</span></span>
<span><span class="co">#&gt; 440   4.6450447 5.125814</span></span>
<span><span class="co">#&gt; 441   4.6571278 5.114855</span></span>
<span><span class="co">#&gt; 442   4.6692109 5.103895</span></span>
<span><span class="co">#&gt; 443   4.6812941 5.092936</span></span>
<span><span class="co">#&gt; 444   4.6933772 5.081977</span></span>
<span><span class="co">#&gt; 445   4.7054603 5.071017</span></span>
<span><span class="co">#&gt; 446   4.7174771 5.060038</span></span>
<span><span class="co">#&gt; 447   4.7290582 5.048930</span></span>
<span><span class="co">#&gt; 448   4.7406394 5.037821</span></span>
<span><span class="co">#&gt; 449   4.7522205 5.026713</span></span>
<span><span class="co">#&gt; 450   4.7638017 5.015605</span></span>
<span><span class="co">#&gt; 451   4.7753829 5.004496</span></span>
<span><span class="co">#&gt; 452   4.7869640 4.993388</span></span>
<span><span class="co">#&gt; 453   4.7985452 4.982279</span></span>
<span><span class="co">#&gt; 454   4.8101263 4.971171</span></span>
<span><span class="co">#&gt; 455   4.8217075 4.960063</span></span>
<span><span class="co">#&gt; 456   4.8332887 4.948954</span></span>
<span><span class="co">#&gt; 457   4.8448698 4.937846</span></span>
<span><span class="co">#&gt; 458   4.8566106 4.926787</span></span>
<span><span class="co">#&gt; 459   4.8695703 4.916109</span></span>
<span><span class="co">#&gt; 460   4.8825299 4.905430</span></span>
<span><span class="co">#&gt; 461   4.8954896 4.894752</span></span>
<span><span class="co">#&gt; 462   4.9084493 4.884074</span></span>
<span><span class="co">#&gt; 463   4.9214090 4.873396</span></span>
<span><span class="co">#&gt; 464   4.9343686 4.862717</span></span>
<span><span class="co">#&gt; 465   4.9473283 4.852039</span></span>
<span><span class="co">#&gt; 466   4.9602880 4.841361</span></span>
<span><span class="co">#&gt; 467   4.9732476 4.830682</span></span>
<span><span class="co">#&gt; 468   4.9862073 4.820004</span></span>
<span><span class="co">#&gt; 469   4.9991670 4.809326</span></span>
<span><span class="co">#&gt; 470   5.0145084 4.799829</span></span>
<span><span class="co">#&gt; 471   5.0339966 4.792389</span></span>
<span><span class="co">#&gt; 472   5.0534848 4.784950</span></span>
<span><span class="co">#&gt; 473   5.0729730 4.777510</span></span>
<span><span class="co">#&gt; 474   5.0924613 4.770070</span></span>
<span><span class="co">#&gt; 475   5.1119495 4.762631</span></span>
<span><span class="co">#&gt; 476   5.1314377 4.755191</span></span>
<span><span class="co">#&gt; 477   5.1509259 4.747752</span></span>
<span><span class="co">#&gt; 478   5.1704141 4.740312</span></span>
<span><span class="co">#&gt; 479   5.1899023 4.732872</span></span>
<span><span class="co">#&gt; 480   5.2093906 4.725433</span></span>
<span><span class="co">#&gt; 481   5.2290661 4.718139</span></span>
<span><span class="co">#&gt; 482   5.2494217 4.711373</span></span>
<span><span class="co">#&gt; 483   5.2697774 4.704607</span></span>
<span><span class="co">#&gt; 484   5.2901331 4.697842</span></span>
<span><span class="co">#&gt; 485   5.3104888 4.691076</span></span>
<span><span class="co">#&gt; 486   5.3308445 4.684311</span></span>
<span><span class="co">#&gt; 487   5.3512001 4.677545</span></span>
<span><span class="co">#&gt; 488   5.3715558 4.670779</span></span>
<span><span class="co">#&gt; 489   5.3919115 4.664014</span></span>
<span><span class="co">#&gt; 490   5.4122672 4.657248</span></span>
<span><span class="co">#&gt; 491   5.4326228 4.650482</span></span>
<span><span class="co">#&gt; 492   5.4529785 4.643717</span></span>
<span><span class="co">#&gt; 493   5.4722121 4.636151</span></span>
<span><span class="co">#&gt; 494   5.4904909 4.627905</span></span>
<span><span class="co">#&gt; 495   5.5087697 4.619659</span></span>
<span><span class="co">#&gt; 496   5.5270485 4.611412</span></span>
<span><span class="co">#&gt; 497   5.5453273 4.603166</span></span>
<span><span class="co">#&gt; 498   5.5636061 4.594920</span></span>
<span><span class="co">#&gt; 499   5.5818849 4.586674</span></span>
<span><span class="co">#&gt; 500   5.6001637 4.578428</span></span>
<span><span class="co">#&gt; 501   5.6184425 4.570181</span></span>
<span><span class="co">#&gt; 502   5.6367213 4.561935</span></span>
<span><span class="co">#&gt; 503   5.6550001 4.553689</span></span>
<span><span class="co">#&gt; 504   5.6732789 4.545443</span></span>
<span><span class="co">#&gt; 505   5.6903941 4.536592</span></span>
<span><span class="co">#&gt; 506   5.7058266 4.526867</span></span>
<span><span class="co">#&gt; 507   5.7212591 4.517142</span></span>
<span><span class="co">#&gt; 508   5.7366916 4.507417</span></span>
<span><span class="co">#&gt; 509   5.7521242 4.497691</span></span>
<span><span class="co">#&gt; 510   5.7675567 4.487966</span></span>
<span><span class="co">#&gt; 511   5.7829892 4.478241</span></span>
<span><span class="co">#&gt; 512   5.7984217 4.468516</span></span>
<span><span class="co">#&gt; 513   5.8138542 4.458791</span></span>
<span><span class="co">#&gt; 514   5.8292867 4.449066</span></span>
<span><span class="co">#&gt; 515   5.8447192 4.439341</span></span>
<span><span class="co">#&gt; 516   5.8601518 4.429615</span></span>
<span><span class="co">#&gt; 517   5.8755843 4.419890</span></span>
<span><span class="co">#&gt; 518   5.8929449 4.411174</span></span>
<span><span class="co">#&gt; 519   5.9113356 4.402997</span></span>
<span><span class="co">#&gt; 520   5.9297264 4.394820</span></span>
<span><span class="co">#&gt; 521   5.9481171 4.386643</span></span>
<span><span class="co">#&gt; 522   5.9665079 4.378466</span></span>
<span><span class="co">#&gt; 523   5.9848986 4.370289</span></span>
<span><span class="co">#&gt; 524   6.0032893 4.362112</span></span>
<span><span class="co">#&gt; 525   6.0216801 4.353935</span></span>
<span><span class="co">#&gt; 526   6.0400708 4.345758</span></span>
<span><span class="co">#&gt; 527   6.0584616 4.337581</span></span>
<span><span class="co">#&gt; 528   6.0768523 4.329404</span></span>
<span><span class="co">#&gt; 529   6.0952431 4.321228</span></span>
<span><span class="co">#&gt; 530   6.1136338 4.313051</span></span>
<span><span class="co">#&gt; 531   6.1321554 4.304956</span></span>
<span><span class="co">#&gt; 532   6.1508061 4.296944</span></span>
<span><span class="co">#&gt; 533   6.1694568 4.288932</span></span>
<span><span class="co">#&gt; 534   6.1881075 4.280920</span></span>
<span><span class="co">#&gt; 535   6.2067582 4.272908</span></span>
<span><span class="co">#&gt; 536   6.2254089 4.264895</span></span>
<span><span class="co">#&gt; 537   6.2440596 4.256883</span></span>
<span><span class="co">#&gt; 538   6.2627103 4.248871</span></span>
<span><span class="co">#&gt; 539   6.2813610 4.240859</span></span>
<span><span class="co">#&gt; 540   6.3000117 4.232847</span></span>
<span><span class="co">#&gt; 541   6.3186624 4.224834</span></span>
<span><span class="co">#&gt; 542   6.3373131 4.216822</span></span>
<span><span class="co">#&gt; 543   6.3559638 4.208810</span></span>
<span><span class="co">#&gt; 544   6.3746146 4.200798</span></span>
<span><span class="co">#&gt; 545   6.3912168 4.191682</span></span>
<span><span class="co">#&gt; 546   6.4068678 4.182054</span></span>
<span><span class="co">#&gt; 547   6.4225188 4.172426</span></span>
<span><span class="co">#&gt; 548   6.4381698 4.162798</span></span>
<span><span class="co">#&gt; 549   6.4538208 4.153170</span></span>
<span><span class="co">#&gt; 550   6.4694718 4.143542</span></span>
<span><span class="co">#&gt; 551   6.4851228 4.133915</span></span>
<span><span class="co">#&gt; 552   6.5007738 4.124287</span></span>
<span><span class="co">#&gt; 553   6.5164248 4.114659</span></span>
<span><span class="co">#&gt; 554   6.5320758 4.105031</span></span>
<span><span class="co">#&gt; 555   6.5477268 4.095403</span></span>
<span><span class="co">#&gt; 556   6.5633778 4.085775</span></span>
<span><span class="co">#&gt; 557   6.5790288 4.076147</span></span>
<span><span class="co">#&gt; 558   6.5946798 4.066519</span></span>
<span><span class="co">#&gt; 559   6.6126813 4.058739</span></span>
<span><span class="co">#&gt; 560   6.6355575 4.054790</span></span>
<span><span class="co">#&gt; 561   6.6584337 4.050842</span></span>
<span><span class="co">#&gt; 562   6.6813099 4.046893</span></span>
<span><span class="co">#&gt; 563   6.7041861 4.042945</span></span>
<span><span class="co">#&gt; 564   6.7270622 4.038996</span></span>
<span><span class="co">#&gt; 565   6.7499384 4.035048</span></span>
<span><span class="co">#&gt; 566   6.7728146 4.031099</span></span>
<span><span class="co">#&gt; 567   6.7956908 4.027151</span></span>
<span><span class="co">#&gt; 568   6.8185670 4.023202</span></span>
<span><span class="co">#&gt; 569   6.8414431 4.019254</span></span>
<span><span class="co">#&gt; 570   6.8643193 4.015305</span></span>
<span><span class="co">#&gt; 571   6.8871955 4.011357</span></span>
<span><span class="co">#&gt; 572   6.9100717 4.007408</span></span>
<span><span class="co">#&gt; 573   6.9329479 4.003460</span></span>
<span><span class="co">#&gt; 574   6.9558240 3.999511</span></span>
<span><span class="co">#&gt; 575   6.9787002 3.995563</span></span>
<span><span class="co">#&gt; 576   7.0015764 3.991614</span></span>
<span><span class="co">#&gt; 577   7.0231987 3.986271</span></span>
<span><span class="co">#&gt; 578   7.0435088 3.979467</span></span>
<span><span class="co">#&gt; 579   7.0638189 3.972664</span></span>
<span><span class="co">#&gt; 580   7.0841290 3.965860</span></span>
<span><span class="co">#&gt; 581   7.1044391 3.959057</span></span>
<span><span class="co">#&gt; 582   7.1247492 3.952253</span></span>
<span><span class="co">#&gt; 583   7.1450593 3.945450</span></span>
<span><span class="co">#&gt; 584   7.1653694 3.938646</span></span>
<span><span class="co">#&gt; 585   7.1856795 3.931843</span></span>
<span><span class="co">#&gt; 586   7.2059896 3.925039</span></span>
<span><span class="co">#&gt; 587   7.2262997 3.918236</span></span>
<span><span class="co">#&gt; 588   7.2466098 3.911432</span></span>
<span><span class="co">#&gt; 589   7.2669199 3.904629</span></span>
<span><span class="co">#&gt; 590   7.2872301 3.897825</span></span>
<span><span class="co">#&gt; 591   7.3075402 3.891022</span></span>
<span><span class="co">#&gt; 592   7.3278503 3.884219</span></span>
<span><span class="co">#&gt; 593   7.3481604 3.877415</span></span>
<span><span class="co">#&gt; 594   7.3676275 3.870028</span></span>
<span><span class="co">#&gt; 595   7.3855029 3.861541</span></span>
<span><span class="co">#&gt; 596   7.4033784 3.853053</span></span>
<span><span class="co">#&gt; 597   7.4212539 3.844566</span></span>
<span><span class="co">#&gt; 598   7.4391293 3.836078</span></span>
<span><span class="co">#&gt; 599   7.4570048 3.827591</span></span>
<span><span class="co">#&gt; 600   7.4748802 3.819103</span></span>
<span><span class="co">#&gt; 601   7.4927557 3.810615</span></span>
<span><span class="co">#&gt; 602   7.5106311 3.802128</span></span>
<span><span class="co">#&gt; 603   7.5285066 3.793640</span></span>
<span><span class="co">#&gt; 604   7.5463821 3.785153</span></span>
<span><span class="co">#&gt; 605   7.5642575 3.776665</span></span>
<span><span class="co">#&gt; 606   7.5821330 3.768177</span></span>
<span><span class="co">#&gt; 607   7.6000084 3.759690</span></span>
<span><span class="co">#&gt; 608   7.6178839 3.751202</span></span>
<span><span class="co">#&gt; 609   7.6357593 3.742715</span></span>
<span><span class="co">#&gt; 610   7.6536348 3.734227</span></span>
<span><span class="co">#&gt; 611   7.6715102 3.725739</span></span>
<span><span class="co">#&gt; 612   7.6908548 3.718206</span></span>
<span><span class="co">#&gt; 613   7.7103376 3.710763</span></span>
<span><span class="co">#&gt; 614   7.7298205 3.703319</span></span>
<span><span class="co">#&gt; 615   7.7493034 3.695876</span></span>
<span><span class="co">#&gt; 616   7.7687862 3.688432</span></span>
<span><span class="co">#&gt; 617   7.7882691 3.680989</span></span>
<span><span class="co">#&gt; 618   7.8077519 3.673545</span></span>
<span><span class="co">#&gt; 619   7.8272348 3.666102</span></span>
<span><span class="co">#&gt; 620   7.8467177 3.658658</span></span>
<span><span class="co">#&gt; 621   7.8662005 3.651215</span></span>
<span><span class="co">#&gt; 622   7.8856834 3.643771</span></span>
<span><span class="co">#&gt; 623   7.9051663 3.636328</span></span>
<span><span class="co">#&gt; 624   7.9246491 3.628884</span></span>
<span><span class="co">#&gt; 625   7.9441320 3.621441</span></span>
<span><span class="co">#&gt; 626   7.9636148 3.613997</span></span>
<span><span class="co">#&gt; 627   7.9830977 3.606554</span></span>
<span><span class="co">#&gt; 628   8.0025806 3.599110</span></span>
<span><span class="co">#&gt; 629   8.0220634 3.591667</span></span>
<span><span class="co">#&gt; 630   8.0415463 3.584223</span></span>
<span><span class="co">#&gt; 631   8.0622836 3.577856</span></span>
<span><span class="co">#&gt; 632   8.0837223 3.572091</span></span>
<span><span class="co">#&gt; 633   8.1051611 3.566326</span></span>
<span><span class="co">#&gt; 634   8.1265998 3.560561</span></span>
<span><span class="co">#&gt; 635   8.1480385 3.554796</span></span>
<span><span class="co">#&gt; 636   8.1694773 3.549031</span></span>
<span><span class="co">#&gt; 637   8.1909160 3.543266</span></span>
<span><span class="co">#&gt; 638   8.2123547 3.537501</span></span>
<span><span class="co">#&gt; 639   8.2337935 3.531736</span></span>
<span><span class="co">#&gt; 640   8.2552322 3.525971</span></span>
<span><span class="co">#&gt; 641   8.2766709 3.520206</span></span>
<span><span class="co">#&gt; 642   8.2981097 3.514441</span></span>
<span><span class="co">#&gt; 643   8.3195484 3.508676</span></span>
<span><span class="co">#&gt; 644   8.3409871 3.502911</span></span>
<span><span class="co">#&gt; 645   8.3624259 3.497146</span></span>
<span><span class="co">#&gt; 646   8.3838646 3.491381</span></span>
<span><span class="co">#&gt; 647   8.4053033 3.485616</span></span>
<span><span class="co">#&gt; 648   8.4267421 3.479851</span></span>
<span><span class="co">#&gt; 649   8.4481808 3.474086</span></span>
<span><span class="co">#&gt; 650   8.4696195 3.468321</span></span>
<span><span class="co">#&gt; 651   8.4910583 3.462556</span></span>
<span><span class="co">#&gt; 652   8.5124970 3.456791</span></span>
<span><span class="co">#&gt; 653   8.5339358 3.451026</span></span>
<span><span class="co">#&gt; 654   8.5569956 3.447531</span></span>
<span><span class="co">#&gt; 655   8.5803416 3.444436</span></span>
<span><span class="co">#&gt; 656   8.6036877 3.441342</span></span>
<span><span class="co">#&gt; 657   8.6270337 3.438248</span></span>
<span><span class="co">#&gt; 658   8.6503798 3.435154</span></span>
<span><span class="co">#&gt; 659   8.6737259 3.432059</span></span>
<span><span class="co">#&gt; 660   8.6970719 3.428965</span></span>
<span><span class="co">#&gt; 661   8.7204180 3.425871</span></span>
<span><span class="co">#&gt; 662   8.7437641 3.422777</span></span>
<span><span class="co">#&gt; 663   8.7671101 3.419682</span></span>
<span><span class="co">#&gt; 664   8.7904562 3.416588</span></span>
<span><span class="co">#&gt; 665   8.8138023 3.413494</span></span>
<span><span class="co">#&gt; 666   8.8371483 3.410400</span></span>
<span><span class="co">#&gt; 667   8.8604944 3.407305</span></span>
<span><span class="co">#&gt; 668   8.8838405 3.404211</span></span>
<span><span class="co">#&gt; 669   8.9071865 3.401117</span></span>
<span><span class="co">#&gt; 670   8.9305326 3.398022</span></span>
<span><span class="co">#&gt; 671   8.9538787 3.394928</span></span>
<span><span class="co">#&gt; 672   8.9772247 3.391834</span></span>
<span><span class="co">#&gt; 673   9.0005708 3.388740</span></span>
<span><span class="co">#&gt; 674   9.0239168 3.385645</span></span>
<span><span class="co">#&gt; 675   9.0472629 3.382551</span></span>
<span><span class="co">#&gt; 676   9.0706090 3.379457</span></span>
<span><span class="co">#&gt; 677   9.0939550 3.376363</span></span>
<span><span class="co">#&gt; 678   9.1173011 3.373268</span></span>
<span><span class="co">#&gt; 679   9.1406472 3.370174</span></span>
<span><span class="co">#&gt; 680   9.1639932 3.367080</span></span>
<span><span class="co">#&gt; 681   9.1873393 3.363986</span></span>
<span><span class="co">#&gt; 682   9.2106854 3.360891</span></span>
<span><span class="co">#&gt; 683   9.2340314 3.357797</span></span>
<span><span class="co">#&gt; 684   9.2573775 3.354703</span></span>
<span><span class="co">#&gt; 685   9.2807997 3.351780</span></span>
<span><span class="co">#&gt; 686   9.3043293 3.349098</span></span>
<span><span class="co">#&gt; 687   9.3278590 3.346416</span></span>
<span><span class="co">#&gt; 688   9.3513886 3.343735</span></span>
<span><span class="co">#&gt; 689   9.3749182 3.341053</span></span>
<span><span class="co">#&gt; 690   9.3984479 3.338372</span></span>
<span><span class="co">#&gt; 691   9.4219775 3.335690</span></span>
<span><span class="co">#&gt; 692   9.4455071 3.333009</span></span>
<span><span class="co">#&gt; 693   9.4690368 3.330327</span></span>
<span><span class="co">#&gt; 694   9.4925664 3.327645</span></span>
<span><span class="co">#&gt; 695   9.5160960 3.324964</span></span>
<span><span class="co">#&gt; 696   9.5396257 3.322282</span></span>
<span><span class="co">#&gt; 697   9.5631553 3.319601</span></span>
<span><span class="co">#&gt; 698   9.5866850 3.316919</span></span>
<span><span class="co">#&gt; 699   9.6102146 3.314237</span></span>
<span><span class="co">#&gt; 700   9.6337442 3.311556</span></span>
<span><span class="co">#&gt; 701   9.6572739 3.308874</span></span>
<span><span class="co">#&gt; 702   9.6808035 3.306193</span></span>
<span><span class="co">#&gt; 703   9.7043331 3.303511</span></span>
<span><span class="co">#&gt; 704   9.7278628 3.300830</span></span>
<span><span class="co">#&gt; 705   9.7513924 3.298148</span></span>
<span><span class="co">#&gt; 706   9.7749220 3.295466</span></span>
<span><span class="co">#&gt; 707   9.7984517 3.292785</span></span>
<span><span class="co">#&gt; 708   9.8219813 3.290103</span></span>
<span><span class="co">#&gt; 709   9.8455110 3.287422</span></span>
<span><span class="co">#&gt; 710   9.8690406 3.284740</span></span>
<span><span class="co">#&gt; 711   9.8925702 3.282058</span></span>
<span><span class="co">#&gt; 712   9.9160999 3.279377</span></span>
<span><span class="co">#&gt; 713   9.9396295 3.276695</span></span>
<span><span class="co">#&gt; 714   9.9631591 3.274014</span></span>
<span><span class="co">#&gt; 715   9.9866888 3.271332</span></span>
<span><span class="co">#&gt; 716  10.0102184 3.268650</span></span>
<span><span class="co">#&gt; 717  10.0337481 3.265969</span></span>
<span><span class="co">#&gt; 718  10.0572777 3.263287</span></span>
<span><span class="co">#&gt; 719  10.0808073 3.260606</span></span>
<span><span class="co">#&gt; 720  10.1043370 3.257924</span></span>
<span><span class="co">#&gt; 721  10.1278666 3.255243</span></span>
<span><span class="co">#&gt; 722  10.1513962 3.252561</span></span>
<span><span class="co">#&gt; 723  10.1749259 3.249879</span></span>
<span><span class="co">#&gt; 724  10.1977529 3.245866</span></span>
<span><span class="co">#&gt; 725  10.2205416 3.241780</span></span>
<span><span class="co">#&gt; 726  10.2433303 3.237693</span></span>
<span><span class="co">#&gt; 727  10.2661190 3.233607</span></span>
<span><span class="co">#&gt; 728  10.2889076 3.229521</span></span>
<span><span class="co">#&gt; 729  10.3116963 3.225435</span></span>
<span><span class="co">#&gt; 730  10.3344850 3.221348</span></span>
<span><span class="co">#&gt; 731  10.3572737 3.217262</span></span>
<span><span class="co">#&gt; 732  10.3800624 3.213176</span></span>
<span><span class="co">#&gt; 733  10.4028511 3.209090</span></span>
<span><span class="co">#&gt; 734  10.4256398 3.205004</span></span>
<span><span class="co">#&gt; 735  10.4484285 3.200917</span></span>
<span><span class="co">#&gt; 736  10.4712172 3.196831</span></span>
<span><span class="co">#&gt; 737  10.4940059 3.192745</span></span>
<span><span class="co">#&gt; 738  10.5167945 3.188659</span></span>
<span><span class="co">#&gt; 739  10.5395832 3.184572</span></span>
<span><span class="co">#&gt; 740  10.5623719 3.180486</span></span>
<span><span class="co">#&gt; 741  10.5851606 3.176400</span></span>
<span><span class="co">#&gt; 742  10.6079493 3.172314</span></span>
<span><span class="co">#&gt; 743  10.6307380 3.168227</span></span>
<span><span class="co">#&gt; 744  10.6535267 3.164141</span></span>
<span><span class="co">#&gt; 745  10.6763154 3.160055</span></span>
<span><span class="co">#&gt; 746  10.6991041 3.155969</span></span>
<span><span class="co">#&gt; 747  10.7218928 3.151883</span></span>
<span><span class="co">#&gt; 748  10.7446814 3.147796</span></span>
<span><span class="co">#&gt; 749  10.7674701 3.143710</span></span>
<span><span class="co">#&gt; 750  10.7902588 3.139624</span></span>
<span><span class="co">#&gt; 751  10.8130475 3.135538</span></span>
<span><span class="co">#&gt; 752  10.8358362 3.131451</span></span>
<span><span class="co">#&gt; 753  10.8586249 3.127365</span></span>
<span><span class="co">#&gt; 754  10.8814136 3.123279</span></span>
<span><span class="co">#&gt; 755  10.9042023 3.119193</span></span>
<span><span class="co">#&gt; 756  10.9269910 3.115106</span></span>
<span><span class="co">#&gt; 757  10.9497797 3.111020</span></span>
<span><span class="co">#&gt; 758  10.9725683 3.106934</span></span>
<span><span class="co">#&gt; 759  10.9953570 3.102848</span></span>
<span><span class="co">#&gt; 760  11.0181457 3.098762</span></span>
<span><span class="co">#&gt; 761  11.0409344 3.094675</span></span>
<span><span class="co">#&gt; 762  11.0637231 3.090589</span></span>
<span><span class="co">#&gt; 763  11.0864247 3.086371</span></span>
<span><span class="co">#&gt; 764  11.1091104 3.082129</span></span>
<span><span class="co">#&gt; 765  11.1317960 3.077887</span></span>
<span><span class="co">#&gt; 766  11.1544817 3.073645</span></span>
<span><span class="co">#&gt; 767  11.1771674 3.069403</span></span>
<span><span class="co">#&gt; 768  11.1998530 3.065161</span></span>
<span><span class="co">#&gt; 769  11.2225387 3.060919</span></span>
<span><span class="co">#&gt; 770  11.2452244 3.056677</span></span>
<span><span class="co">#&gt; 771  11.2679100 3.052435</span></span>
<span><span class="co">#&gt; 772  11.2905957 3.048193</span></span>
<span><span class="co">#&gt; 773  11.3132814 3.043951</span></span>
<span><span class="co">#&gt; 774  11.3359670 3.039709</span></span>
<span><span class="co">#&gt; 775  11.3586527 3.035467</span></span>
<span><span class="co">#&gt; 776  11.3813384 3.031224</span></span>
<span><span class="co">#&gt; 777  11.4040241 3.026982</span></span>
<span><span class="co">#&gt; 778  11.4267097 3.022740</span></span>
<span><span class="co">#&gt; 779  11.4493954 3.018498</span></span>
<span><span class="co">#&gt; 780  11.4720811 3.014256</span></span>
<span><span class="co">#&gt; 781  11.4947667 3.010014</span></span>
<span><span class="co">#&gt; 782  11.5174524 3.005772</span></span>
<span><span class="co">#&gt; 783  11.5401381 3.001530</span></span>
<span><span class="co">#&gt; 784  11.5628237 2.997288</span></span>
<span><span class="co">#&gt; 785  11.5855094 2.993046</span></span>
<span><span class="co">#&gt; 786  11.6081951 2.988804</span></span>
<span><span class="co">#&gt; 787  11.6308807 2.984562</span></span>
<span><span class="co">#&gt; 788  11.6535664 2.980320</span></span>
<span><span class="co">#&gt; 789  11.6762521 2.976078</span></span>
<span><span class="co">#&gt; 790  11.6989378 2.971836</span></span>
<span><span class="co">#&gt; 791  11.7216234 2.967594</span></span>
<span><span class="co">#&gt; 792  11.7443091 2.963352</span></span>
<span><span class="co">#&gt; 793  11.7669948 2.959110</span></span>
<span><span class="co">#&gt; 794  11.7896804 2.954868</span></span>
<span><span class="co">#&gt; 795  11.8123661 2.950626</span></span>
<span><span class="co">#&gt; 796  11.8350518 2.946384</span></span>
<span><span class="co">#&gt; 797  11.8577374 2.942141</span></span>
<span><span class="co">#&gt; 798  11.8804231 2.937899</span></span>
<span><span class="co">#&gt; 799  11.9031088 2.933657</span></span>
<span><span class="co">#&gt; 800  11.9257944 2.929415</span></span>
<span><span class="co">#&gt; 801  11.9484801 2.925173</span></span>
<span><span class="co">#&gt; 802  11.9711658 2.920931</span></span>
<span><span class="co">#&gt; 803  11.9938515 2.916689</span></span>
<span><span class="co">#&gt; 804  12.0165371 2.912447</span></span>
<span><span class="co">#&gt; 805  12.0392228 2.908205</span></span>
<span><span class="co">#&gt; 806  12.0619085 2.903963</span></span>
<span><span class="co">#&gt; 807  12.0845941 2.899721</span></span>
<span><span class="co">#&gt; 808  12.1068062 2.894858</span></span>
<span><span class="co">#&gt; 809  12.1287638 2.889662</span></span>
<span><span class="co">#&gt; 810  12.1507214 2.884466</span></span>
<span><span class="co">#&gt; 811  12.1726790 2.879270</span></span>
<span><span class="co">#&gt; 812  12.1946365 2.874074</span></span>
<span><span class="co">#&gt; 813  12.2165941 2.868878</span></span>
<span><span class="co">#&gt; 814  12.2385517 2.863682</span></span>
<span><span class="co">#&gt; 815  12.2605093 2.858486</span></span>
<span><span class="co">#&gt; 816  12.2824668 2.853290</span></span>
<span><span class="co">#&gt; 817  12.3044244 2.848094</span></span>
<span><span class="co">#&gt; 818  12.3263820 2.842898</span></span>
<span><span class="co">#&gt; 819  12.3483395 2.837702</span></span>
<span><span class="co">#&gt; 820  12.3702971 2.832506</span></span>
<span><span class="co">#&gt; 821  12.3922547 2.827310</span></span>
<span><span class="co">#&gt; 822  12.4142123 2.822114</span></span>
<span><span class="co">#&gt; 823  12.4361698 2.816918</span></span>
<span><span class="co">#&gt; 824  12.4581274 2.811722</span></span>
<span><span class="co">#&gt; 825  12.4800850 2.806526</span></span>
<span><span class="co">#&gt; 826  12.5020426 2.801330</span></span>
<span><span class="co">#&gt; 827  12.5240001 2.796134</span></span>
<span><span class="co">#&gt; 828  12.5459577 2.790938</span></span>
<span><span class="co">#&gt; 829  12.5679153 2.785742</span></span>
<span><span class="co">#&gt; 830  12.5898729 2.780546</span></span>
<span><span class="co">#&gt; 831  12.6118304 2.775350</span></span>
<span><span class="co">#&gt; 832  12.6337880 2.770154</span></span>
<span><span class="co">#&gt; 833  12.6557456 2.764958</span></span>
<span><span class="co">#&gt; 834  12.6777032 2.759762</span></span>
<span><span class="co">#&gt; 835  12.6996607 2.754566</span></span>
<span><span class="co">#&gt; 836  12.7216183 2.749370</span></span>
<span><span class="co">#&gt; 837  12.7435759 2.744174</span></span>
<span><span class="co">#&gt; 838  12.7655334 2.738978</span></span>
<span><span class="co">#&gt; 839  12.7874910 2.733782</span></span>
<span><span class="co">#&gt; 840  12.8094486 2.728586</span></span>
<span><span class="co">#&gt; 841  12.8314062 2.723390</span></span>
<span><span class="co">#&gt; 842  12.8533637 2.718194</span></span>
<span><span class="co">#&gt; 843  12.8753213 2.712998</span></span>
<span><span class="co">#&gt; 844  12.8972789 2.707802</span></span>
<span><span class="co">#&gt; 845  12.9192365 2.702606</span></span>
<span><span class="co">#&gt; 846  12.9411940 2.697410</span></span>
<span><span class="co">#&gt; 847  12.9631516 2.692214</span></span>
<span><span class="co">#&gt; 848  12.9851092 2.687018</span></span>
<span><span class="co">#&gt; 849  13.0070668 2.681822</span></span>
<span><span class="co">#&gt; 850  13.0290243 2.676626</span></span>
<span><span class="co">#&gt; 851  13.0509819 2.671430</span></span>
<span><span class="co">#&gt; 852  13.0729395 2.666234</span></span>
<span><span class="co">#&gt; 853  13.0948971 2.661038</span></span>
<span><span class="co">#&gt; 854  13.1168546 2.655842</span></span>
<span><span class="co">#&gt; 855  13.1388122 2.650646</span></span>
<span><span class="co">#&gt; 856  13.1573459 2.642861</span></span>
<span><span class="co">#&gt; 857  13.1742266 2.633827</span></span>
<span><span class="co">#&gt; 858  13.1911073 2.624793</span></span>
<span><span class="co">#&gt; 859  13.2079880 2.615759</span></span>
<span><span class="co">#&gt; 860  13.2248687 2.606724</span></span>
<span><span class="co">#&gt; 861  13.2417494 2.597690</span></span>
<span><span class="co">#&gt; 862  13.2586301 2.588656</span></span>
<span><span class="co">#&gt; 863  13.2755108 2.579622</span></span>
<span><span class="co">#&gt; 864  13.2923915 2.570588</span></span>
<span><span class="co">#&gt; 865  13.3092722 2.561554</span></span>
<span><span class="co">#&gt; 866  13.3261529 2.552519</span></span>
<span><span class="co">#&gt; 867  13.3430336 2.543485</span></span>
<span><span class="co">#&gt; 868  13.3599143 2.534451</span></span>
<span><span class="co">#&gt; 869  13.3767950 2.525417</span></span>
<span><span class="co">#&gt; 870  13.3936758 2.516383</span></span>
<span><span class="co">#&gt; 871  13.4105565 2.507349</span></span>
<span><span class="co">#&gt; 872  13.4274372 2.498314</span></span>
<span><span class="co">#&gt; 873  13.4443179 2.489280</span></span>
<span><span class="co">#&gt; 874  13.4611986 2.480246</span></span>
<span><span class="co">#&gt; 875  13.4780793 2.471212</span></span>
<span><span class="co">#&gt; 876  13.4949600 2.462178</span></span>
<span><span class="co">#&gt; 877  13.5118407 2.453144</span></span>
<span><span class="co">#&gt; 878  13.5287214 2.444109</span></span>
<span><span class="co">#&gt; 879  13.5456021 2.435075</span></span>
<span><span class="co">#&gt; 880  13.5624828 2.426041</span></span>
<span><span class="co">#&gt; 881  13.5793635 2.417007</span></span>
<span><span class="co">#&gt; 882  13.5962442 2.407973</span></span>
<span><span class="co">#&gt; 883  13.6131249 2.398939</span></span>
<span><span class="co">#&gt; 884  13.6300057 2.389904</span></span>
<span><span class="co">#&gt; 885  13.6468864 2.380870</span></span>
<span><span class="co">#&gt; 886  13.6637671 2.371836</span></span>
<span><span class="co">#&gt; 887  13.6806478 2.362802</span></span>
<span><span class="co">#&gt; 888  13.6975285 2.353768</span></span>
<span><span class="co">#&gt; 889  13.7144092 2.344734</span></span>
<span><span class="co">#&gt; 890  13.7312899 2.335699</span></span>
<span><span class="co">#&gt; 891  13.7481706 2.326665</span></span>
<span><span class="co">#&gt; 892  13.7650513 2.317631</span></span>
<span><span class="co">#&gt; 893  13.7819320 2.308597</span></span>
<span><span class="co">#&gt; 894  13.7989004 2.299624</span></span>
<span><span class="co">#&gt; 895  13.8200762 2.293596</span></span>
<span><span class="co">#&gt; 896  13.8412520 2.287568</span></span>
<span><span class="co">#&gt; 897  13.8624277 2.281539</span></span>
<span><span class="co">#&gt; 898  13.8836035 2.275511</span></span>
<span><span class="co">#&gt; 899  13.9047792 2.269483</span></span>
<span><span class="co">#&gt; 900  13.9259550 2.263455</span></span>
<span><span class="co">#&gt; 901  13.9471307 2.257427</span></span>
<span><span class="co">#&gt; 902  13.9683065 2.251398</span></span>
<span><span class="co">#&gt; 903  13.9894822 2.245370</span></span>
<span><span class="co">#&gt; 904  14.0106580 2.239342</span></span>
<span><span class="co">#&gt; 905  14.0318337 2.233314</span></span>
<span><span class="co">#&gt; 906  14.0530095 2.227285</span></span>
<span><span class="co">#&gt; 907  14.0741852 2.221257</span></span>
<span><span class="co">#&gt; 908  14.0953610 2.215229</span></span>
<span><span class="co">#&gt; 909  14.1165367 2.209201</span></span>
<span><span class="co">#&gt; 910  14.1377125 2.203172</span></span>
<span><span class="co">#&gt; 911  14.1588882 2.197144</span></span>
<span><span class="co">#&gt; 912  14.1800640 2.191116</span></span>
<span><span class="co">#&gt; 913  14.2012397 2.185088</span></span>
<span><span class="co">#&gt; 914  14.2224155 2.179059</span></span>
<span><span class="co">#&gt; 915  14.2435912 2.173031</span></span>
<span><span class="co">#&gt; 916  14.2647670 2.167003</span></span>
<span><span class="co">#&gt; 917  14.2859427 2.160975</span></span>
<span><span class="co">#&gt; 918  14.3071185 2.154946</span></span>
<span><span class="co">#&gt; 919  14.3282943 2.148918</span></span>
<span><span class="co">#&gt; 920  14.3494700 2.142890</span></span>
<span><span class="co">#&gt; 921  14.3706458 2.136862</span></span>
<span><span class="co">#&gt; 922  14.3918215 2.130833</span></span>
<span><span class="co">#&gt; 923  14.4129973 2.124805</span></span>
<span><span class="co">#&gt; 924  14.4341730 2.118777</span></span>
<span><span class="co">#&gt; 925  14.4553488 2.112749</span></span>
<span><span class="co">#&gt; 926  14.4765245 2.106720</span></span>
<span><span class="co">#&gt; 927  14.4977003 2.100692</span></span>
<span><span class="co">#&gt; 928  14.5188760 2.094664</span></span>
<span><span class="co">#&gt; 929  14.5400518 2.088636</span></span>
<span><span class="co">#&gt; 930  14.5612275 2.082608</span></span>
<span><span class="co">#&gt; 931  14.5824033 2.076579</span></span>
<span><span class="co">#&gt; 932  14.6035790 2.070551</span></span>
<span><span class="co">#&gt; 933  14.6247548 2.064523</span></span>
<span><span class="co">#&gt; 934  14.6459305 2.058495</span></span>
<span><span class="co">#&gt; 935  14.6671063 2.052466</span></span>
<span><span class="co">#&gt; 936  14.6882820 2.046438</span></span>
<span><span class="co">#&gt; 937  14.7094578 2.040410</span></span>
<span><span class="co">#&gt; 938  14.7306335 2.034382</span></span>
<span><span class="co">#&gt; 939  14.7518093 2.028353</span></span>
<span><span class="co">#&gt; 940  14.7729850 2.022325</span></span>
<span><span class="co">#&gt; 941  14.7941608 2.016297</span></span>
<span><span class="co">#&gt; 942  14.8153366 2.010269</span></span>
<span><span class="co">#&gt; 943  14.8365123 2.004240</span></span>
<span><span class="co">#&gt; 944  14.8576881 1.998212</span></span>
<span><span class="co">#&gt; 945  14.8788638 1.992184</span></span>
<span><span class="co">#&gt; 946  14.9000396 1.986156</span></span>
<span><span class="co">#&gt; 947  14.9212153 1.980127</span></span>
<span><span class="co">#&gt; 948  14.9423911 1.974099</span></span>
<span><span class="co">#&gt; 949  14.9635668 1.968071</span></span>
<span><span class="co">#&gt; 950  14.9847426 1.962043</span></span>
<span><span class="co">#&gt; 951  15.0059183 1.956014</span></span>
<span><span class="co">#&gt; 952  15.0270941 1.949986</span></span>
<span><span class="co">#&gt; 953  15.0448981 1.941648</span></span>
<span><span class="co">#&gt; 954  15.0614242 1.932434</span></span>
<span><span class="co">#&gt; 955  15.0779502 1.923220</span></span>
<span><span class="co">#&gt; 956  15.0944763 1.914006</span></span>
<span><span class="co">#&gt; 957  15.1110024 1.904792</span></span>
<span><span class="co">#&gt; 958  15.1275285 1.895578</span></span>
<span><span class="co">#&gt; 959  15.1440545 1.886364</span></span>
<span><span class="co">#&gt; 960  15.1605806 1.877150</span></span>
<span><span class="co">#&gt; 961  15.1771067 1.867936</span></span>
<span><span class="co">#&gt; 962  15.1936327 1.858722</span></span>
<span><span class="co">#&gt; 963  15.2101588 1.849508</span></span>
<span><span class="co">#&gt; 964  15.2266849 1.840294</span></span>
<span><span class="co">#&gt; 965  15.2432110 1.831080</span></span>
<span><span class="co">#&gt; 966  15.2597370 1.821866</span></span>
<span><span class="co">#&gt; 967  15.2762631 1.812652</span></span>
<span><span class="co">#&gt; 968  15.2927892 1.803438</span></span>
<span><span class="co">#&gt; 969  15.3093153 1.794224</span></span>
<span><span class="co">#&gt; 970  15.3258413 1.785010</span></span>
<span><span class="co">#&gt; 971  15.3423674 1.775796</span></span>
<span><span class="co">#&gt; 972  15.3588935 1.766582</span></span>
<span><span class="co">#&gt; 973  15.3754196 1.757368</span></span>
<span><span class="co">#&gt; 974  15.3919456 1.748154</span></span>
<span><span class="co">#&gt; 975  15.4084717 1.738940</span></span>
<span><span class="co">#&gt; 976  15.4249978 1.729726</span></span>
<span><span class="co">#&gt; 977  15.4415239 1.720512</span></span>
<span><span class="co">#&gt; 978  15.4580499 1.711298</span></span>
<span><span class="co">#&gt; 979  15.4745760 1.702084</span></span>
<span><span class="co">#&gt; 980  15.4911021 1.692870</span></span>
<span><span class="co">#&gt; 981  15.5076282 1.683656</span></span>
<span><span class="co">#&gt; 982  15.5241542 1.674442</span></span>
<span><span class="co">#&gt; 983  15.5406803 1.665228</span></span>
<span><span class="co">#&gt; 984  15.5572064 1.656014</span></span>
<span><span class="co">#&gt; 985  15.5737325 1.646800</span></span>
<span><span class="co">#&gt; 986  15.5902585 1.637586</span></span>
<span><span class="co">#&gt; 987  15.6067846 1.628372</span></span>
<span><span class="co">#&gt; 988  15.6233107 1.619158</span></span>
<span><span class="co">#&gt; 989  15.6398368 1.609944</span></span>
<span><span class="co">#&gt; 990  15.6563628 1.600730</span></span>
<span><span class="co">#&gt; 991  15.6728889 1.591516</span></span>
<span><span class="co">#&gt; 992  15.6894150 1.582302</span></span>
<span><span class="co">#&gt; 993  15.7059410 1.573088</span></span>
<span><span class="co">#&gt; 994  15.7224671 1.563874</span></span>
<span><span class="co">#&gt; 995  15.7389932 1.554660</span></span>
<span><span class="co">#&gt; 996  15.7555193 1.545446</span></span>
<span><span class="co">#&gt; 997  15.7720453 1.536232</span></span>
<span><span class="co">#&gt; 998  15.7885714 1.527018</span></span>
<span><span class="co">#&gt; 999  15.8050975 1.517804</span></span>
<span><span class="co">#&gt; 1000 15.8216236 1.508590</span></span>
<span></span>
<span><span class="co">#Ensemble of ten design events </span></span>
<span><span class="va">curve</span><span class="op">$</span><span class="va">ensemble_wt13</span></span>
<span><span class="co">#&gt;       Rainfall     OsWL</span></span>
<span><span class="co">#&gt; 538  6.2627103 4.248871</span></span>
<span><span class="co">#&gt; 687  9.3278590 3.346416</span></span>
<span><span class="co">#&gt; 235  1.2673574 6.814884</span></span>
<span><span class="co">#&gt; 509  5.7521242 4.497691</span></span>
<span><span class="co">#&gt; 806 12.0619085 2.903963</span></span>
<span><span class="co">#&gt; 242  1.3179794 6.730302</span></span>
<span><span class="co">#&gt; 588  7.2466098 3.911432</span></span>
<span><span class="co">#&gt; 884 13.6300057 2.389904</span></span>
<span><span class="co">#&gt; 43   0.5547929 9.201654</span></span>
<span><span class="co">#&gt; 789 11.6762521 2.976078</span></span></code></pre></div>
<p>The <code><a href="../reference/return_curve_diag.html">return_curve_diag()</a></code> function calculates the
empirical probability of observing data within the survival regions
defined by a subset of points on the return curve. If the curve is a
good fit, the empirical probabilities should closely match the
probabilities associated with the return level curve. The procedure
which is introduced in <a href="https://doi.org/10.1002/env.2797" class="external-link">Murphy-Barltrop et
al. (2023)</a> uses bootstrap resampling of the original data set to
obtain confidence intervals for the empirical estimates. Since
observations are required in the survival regions to estimate the
empirical probabilities, it is recommended that this function be run for
shorter return periods that may usually be considered for design e.g.,
for a 1-year return period rather than a 50-year return period. The
inputs are almost identical to those of the
<code>return_curve_est</code> function. The only additional arguments
are <code>boot_method_all</code> which details the bootstrapping
procedure - basic or block - to use when estimating the distribution of
empirical (survival) probabilities from the original data set (without
any declustering), <code>boot_replace_all</code> which specifies whether
to sample with replacement in the case of a basic bootstrap and
<code>block_length_all</code> which specifies the block length for the
block bootstrap.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Diagnostic plots for the return curves</span></span>
<span><span class="va">curve</span> <span class="op">=</span> <span class="fu"><a href="../reference/return_curve_diag.html">return_curve_diag</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">S22.Detrend.df.extended</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>                          q<span class="op">=</span><span class="fl">0.985</span>,rp<span class="op">=</span><span class="fl">1</span>,mu<span class="op">=</span><span class="fl">365.25</span>,n_sim<span class="op">=</span><span class="fl">100</span>,</span>
<span>                          n_grad<span class="op">=</span><span class="fl">50</span>,n_boot<span class="op">=</span><span class="fl">100</span>,boot_method<span class="op">=</span><span class="st">"monthly"</span>,</span>
<span>                          boot_replace<span class="op">=</span><span class="cn">NA</span>, block_length<span class="op">=</span><span class="cn">NA</span>, boot_prop<span class="op">=</span><span class="fl">0.8</span>,</span>
<span>                          decl_method_x<span class="op">=</span><span class="st">"runs"</span>, decl_method_y<span class="op">=</span><span class="st">"runs"</span>,</span>
<span>                          window_length_x<span class="op">=</span><span class="cn">NA</span>,window_length_y<span class="op">=</span><span class="cn">NA</span>,</span>
<span>                          u_x<span class="op">=</span><span class="fl">0.95</span>, u_y<span class="op">=</span><span class="fl">0.95</span>,</span>
<span>                          sep_crit_x<span class="op">=</span><span class="fl">36</span>, sep_crit_y<span class="op">=</span><span class="fl">36</span>,</span>
<span>                          alpha<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>                          boot_method_all<span class="op">=</span><span class="st">"block"</span>, boot_replace_all<span class="op">=</span><span class="cn">NA</span>,</span>
<span>                          block_length_all<span class="op">=</span><span class="fl">14</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-59-1.png" width="576"><img src="figures/unnamed-chunk-59-2.png" width="576"><img src="figures/unnamed-chunk-59-3.png" width="576"></p>
</div>
</div>
<div class="section level3">
<h3 id="trivariate-analysis">5. Trivariate analysis<a class="anchor" aria-label="anchor" href="#trivariate-analysis"></a>
</h3>
<p>The package contains three higher dimensional
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mo>&gt;</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(&gt;3)</annotation></semantics></math>
approaches are implemented to model the joint distribution of rainfall,
O-sWL and groundwater level. They are:</p>
<ul>
<li>Standard (trivariate) copula</li>
<li>Pair Copula Construction</li>
<li>Heffernan and Tawn (2004)</li>
</ul>
<div class="section level5">
<h5 id="standard-trivariate-copula">Standard (trivariate) copula<a class="anchor" aria-label="anchor" href="#standard-trivariate-copula"></a>
</h5>
<p>In the package, each approach has a <code>_Fit</code> and
<code>_Sim</code> function. The latter requires a <code>MIGPD</code>
object as its <code>Marginals</code> input argument, in order for the
simulations on <span class="math inline">$\[0,1\]^3$</span> to be
transformed back to the original scale. The <code>Migpd_Fit</code>
command fits independent GPDs to the data in each row of a dataframe
(excluding the first column if it is a “Date” object) creating a
<code>MIGPD</code> object.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Migpd</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Migpd_Fit.html">Migpd_Fit</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,Data_Full <span class="op">=</span> <span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                     mqu<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.975</span>,<span class="fl">0.975</span>,<span class="fl">0.9676</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">S20.Migpd</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A collection of 3 generalized Pareto models.</span></span>
<span><span class="co">#&gt; All models converged.</span></span>
<span><span class="co">#&gt; Penalty to the likelihood: gaussian</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary of models:</span></span>
<span><span class="co">#&gt;                   Rainfall      OsWL Groundwater</span></span>
<span><span class="co">#&gt; Threshold        1.6000000 1.9385406   2.8599327</span></span>
<span><span class="co">#&gt; P(X &lt; threshold) 0.9750000 0.9750000   0.9676000</span></span>
<span><span class="co">#&gt; sigma            0.9040271 0.1574806   0.3083846</span></span>
<span><span class="co">#&gt; xi               0.1742220 0.2309118  -0.3441421</span></span>
<span><span class="co">#&gt; Upper end point        Inf       Inf   3.7560295</span></span></code></pre></div>
<p>Standard (trivariate) copula are the most conceptually simple of the
copula based models, using a single parametric multivariate probability
distribution as the copula. The <code><a href="../reference/Standard_Copula_Fit.html">Standard_Copula_Fit()</a></code>
function fits elliptic (specified by <code>Gaussian</code> or
<code>tcop</code>) or Archimedean (specified by
<code>Gumbel</code>,<code>Clayton</code> or <code>Frank</code>) copula
to a trivariate dataset. Let first fit a Gaussian copula</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Gaussian</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Standard_Copula_Fit.html">Standard_Copula_Fit</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.df</span>,Copula_Type<span class="op">=</span><span class="st">"Gaussian"</span><span class="op">)</span></span></code></pre></div>
<p>From which the <code><a href="../reference/Standard_Copula_Sim.html">Standard_Copula_Sim()</a></code> function can be
used to simulate a synthetic record of N years</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Gaussian.Sim</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Standard_Copula_Sim.html">Standard_Copula_Sim</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.df</span>,Marginals<span class="op">=</span><span class="va">S20.Migpd</span>,</span>
<span>                                      Copula<span class="op">=</span><span class="va">S20.Gaussian</span>,N<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the observed and simulated values</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Pairs.Plot.Data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="va">S20.Gaussian.Sim</span><span class="op">$</span><span class="va">x.Sim</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Observation"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Simulation"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">S20.Gaussian.Sim</span><span class="op">$</span><span class="va">x.Sim</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="st">"Type"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>      col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">$</span><span class="va">Type</span><span class="op">==</span><span class="st">"Observation"</span>,<span class="st">"Black"</span>,<span class="fu">alpha</span><span class="op">(</span><span class="st">"Red"</span>,<span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      upper.panel<span class="op">=</span><span class="cn">NULL</span>,pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-63-1.png" width="700"></p>
<p>The <code><a href="../reference/Standard_Copula_Sel.html">Standard_Copula_Sel()</a></code> function can be used to deduce
the best fitting in terms of AIC</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Standard_Copula_Sel.html">Standard_Copula_Sel</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Copula        AIC</span></span>
<span><span class="co">#&gt; 1 Gaussian -1389.1438</span></span>
<span><span class="co">#&gt; 2    t-cop -1434.7850</span></span>
<span><span class="co">#&gt; 3   Gumbel  -876.7537</span></span>
<span><span class="co">#&gt; 4  Clayton  -565.7595</span></span>
<span><span class="co">#&gt; 5    Frank  -854.4284</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="pair-copula-construction">Pair Copula Construction<a class="anchor" aria-label="anchor" href="#pair-copula-construction"></a>
</h5>
<p>Standard trivariate copulas lack flexibility to model joint
distributions where heterogeneous dependencies exist between the
variable pairs. Pair copula constructions construct multivariate
distribution using a cascade of bivariate copulas (some of which are
conditional). As the dimensionality of the problem increases the number
of mathematically equally valid decompositions quickly becomes large.
Bedford and Cooke (2001,2002) introduced the regular vine, a graphical
model which helps to organize the possible decompositions. The Canonical
(C-) and D- vine are two commonly utilized sub-categories of regular
vines, in the trivariate case a vine copula is simultaneously a C- and
D-vine. Let’s fit a regular vine copula model</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Vine</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Vine_Copula_Fit.html">Vine_Copula_Fit</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.df</span><span class="op">)</span></span></code></pre></div>
<p>From which the <code><a href="../reference/Vine_Copula_Sim.html">Vine_Copula_Sim()</a></code> function can be used to
simulate a synthetic record of N years</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Vine.Sim</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Vine_Copula_Sim.html">Vine_Copula_Sim</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S20.Detrend.df</span>,Vine_Model<span class="op">=</span><span class="va">S20.Vine</span>,Marginals<span class="op">=</span><span class="va">S20.Migpd</span>,N<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the observed and simulated values</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Pairs.Plot.Data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="va">S20.Vine.Sim</span><span class="op">$</span><span class="va">x.Sim</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Observation"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Simulation"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">S20.Vine.Sim</span><span class="op">$</span><span class="va">x.Sim</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="st">"Type"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>      col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">$</span><span class="va">Type</span><span class="op">==</span><span class="st">"Observation"</span>,<span class="st">"Black"</span>,<span class="fu">alpha</span><span class="op">(</span><span class="st">"Red"</span>,<span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      upper.panel<span class="op">=</span><span class="cn">NULL</span>,pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-67-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="ht04">HT04<a class="anchor" aria-label="anchor" href="#ht04"></a>
</h5>
<p>Finally, let us implement the Heffernan and Tawn (2004) approach, in
which a non-linear regression model is fitted to joint observations
where a conditioning variable exceeds a specified threshold. The
regression model typically adopted is:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="bold">𝐘</mtext><mrow><mi>−</mi><mi>i</mi></mrow></msub><mo>=</mo><mtext mathvariant="bold">𝐚</mtext><msub><mi>Y</mi><mi>i</mi></msub><mo>+</mo><msubsup><mi>Y</mi><mi>i</mi><mtext mathvariant="bold">𝐛</mtext></msubsup><mtext mathvariant="bold">𝐙</mtext><mspace width="2.381em"></mspace><mtext mathvariant="normal">for</mtext><mspace width="2.381em"></mspace><msub><mi>Y</mi><mi>i</mi></msub><mo>&gt;</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">\textbf{Y}_{-i} = \textbf{a}Y_i + Y_i^{\textbf{b}}\textbf{Z} \hspace{1cm} \text{for} \hspace{1cm} Y_i &gt; v</annotation></semantics></math>
where:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="bold">𝐘</mtext><annotation encoding="application/x-tex">\textbf{Y}</annotation></semantics></math>
is a set of variables transformed to a common scale
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="bold">𝐘</mtext><mrow><mi>−</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\textbf{Y}_{-i}</annotation></semantics></math>
is the set of variables excluding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="bold">𝐚</mtext><annotation encoding="application/x-tex">\textbf{a}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="bold">𝐛</mtext><annotation encoding="application/x-tex">\textbf{b}</annotation></semantics></math>
are vectors of regression parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="bold">𝐙</mtext><annotation encoding="application/x-tex">\textbf{Z}</annotation></semantics></math>
is a vector of residuals</p>
<p>The dependence structure when a specified variable is extreme is thus
captured by the regression parameters and the joint residuals. The
procedure is repeated, conditioning on each variable in turn, to build
up the joint distribution when at least one variable is in an extreme
state. The HT04 command fits the model and simulates N years’ worth of
data from the fitted model.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.HT04</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/HT04.html">HT04</a></span><span class="op">(</span>data_Detrend_Dependence_df<span class="op">=</span><span class="va">S20.Detrend.df</span>,</span>
<span>               data_Detrend_Declustered_df<span class="op">=</span><span class="va">S20.Detrend.Declustered.df</span>,</span>
<span>               u_Dependence<span class="op">=</span><span class="fl">0.995</span>,Migpd<span class="op">=</span><span class="va">S20.Migpd</span>,mu<span class="op">=</span><span class="fl">365.25</span>,N<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>Output of the function includes the three conditional
<code>Models</code>, proportion of occasions where each variable is most
extreme given at least one variable is extreme <code>prop</code>as well
as, the simulations on the transformed scale <code>u.Sim</code> (Gumbel
by default) and original scale <code>x.Sim</code>. Let’s view the fitted
model when conditioning on rainfall</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.HT04</span><span class="op">$</span><span class="va">Model</span><span class="op">$</span><span class="va">Rainfall</span></span>
<span><span class="co">#&gt; mexDependence(x = Migpd, which = colnames(data_Detrend_Dependence_df)[i], </span></span>
<span><span class="co">#&gt;     dqu = u_Dependence, margins = "laplace", constrain = FALSE, </span></span>
<span><span class="co">#&gt;     v = V, maxit = Maxit)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Marginal models:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dependence model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditioning on Rainfall variable.</span></span>
<span><span class="co">#&gt; Thresholding quantiles for transformed data: dqu = 0.995</span></span>
<span><span class="co">#&gt; Using laplace margins for dependence estimation.</span></span>
<span><span class="co">#&gt; Log-likelihood = -108.5807 -84.53349 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dependence structure parameter estimates:</span></span>
<span><span class="co">#&gt;     OsWL Groundwater</span></span>
<span><span class="co">#&gt; a 1.0000      0.3295</span></span>
<span><span class="co">#&gt; b 0.6948     -1.5240</span></span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.HT04</span><span class="op">$</span><span class="va">Prop</span></span>
<span><span class="co">#&gt; [1] 0.3552632 0.3157895 0.3289474</span></span></code></pre></div>
<p>and the which the proporiton of the occasions in the original sample
that rainfall is the most extreme of the drivers given that at least one
driver is extreme.</p>
<p>The HT04 approach uses rejection sampling to generate synthetic
records. The first step involves sampling a variable, conditioned to
exceed the <code>u_Dependence</code> threshold. A joint residual
associated with the corresponding regression is independently sampled
and other variables estimated using the fitted regression parameters. If
the variable conditioned to be extreme in step one is not the most
extreme the sample is rejected. The process is repeated until the
relative proportion of simulated events where each variable is a
maximum, conditional on being above the threshold, is consistent with
the empirical distribution. Labeling the simulations
<code>S20.HT04.Sim</code></p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.HT04.Sim</span><span class="op">&lt;-</span><span class="va">S20.HT04</span><span class="op">$</span><span class="va">x.sim</span></span></code></pre></div>
<p>and now plotting the simulations from the HT04 model</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S20.Pairs.Plot.Data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="va">S20.HT04.Sim</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Observation"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Simulation"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">S20.HT04.Sim</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">S20.Detrend.df</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="st">"Type"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>      col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">S20.Pairs.Plot.Data</span><span class="op">$</span><span class="va">Type</span><span class="op">==</span><span class="st">"Observation"</span>,<span class="st">"Black"</span>,<span class="fu">alpha</span><span class="op">(</span><span class="st">"Red"</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      upper.panel<span class="op">=</span><span class="cn">NULL</span>,pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-72-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="sea-level-rise">6. Sea Level Rise<a class="anchor" aria-label="anchor" href="#sea-level-rise"></a>
</h3>
<p>The <code>SLR_Scenarios</code> function estimates the time required
for a user-specified amount of sea level rise (
<code>SeaLevelRise</code>) to occur under various sea level rise
scenarios. The default scenarios are for Key West from the Southeast
Florida Regional Climate Change Compact (2019). Let’s calculate how long
before the O-sWL in the 100-year “most-likely” design event (see section
4) equals that of the corresponding design event derived under full
dependence.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Difference in O-sWL between the most-likely and full dependence events</span></span>
<span><span class="va">Diff</span><span class="op">&lt;-</span><span class="va">S20.Bivariate</span><span class="op">$</span><span class="va">FullDependence</span><span class="op">$</span><span class="va">`100`</span><span class="op">$</span><span class="va">OsWL</span><span class="op">-</span><span class="va">S20.Bivariate</span><span class="op">$</span><span class="va">MostLikelyEvent</span><span class="op">$</span><span class="va">`100`</span><span class="op">$</span><span class="va">OsWL</span></span>
<span><span class="va">Diff</span></span>
<span><span class="co">#&gt; [1] 0.1269654</span></span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Time in years for the sea level rise to occur</span></span>
<span><span class="fu"><a href="../reference/SLR_Scenarios.html">SLR_Scenarios</a></span><span class="op">(</span>SeaLevelRise<span class="op">=</span><span class="va">Diff</span>,Unit<span class="op">=</span><span class="st">"m"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-74-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; $High</span></span>
<span><span class="co">#&gt; [1] 2031</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Intermediate</span></span>
<span><span class="co">#&gt; [1] 2034</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Low</span></span>
<span><span class="co">#&gt; [1] 2044</span></span></code></pre>
<p>Scenarios from the Interagency Sea Level Rise Scenario Tool (2022)
for Miami Beach and Naples can be utilized by changing the
<code>Scenario</code> and <code>Location</code> arguments.
Alternatively, a user can input other sea level rise scenarios into the
function. For example, below we use the scenarios from the same tool but
for Fort Myers.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Sea level rise scenarios for Fort Myers</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sl_taskforce_scenarios_psmsl_id_1106_Fort_Myers</span><span class="op">)</span></span>
<span><span class="co">#&gt;   psmsl_id process Units scenario quantile     X2020   X2030   X2040   X2050</span></span>
<span><span class="co">#&gt; 1     1106   total    mm      Low       17  79.48296 118.483 168.483 210.483</span></span>
<span><span class="co">#&gt; 2     1106   total    mm      Low       50 101.48296 154.483 210.483 264.483</span></span>
<span><span class="co">#&gt; 3     1106   total    mm      Low       83 123.48296 193.483 258.483 320.483</span></span>
<span><span class="co">#&gt; 4     1106   total    mm   IntLow       17  87.48296 134.483 189.483 244.483</span></span>
<span><span class="co">#&gt; 5     1106   total    mm   IntLow       50 109.48296 171.483 239.483 307.483</span></span>
<span><span class="co">#&gt; 6     1106   total    mm   IntLow       83 132.48296 210.483 289.483 369.483</span></span>
<span><span class="co">#&gt;     X2060   X2070   X2080   X2090   X2100   X2110   X2120    X2130    X2140</span></span>
<span><span class="co">#&gt; 1 248.483 285.483 313.483 336.483 361.483 389.483 417.483  442.483  465.483</span></span>
<span><span class="co">#&gt; 2 309.483 350.483 383.483 412.483 453.483 493.483 531.483  566.483  601.483</span></span>
<span><span class="co">#&gt; 3 378.483 421.483 462.483 505.483 566.483 619.483 674.483  725.483  777.483</span></span>
<span><span class="co">#&gt; 4 306.483 369.483 431.483 492.483 550.483 612.483 675.483  732.483  792.483</span></span>
<span><span class="co">#&gt; 5 374.483 442.483 512.483 577.483 646.483 722.483 798.483  877.483  955.483</span></span>
<span><span class="co">#&gt; 6 445.483 521.483 603.483 680.483 767.483 858.483 952.483 1052.483 1161.483</span></span>
<span><span class="co">#&gt;      X2150</span></span>
<span><span class="co">#&gt; 1  489.483</span></span>
<span><span class="co">#&gt; 2  634.483</span></span>
<span><span class="co">#&gt; 3  829.483</span></span>
<span><span class="co">#&gt; 4  848.483</span></span>
<span><span class="co">#&gt; 5 1033.483</span></span>
<span><span class="co">#&gt; 6 1274.483</span></span>
<span></span>
<span><span class="co">#Formatting to a data frame that can be interpreted by the tool</span></span>
<span><span class="va">SeaLevelRise.2022_input</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Year<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2020</span>,<span class="fl">2150</span>,<span class="fl">10</span><span class="op">)</span>,</span>
<span><span class="st">"High"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sl_taskforce_scenarios_psmsl_id_1106_Fort_Myers</span><span class="op">[</span><span class="fl">14</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span><span class="st">"Int_Medium"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sl_taskforce_scenarios_psmsl_id_1106_Fort_Myers</span><span class="op">[</span><span class="fl">11</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span><span class="st">"Medium"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sl_taskforce_scenarios_psmsl_id_1106_Fort_Myers</span><span class="op">[</span><span class="fl">8</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span><span class="st">"Int_Low"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sl_taskforce_scenarios_psmsl_id_1106_Fort_Myers</span><span class="op">[</span><span class="fl">5</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span><span class="st">"Low"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sl_taskforce_scenarios_psmsl_id_1106_Fort_Myers</span><span class="op">[</span><span class="fl">2</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Finding time in years for 0.8m of sea level rise to occur</span></span>
<span><span class="fu"><a href="../reference/SLR_Scenarios.html">SLR_Scenarios</a></span><span class="op">(</span>SeaLevelRise<span class="op">=</span><span class="fl">0.8</span>, Scenario<span class="op">=</span><span class="st">"Other"</span>, Unit <span class="op">=</span> <span class="st">"m"</span>, Year<span class="op">=</span><span class="fl">2022</span>, </span>
<span>              Location<span class="op">=</span><span class="st">"Fort Myers"</span>, New_Scenario<span class="op">=</span><span class="va">SeaLevelRise.2022_input</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-75-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; $SLR_Year</span></span>
<span><span class="co">#&gt; [1] 2150 2120 2085 2070 2064</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="simulating-temporally-varying-events">7. Simulating temporally varying events<a class="anchor" aria-label="anchor" href="#simulating-temporally-varying-events"></a>
</h3>
<p>By sampling peaks from a multivariate statistical model e.g., a vine
copula that includes the relative lag between the rainfall and water
level peaks as well as their magnitudes temporally-varying synthetic
events can be simulated.</p>
<div class="section level5">
<h5 id="water-level-curves">Water level curves<a class="anchor" aria-label="anchor" href="#water-level-curves"></a>
</h5>
<p>The intensity of a storm surge event is defined in <a href="https://doi.org/10.5194/nhess-11-2925-2011" class="external-link">Wahl et al. 2011</a>
as the area of the water level curve above a specified base line level
from the first low water level of the preceding tide and last low tide
of the following tide. The <code>intensity()</code> function calculates
this metric with the default baseline level set as the mean of the water
level time series (<code>Base_Line</code>=<code>"Mean "</code>). Let’s
calculate the “intensity” of cluster maxima in the hourly O-sWL time
series at control structure S-13.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Decluster O-sWL series at S-13 using a runs method</span></span>
<span><span class="va">S13.OsWL.Declust</span> <span class="op">=</span> <span class="fu"><a href="../reference/Decluster.html">Decluster</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span>,</span>
<span>                             SepCrit<span class="op">=</span><span class="fl">24</span><span class="op">*</span><span class="fl">7</span>, u<span class="op">=</span><span class="fl">0.99667</span><span class="op">)</span></span>
<span><span class="co">#Calculate O-sWL of the identified cluster maximum</span></span>
<span><span class="va">intensity</span> <span class="op">=</span> <span class="fu"><a href="../reference/Intensity.html">Intensity</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S13.Detrend.df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                      Cluster_Max<span class="op">=</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span>,</span>
<span>                      Base_Line<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Plotting a subset of the events:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Plotting water levels</span></span>
<span><span class="co">#Converting Date_Time column to POSIXct class</span></span>
<span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span>, </span>
<span>                                       format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M:%S"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span><span class="op">[</span><span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">48</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">48</span><span class="op">)</span><span class="op">]</span>, </span>
<span>     <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">48</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">48</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Time"</span>, ylab<span class="op">=</span><span class="st">"O-sWL (ft NGVD 29)"</span>,type<span class="op">=</span><span class="st">'l'</span>,lwd<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Adding purple points denoting preceding and following high tides</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Pre.High</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, </span>
<span>       <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Pre.High</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">1.5</span>,col<span class="op">=</span><span class="st">"Purple"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Fol.High</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, </span>
<span>       <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Fol.High</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">1.5</span>,col<span class="op">=</span><span class="st">"Purple"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Adding orange points denoting preceding and following low tides</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Pre.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, </span>
<span>       <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Pre.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">1.5</span>,col<span class="op">=</span><span class="st">"Orange"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Fol.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, </span>
<span>       <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Fol.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">1.5</span>,col<span class="op">=</span><span class="st">"Orange"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Recall BaseLine=2</span></span>
<span><span class="va">baseline</span><span class="op">=</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Only create polygon showing intensity</span></span>
<span><span class="va">above</span><span class="op">&lt;-</span> <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Pre.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">:</span><span class="va">intensity</span><span class="op">$</span><span class="va">Fol.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">baseline</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">above</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">runs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rle.html" class="external-link">rle</a></span><span class="op">(</span><span class="va">above</span><span class="op">)</span></span>
<span>  <span class="va">ends</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">runs</span><span class="op">$</span><span class="va">lengths</span><span class="op">)</span></span>
<span>  <span class="va">starts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">ends</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ends</span><span class="op">)</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">runs</span><span class="op">$</span><span class="va">values</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">start_idx</span> <span class="op">&lt;-</span> <span class="va">starts</span><span class="op">[</span><span class="va">j</span><span class="op">]</span></span>
<span>    <span class="va">end_idx</span> <span class="op">&lt;-</span> <span class="va">ends</span><span class="op">[</span><span class="va">j</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">x_seg</span> <span class="op">&lt;-</span> <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Date_Time</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Pre.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">:</span><span class="va">intensity</span><span class="op">$</span><span class="va">Fol.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">start_idx</span><span class="op">:</span><span class="va">end_idx</span><span class="op">]</span></span>
<span>    <span class="va">y_seg</span> <span class="op">&lt;-</span> <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="va">intensity</span><span class="op">$</span><span class="va">Pre.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">:</span><span class="va">intensity</span><span class="op">$</span><span class="va">Fol.Low</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">start_idx</span><span class="op">:</span><span class="va">end_idx</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x_seg</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">x_seg</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_seg</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">baseline</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x_seg</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            col <span class="op">=</span> <span class="st">"dark grey"</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-77-1.png" width="700"></p>
<p>The <code><a href="../reference/WL_Curve.html">WL_Curve()</a></code> function generates a water level curve
conditioned on a water level event peak (<code>Peak</code>) and
“intensity” (<code>Intensity</code>). The function works by re-scaling
observed events curves between four time units before and after the peak
such that the re-scaled peak coincides with conditioned peak. It then
computes the intensity of the re-scaled events and selects the event
with the highest intensity that’s less than conditioned intensity.
Intensity units are then added to ensure the intensity of the simulated
curve matches the conditioned intensity. The Intensity units, which
manifest as increases in water level, are distributed in proportion with
the decreases of water levels from the peak OsWL i.e., more units are
added at lower water levels. No units are added about the peak. For
conditioned event peaks below a user-specified threshold
(<code>Thres</code>) an observed curve with an intensity less than some
user-specified limit (<code>Limit</code>) is randomly sampled.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Four synthetic events all with intensity of 60 units</span></span>
<span><span class="va">sim.peaks</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.4</span>,<span class="fl">4</span>,<span class="fl">4.2</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">sim.intensity</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>,<span class="fl">60</span>,<span class="fl">60</span>,<span class="fl">60</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Generating the water level curves</span></span>
<span><span class="va">oswl_ts_oswl</span> <span class="op">=</span> <span class="fu"><a href="../reference/WL_Curve.html">WL_Curve</a></span><span class="op">(</span>Data <span class="op">=</span> <span class="va">S13.Detrend.df</span>,</span>
<span>                        Cluster_Max <span class="op">=</span> <span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span>,</span>
<span>                        Pre_Low <span class="op">=</span> <span class="va">intensity</span><span class="op">$</span><span class="va">Pre.Low</span>,</span>
<span>                        Fol_Low <span class="op">=</span> <span class="va">intensity</span><span class="op">$</span><span class="va">Fol.Low</span>,</span>
<span>                        Thres <span class="op">=</span> <span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">Threshold</span>, Limit <span class="op">=</span> <span class="fl">45</span>,</span>
<span>                        Peak <span class="op">=</span> <span class="va">sim.peaks</span>,</span>
<span>                        Base_Line<span class="op">=</span><span class="fl">2</span>,</span>
<span>                        Intensity <span class="op">=</span> <span class="va">sim.intensity</span><span class="op">)</span></span></code></pre></div>
<p>Superimposing the four simulated water level curves on the observed
curves:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Plot the water level curves of the observed peaks</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">-</span><span class="fl">144</span><span class="op">:</span><span class="fl">144</span>,</span>
<span>     <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">144</span><span class="op">)</span><span class="op">:</span></span>
<span>                         <span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">144</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Time relative to peak(hour)"</span>, ylab<span class="op">=</span><span class="st">"O-sWL (ft NGVD 29)"</span>, type<span class="op">=</span><span class="st">'l'</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="op">-</span><span class="fl">144</span><span class="op">:</span><span class="fl">144</span>,</span>
<span>        <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">OsWL</span><span class="op">[</span><span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">-</span><span class="fl">144</span><span class="op">)</span><span class="op">:</span></span>
<span>                            <span class="op">(</span><span class="va">S13.OsWL.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="fl">144</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#Superimpose the curves generated for the four synthetic events</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="op">-</span><span class="fl">144</span><span class="op">:</span><span class="fl">144</span>,<span class="va">oswl_ts_oswl</span><span class="op">$</span><span class="va">Series</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-79-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="hyetographs">Hyetographs<a class="anchor" aria-label="anchor" href="#hyetographs"></a>
</h5>
<p><a href="https://doi.org/10.1002/wrcr.20221" class="external-link">Serinaldi and Kilsby</a>
studied the pairwise relationships between key hyetograph
characteristics: maximum value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">Xp</annotation></semantics></math>,
volume
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>,
duration
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>,
and average intensity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>
at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>282</mn><annotation encoding="application/x-tex">282</annotation></semantics></math>
rain gauge stations in central eastern Europe with daily rainfall
records and three 5-minutes record gauges in Italy. The authors found
that at both temporal scales the only stochastic relationship was
between volume and duration, and that simple bootstrap procedures could
be used to generate events that preserve the pairwise relationships
among the characteristics. The <code>U_Sample</code> function implements
a bootstrap procedure referred to as the U-boot algorithm in <a href="https://doi.org/10.1002/wrcr.20221" class="external-link">Serinaldi and Kilsby
(2013)</a> to generate hyetograhs. For a simulated peak <code>Xp</code>,
a duration is independently sampled and a set of non-peaks are sampled
at random from one of the events with the same duration. To implement
the method exactly as in <a href="https://doi.org/10.1002/wrcr.20221" class="external-link">Serinaldi and Kilsby
(2013)</a>, set <code>Xp</code> equal to a sample (taken with
replacement) of the observed cluster maximum (peaks). An example
application of the function is given below for rainfall recorded at
control structure S-13. First the hourly time series is declustered to
find the characteristics of the rainfall events containing the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>500</mn><annotation encoding="application/x-tex">500</annotation></semantics></math>
highest peaks:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#First decluster the rainfall series to find the 500 events</span></span>
<span><span class="co">#with the highest peaks</span></span>
<span><span class="va">S13.Rainfall.Declust</span> <span class="op">=</span> <span class="fu"><a href="../reference/Decluster.html">Decluster</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span>,</span>
<span>                                 SepCrit<span class="op">=</span><span class="fl">24</span><span class="op">*</span><span class="fl">3</span>, u<span class="op">=</span><span class="fl">0.99667</span><span class="op">)</span></span>
<span><span class="co">#Hourly peaks</span></span>
<span><span class="va">peaks</span> <span class="op">=</span> <span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">[</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">]</span></span>
<span><span class="co">#Set very small rainfall measurements to zero.</span></span>
<span><span class="co">#Assumed to be the result of uncertainty in measuring equipment.</span></span>
<span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">&lt;</span><span class="fl">0.01</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="co">#Find NAs in rainfall series</span></span>
<span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span><span class="op">==</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#Temporarily set NAs to zero</span></span>
<span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">[</span><span class="va">z</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="co">#Find times where there is 6-hours of no rainfall</span></span>
<span><span class="va">no.rain</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">6</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">no.rain</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">[</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">:</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">==</span><span class="fl">0</span>,<span class="va">i</span>,<span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#Remove NAs from results vector as these correspond to times where there is</span></span>
<span><span class="co">#rainfall at certain points in the 6 hour period.</span></span>
<span><span class="va">no.rain</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">no.rain</span><span class="op">)</span></span>
<span><span class="co">#Reset missing values in the rainfall record back to NA</span></span>
<span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">[</span><span class="va">z</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="co">#Find the start and end times of the 500 events.</span></span>
<span><span class="va">start</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">end</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="va">start</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">no.rain</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">no.rain</span><span class="op">&lt;</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span> <span class="va">end</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">no.rain</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">no.rain</span><span class="op">&gt;</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">start</span> <span class="op">=</span> <span class="va">start</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="va">end</span> <span class="op">=</span> <span class="va">end</span> <span class="op">-</span> <span class="fl">6</span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="va">end</span> <span class="op">-</span> <span class="va">start</span> <span class="op">+</span> <span class="fl">1</span> <span class="co">#Duration</span></span>
<span><span class="co">#Simulate some peaks by sampling observed peaks with replacement</span></span>
<span><span class="co">#I.e., applying the method exactly as in Serinaldi and Kilsby (2013)</span></span>
<span><span class="va">sim.peak</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">peaks</span>,size<span class="op">=</span><span class="fl">500</span>,replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Now the bootstrapping procedure can be carried out:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample</span> <span class="op">=</span> <span class="fu"><a href="../reference/U_Sample.html">U_Sample</a></span><span class="op">(</span>Data<span class="op">=</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span>,</span>
<span>                  Cluster_Max<span class="op">=</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span>,</span>
<span>                  D<span class="op">=</span><span class="va">d</span>,Start<span class="op">=</span><span class="va">start</span>,End<span class="op">=</span><span class="va">end</span>,</span>
<span>                  Xp<span class="op">=</span><span class="va">sim.peak</span><span class="op">)</span></span></code></pre></div>
<p>Let’s check whether the characteristic of the bootstrapped events
match those of the observed events. First, calculating the volume and
intensity of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>500</mn><annotation encoding="application/x-tex">500</annotation></semantics></math>
observed events with the highest hourly peaks.</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Calculating volume and intensity</span></span>
<span><span class="va">v</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">500</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S13.Rainfall.Declust</span><span class="op">$</span><span class="va">EventsMax</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">v</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">S13.Detrend.df</span><span class="op">$</span><span class="va">Rainfall</span><span class="op">[</span><span class="op">(</span><span class="va">start</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">end</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">I</span> <span class="op">=</span> <span class="va">v</span><span class="op">/</span><span class="va">d</span></span>
<span></span>
<span><span class="co">#Putting in a data.frame</span></span>
<span><span class="va">observations</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">peaks</span>,<span class="va">d</span>,<span class="va">v</span>,<span class="va">I</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">observations</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"peak"</span>,<span class="st">"d"</span>,<span class="st">"v"</span>,<span class="st">"I"</span><span class="op">)</span></span></code></pre></div>
<p>To aid the comparison information relating to the marginal
distributions of the characteristics is removed by transforming the data
to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><annotation encoding="application/x-tex">[0,1]^2</annotation></semantics></math>
scale.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Observations</span></span>
<span><span class="va">observations.u</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">pobs</span><span class="op">(</span><span class="va">observations</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">observations.u</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"peak"</span>,<span class="st">"d"</span>,<span class="st">"v"</span>,<span class="st">"I"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Sample</span></span>
<span><span class="va">sample.u</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">pobs</span><span class="op">(</span><span class="va">sample</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Scatter plots showing the pairwise relationships of the
characteristics:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Layout of the plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.2</span>,<span class="fl">4.2</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Characteristics of observations on original scale</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations</span><span class="op">$</span><span class="va">peak</span>,<span class="va">observations</span><span class="op">$</span><span class="va">I</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"I"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations</span><span class="op">$</span><span class="va">peak</span>,<span class="va">observations</span><span class="op">$</span><span class="va">v</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"V"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations</span><span class="op">$</span><span class="va">peak</span>,<span class="va">observations</span><span class="op">$</span><span class="va">d</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations</span><span class="op">$</span><span class="va">I</span>,<span class="va">observations</span><span class="op">$</span><span class="va">v</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"I"</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"V"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations</span><span class="op">$</span><span class="va">I</span>,<span class="va">observations</span><span class="op">$</span><span class="va">d</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"I"</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations</span><span class="op">$</span><span class="va">v</span>,<span class="va">observations</span><span class="op">$</span><span class="va">d</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"V"</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Characteristics of sample on original scale</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">Xp</span>,<span class="va">sample</span><span class="op">$</span><span class="va">I</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">Xp</span>,<span class="va">sample</span><span class="op">$</span><span class="va">V</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">Xp</span>,<span class="va">sample</span><span class="op">$</span><span class="va">D</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">I</span>,<span class="va">sample</span><span class="op">$</span><span class="va">V</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">I</span>,<span class="va">sample</span><span class="op">$</span><span class="va">D</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">V</span>,<span class="va">sample</span><span class="op">$</span><span class="va">D</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Characteristics of observations on the [0,1] scale</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations.u</span><span class="op">$</span><span class="va">peak</span>,<span class="va">observations.u</span><span class="op">$</span><span class="va">I</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations.u</span><span class="op">$</span><span class="va">peak</span>,<span class="va">observations.u</span><span class="op">$</span><span class="va">v</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations.u</span><span class="op">$</span><span class="va">peak</span>,<span class="va">observations.u</span><span class="op">$</span><span class="va">d</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'D'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations.u</span><span class="op">$</span><span class="va">I</span>,<span class="va">observations.u</span><span class="op">$</span><span class="va">v</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations.u</span><span class="op">$</span><span class="va">I</span>,<span class="va">observations.u</span><span class="op">$</span><span class="va">d</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'D'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observations.u</span><span class="op">$</span><span class="va">v</span>,<span class="va">observations.u</span><span class="op">$</span><span class="va">d</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'D'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Characteristics of sample on the [0,1] scale</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample.u</span><span class="op">$</span><span class="va">Xp</span>,<span class="va">sample.u</span><span class="op">$</span><span class="va">I</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample.u</span><span class="op">$</span><span class="va">Xp</span>,<span class="va">sample.u</span><span class="op">$</span><span class="va">V</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample.u</span><span class="op">$</span><span class="va">Xp</span>,<span class="va">sample.u</span><span class="op">$</span><span class="va">D</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'X'</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample.u</span><span class="op">$</span><span class="va">I</span>,<span class="va">sample.u</span><span class="op">$</span><span class="va">V</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample.u</span><span class="op">$</span><span class="va">I</span>,<span class="va">sample.u</span><span class="op">$</span><span class="va">D</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'I'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample.u</span><span class="op">$</span><span class="va">V</span>,<span class="va">sample.u</span><span class="op">$</span><span class="va">D</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">1.25</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">'V'</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"D"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.3</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/unnamed-chunk-84-1.png" width="576"></p>
<p>The figure demonstrates that the simulated events preserves the key
characteristics of the observed events.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robert Jane.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
